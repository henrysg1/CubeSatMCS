"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[809],{9809:(we,T,c)=>{c.r(T),c.d(T,{AlgorithmsModule:()=>ve});var D=c(7216),_=c(1896),C=c(3906),Z=c(7914),Y=c(4529),t=c(5879),o=c(6516),f=c(6593),l=c(6814),d=c(4104),y=c(3422),q=c(858);const k=function(e,i){return{c:e,filter:i}};function M(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"a",9),t._uU(2),t.qZA(),t._uU(3),t.ALo(4,"shortName"),t._UZ(5,"ya-title-copy",10),t.BQk()),2&e){const n=i.ngIf,a=t.oxw().ngIf,r=t.oxw();t.xp6(1),t.Q6J("queryParams",t.WLB(6,k,r.yamcs.context,n)),t.xp6(1),t.hij(" ",n," "),t.xp6(1),t.hij("/",t.lcZ(4,4,a.qualifiedName)," "),t.xp6(2),t.Q6J("text",a.qualifiedName)}}const b=function(e){return{c:e}};function $(e,i){if(1&e&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),t.YNc(2,M,6,9,"ng-container",0),t.ALo(3,"spaceSystemName"),t.qZA(),t.TgZ(4,"nav",1,2)(6,"a",3,4),t._uU(8," Summary "),t.qZA(),t.TgZ(9,"a",5,6),t._uU(11," Trace "),t.qZA()(),t.TgZ(12,"div",7)(13,"mat-tab-nav-panel",null,8),t._UZ(15,"router-outlet"),t.qZA()()()),2&e){const n=i.ngIf,a=t.MAs(7),r=t.MAs(10),s=t.MAs(14),h=t.oxw();t.xp6(2),t.Q6J("ngIf",t.lcZ(3,8,n.qualifiedName)),t.xp6(2),t.Q6J("mat-stretch-tabs",!1)("tabPanel",s),t.xp6(2),t.Q6J("active",a.isActive)("queryParams",t.VKq(10,b,h.yamcs.context)),t.xp6(3),t.Q6J("active",r.isActive)("queryParams",t.VKq(12,b,h.yamcs.context))("disabled","GLOBAL"!==n.scope)}}let U=(()=>{class e{constructor(n,a,r){this.yamcs=a;const s=n.snapshot.paramMap.get("qualifiedName");this.algorithm$=a.yamcsClient.getAlgorithm(this.yamcs.instance,s),this.algorithm$.then(h=>{r.setTitle(h.name)})}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(_.gz),t.Y36(o.C8),t.Y36(f.Dx))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["tabs",""],["mat-tab-link","","routerLink","summary","routerLinkActive","",3,"active","queryParams"],["rla","routerLinkActive"],["mat-tab-link","","routerLink","trace","routerLinkActive","",3,"active","queryParams","disabled"],["rlb","routerLinkActive"],[1,"tab-content-wrapper"],["tabPanel",""],["routerLink","/algorithms",1,"ya-link","ya-header-link",3,"queryParams"],[3,"text"]],template:function(a,r){1&a&&(t.YNc(0,$,16,14,"app-instance-page",0),t.ALo(1,"async")),2&a&&t.Q6J("ngIf",t.lcZ(1,1,r.algorithm$))},dependencies:[l.O5,_.lC,_.rH,_.Od,d.BU,d.sW,d.Nj,o.GN,y.a,q.k,l.Ov,o.yk,o.BC],styles:[".tab-content-wrapper[_ngcontent-%COMP%]{position:absolute;inset:37px 0 0;overflow:auto}.tab-content-wrapper.noscroll[_ngcontent-%COMP%]{overflow:hidden}"],changeDetection:0})}return e})();var g=c(5619),L=c(7954),B=(c(8440),c(4184),c(8743),c(6806),c(4518)),x=c(617),E=c(6385),F=c(2842);function V(e,i){if(1&e&&t._UZ(0,"ya-led",2),2&e){const n=t.oxw();t.Q6J("color",n.onColor)("fade",!1)("width",n.size)("height",n.size)}}function R(e,i){if(1&e&&t._UZ(0,"ya-led",3),2&e){const n=t.oxw();t.Q6J("fade",!1)("width",n.size)("height",n.size)}}let z=(()=>{class e{constructor(){this.size=14,this.onColor=o.U3,this.offColor=o.fk}static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-algorithm-status"]],inputs:{status:"status",size:"size"},decls:2,vars:2,consts:[[3,"color","fade","width","height",4,"ngIf"],["color","red",3,"fade","width","height",4,"ngIf"],[3,"color","fade","width","height"],["color","red",3,"fade","width","height"]],template:function(a,r){1&a&&(t.YNc(0,V,1,4,"ya-led",0),t.YNc(1,R,1,3,"ya-led",1)),2&a&&(t.Q6J("ngIf",!r.status.errorMessage),t.xp6(1),t.Q6J("ngIf",r.status.errorMessage))},dependencies:[l.O5,o.qC],styles:["[_nghost-%COMP%]{line-height:0;font-size:0}"],changeDetection:0})}return e})();const H=["text"],G=function(e,i){return{c:e,filter:i}};function K(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"a",6),t._uU(2),t.qZA(),t.BQk()),2&e){const n=i.ngIf,a=t.oxw();t.xp6(1),t.Q6J("queryParams",t.WLB(2,G,a.yamcs.context,n)),t.xp6(1),t.hij(" ",n," ")}}function j(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.qZA(),t.BQk()),2&e){const n=i.$implicit;t.xp6(2),t.Oqu(n.namespace),t.xp6(2),t.Oqu(n.name)}}function X(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Description"),t.qZA(),t.TgZ(3,"dd"),t._UZ(4,"app-markdown",7),t.qZA(),t.BQk()),2&e){const n=t.oxw();t.xp6(4),t.Q6J("text",n.algorithm.longDescription)}}function W(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Description"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.qZA(),t.BQk()),2&e){const n=t.oxw();t.xp6(4),t.hij(" ",n.algorithm.shortDescription||"-"," ")}}function tt(e,i){1&e&&(t.ynx(0),t._uU(1,"OK"),t.BQk())}function et(e,i){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Oqu(n.status.errorMessage)}}function nt(e,i){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"nanosDuration"),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,n.status.execTimeNs/n.status.runCount)," ")}}function at(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function it(e,i){if(1&e&&(t.ynx(0),t._UZ(1,"mat-divider"),t.TgZ(2,"dl",3)(3,"dt"),t._uU(4,"Status"),t.qZA(),t.TgZ(5,"dd",8),t._UZ(6,"app-algorithm-status",9),t._uU(7,"\xa0 "),t.YNc(8,tt,2,0,"ng-container",1),t.YNc(9,et,2,1,"ng-container",1),t.qZA(),t.TgZ(10,"dt"),t._uU(11,"Run count"),t.qZA(),t.TgZ(12,"dd"),t._uU(13),t.ALo(14,"number"),t.qZA(),t.TgZ(15,"dt"),t._uU(16,"Total run time"),t.qZA(),t.TgZ(17,"dd"),t._uU(18),t.ALo(19,"nanosDuration"),t.qZA(),t.TgZ(20,"dt"),t._uU(21,"Average run time"),t.qZA(),t.TgZ(22,"dd"),t.YNc(23,nt,3,3,"span",1),t.YNc(24,at,2,0,"span",1),t.qZA(),t.TgZ(25,"dt"),t._uU(26,"Last run"),t.qZA(),t.TgZ(27,"dd"),t._uU(28),t.ALo(29,"datetime"),t.qZA()(),t.BQk()),2&e){const n=t.oxw();t.xp6(6),t.Q6J("status",n.status),t.xp6(2),t.Q6J("ngIf",!n.status.errorMessage),t.xp6(1),t.Q6J("ngIf",n.status.errorMessage),t.xp6(4),t.Oqu(t.lcZ(14,8,n.status.runCount)||"-"),t.xp6(5),t.hij(" ",t.lcZ(19,10,n.status.execTimeNs)||"-"," "),t.xp6(5),t.Q6J("ngIf",n.status.runCount),t.xp6(1),t.Q6J("ngIf",!n.status.runCount),t.xp6(4),t.Oqu(t.lcZ(29,12,n.status.lastRun)||"-")}}function rt(e,i){1&e&&(t.TgZ(0,"ya-help"),t._uU(1," You may override the MDB algorithm text. Such a change is scoped to the current processor only and will not persist across server restarts. "),t.qZA())}function ot(e,i){1&e&&(t.TgZ(0,"span",14),t._uU(1," MDB Override "),t.qZA())}function st(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"div",15)(1,"button",16),t.NdJ("click",function(){t.CHM(n);const r=t.oxw(2);return t.KtG(r.saveTextChanges())}),t.ALo(2,"async"),t.TgZ(3,"mat-icon"),t._uU(4,"save"),t.qZA(),t._uU(5," Save "),t.qZA(),t.TgZ(6,"button",17),t.NdJ("click",function(){t.CHM(n);const r=t.oxw(2);return t.KtG(r.revertText())}),t.ALo(7,"async"),t.TgZ(8,"mat-icon"),t._uU(9,"undo"),t.qZA(),t._uU(10," Restore MDB text "),t.qZA()()}if(2&e){const n=t.oxw(2);let a;t.xp6(1),t.Q6J("disabled",!t.lcZ(2,2,n.dirty$)),t.xp6(5),t.Q6J("disabled",!(null!=(a=t.lcZ(7,4,n.overrides$))&&a.textOverride))}}function ct(e,i){if(1&e&&(t.ynx(0),t._UZ(1,"mat-divider"),t.TgZ(2,"dl",3)(3,"dt"),t._uU(4," Text "),t.YNc(5,rt,2,0,"ya-help",1),t._UZ(6,"br"),t.YNc(7,ot,2,0,"span",10),t.ALo(8,"async"),t.qZA(),t.TgZ(9,"dd"),t.YNc(10,st,11,6,"div",11),t._UZ(11,"div",12,13),t.qZA()(),t.BQk()),2&e){const n=t.oxw();let a;t.xp6(5),t.Q6J("ngIf",n.isChangeMissionDatabaseEnabled()),t.xp6(2),t.Q6J("ngIf",null==(a=t.lcZ(8,3,n.overrides$))?null:a.textOverride),t.xp6(3),t.Q6J("ngIf",n.isChangeMissionDatabaseEnabled())}}function lt(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"td"),t._uU(2,"Operand"),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(4),t.Oqu(n.value)}}function _t(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"td"),t._uU(2,"Operator"),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(4),t.Oqu(n.operator)}}function gt(e,i){1&e&&(t.ynx(0),t.TgZ(1,"td"),t._uU(2,"Operand"),t.qZA(),t.TgZ(3,"td"),t._uU(4,"this"),t.qZA(),t.BQk())}const mt=function(e){return["/mdb/parameters/",e]},p=function(e){return{c:e}};function ut(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"td"),t._uU(2,"Operand"),t.qZA(),t.TgZ(3,"td")(4,"a",21),t._uU(5),t.qZA()(),t.BQk()),2&e){const n=t.oxw().$implicit,a=t.oxw(2);t.xp6(4),t.Q6J("routerLink",t.VKq(3,mt,n.parameter.qualifiedName))("queryParams",t.VKq(5,p,a.yamcs.context)),t.xp6(1),t.Oqu(n.parameter.qualifiedName)}}function ht(e,i){1&e&&(t.TgZ(0,"tr",19),t.YNc(1,lt,5,1,"ng-container",20),t.YNc(2,_t,5,1,"ng-container",20),t.YNc(3,gt,5,0,"ng-container",20),t.YNc(4,ut,6,7,"ng-container",20),t.qZA()),2&e&&(t.Q6J("ngSwitch",i.$implicit.type),t.xp6(1),t.Q6J("ngSwitchCase","VALUE_OPERAND"),t.xp6(1),t.Q6J("ngSwitchCase","OPERATOR"),t.xp6(1),t.Q6J("ngSwitchCase","THIS_PARAMETER_OPERAND"),t.xp6(1),t.Q6J("ngSwitchCase","PARAMETER"))}function pt(e,i){if(1&e&&(t.ynx(0),t._UZ(1,"mat-divider"),t.TgZ(2,"dl",3)(3,"dt"),t._uU(4,"Postfix Expression"),t.qZA(),t.TgZ(5,"dd")(6,"table",5)(7,"tr")(8,"th"),t._uU(9,"Type"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Value"),t.qZA()(),t.YNc(12,ht,5,5,"tr",18),t.qZA()()(),t.BQk()),2&e){const n=t.oxw();t.xp6(12),t.Q6J("ngForOf",n.algorithm.mathElements)}}function ft(e,i){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"check"),t.qZA())}function dt(e,i){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"close"),t.qZA())}const A=function(e){return["/telemetry/parameters/",e]};function xt(e,i){if(1&e&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td")(4,"a",22),t._uU(5),t.qZA()(),t.TgZ(6,"td",23),t._uU(7),t.qZA(),t.TgZ(8,"td",23),t.YNc(9,ft,2,0,"mat-icon",1),t.YNc(10,dt,2,0,"mat-icon",1),t.qZA()()),2&e){const n=i.$implicit,a=t.oxw(2);t.xp6(2),t.Oqu(n.inputName||"-"),t.xp6(2),t.Q6J("routerLink",t.VKq(7,A,n.parameter.qualifiedName))("queryParams",t.VKq(9,p,a.yamcs.context)),t.xp6(1),t.hij(" ",n.parameter.qualifiedName," "),t.xp6(2),t.hij(" ",n.parameterInstance," "),t.xp6(2),t.Q6J("ngIf",n.mandatory),t.xp6(1),t.Q6J("ngIf",!n.mandatory)}}function At(e,i){if(1&e&&(t.TgZ(0,"table",5)(1,"tr")(2,"th"),t._uU(3,"Input name"),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Parameter"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"Instance"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Mandatory"),t.qZA()(),t.YNc(10,xt,11,11,"tr",2),t.qZA()),2&e){const n=t.oxw();t.xp6(10),t.Q6J("ngForOf",n.algorithm.inputParameter)}}function Tt(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function Zt(e,i){if(1&e&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td")(4,"a",22),t._uU(5),t.qZA()()()),2&e){const n=i.$implicit,a=t.oxw(2);t.xp6(2),t.Oqu(n.outputName||"-"),t.xp6(2),t.Q6J("routerLink",t.VKq(4,A,n.parameter.qualifiedName))("queryParams",t.VKq(6,p,a.yamcs.context)),t.xp6(1),t.hij(" ",n.parameter.qualifiedName," ")}}function yt(e,i){if(1&e&&(t.TgZ(0,"table",5)(1,"tr")(2,"th"),t._uU(3,"Output name"),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Parameter"),t.qZA()(),t.YNc(6,Zt,6,8,"tr",2),t.qZA()),2&e){const n=t.oxw();t.xp6(6),t.Q6J("ngForOf",n.algorithm.outputParameter)}}function qt(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function bt(e,i){if(1&e&&(t.TgZ(0,"tr")(1,"td"),t._uU(2,"OnParameterUpdate"),t.qZA(),t.TgZ(3,"td")(4,"a",22),t._uU(5),t.qZA()()()),2&e){const n=i.$implicit,a=t.oxw();t.xp6(4),t.Q6J("routerLink",t.VKq(3,A,n.qualifiedName))("queryParams",t.VKq(5,p,a.yamcs.context)),t.xp6(1),t.hij(" ",n.qualifiedName," ")}}function Ut(e,i){if(1&e&&(t.TgZ(0,"tr")(1,"td"),t._uU(2,"OnPeriodicRate"),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA()()),2&e){const n=t.oxw();t.xp6(4),t.hij("",n.algorithm.onPeriodicRate," ms")}}let vt=(()=>{class e{constructor(n,a,r,s){this.route=n,this.yamcs=a,this.messageService=r,this.authService=s,this.overrides$=new g.X(null),this.dirty$=new g.X(!1)}ngAfterViewInit(){this.algorithm.text&&(this.initializeEditor(),this.refreshOverrides())}isChangeMissionDatabaseEnabled(){return this.authService.getUser().hasSystemPrivilege("ChangeMissionDatabase")}initializeEditor(){switch(this.editor=L.edit(this.textContainer.nativeElement),this.editor.$blockScrolling=1/0,this.isChangeMissionDatabaseEnabled()?this.editor.addEventListener("change",()=>{this.dirty$.next(!0)}):this.editor.setReadOnly(!0),this.algorithm.language.toLowerCase()){case"javascript":this.editor.getSession().setMode("ace/mode/javascript");break;case"python":this.editor.getSession().setMode("ace/mode/python");break;default:console.warn(`Unexpected language ${this.algorithm.language}`)}this.editor.setTheme("ace/theme/eclipse")}refreshOverrides(){const n=this.route.parent.snapshot.paramMap.get("qualifiedName");this.yamcs.yamcsClient.getAlgorithmOverrides(this.yamcs.instance,this.yamcs.processor,n).then(s=>{this.overrides$.next(s),this.updateEditorValue(s.textOverride?s.textOverride.text:this.algorithm.text)}).catch(s=>this.messageService.showError(s))}updateEditorValue(n){this.editor.session.setValue(n),this.dirty$.next(!1)}saveTextChanges(){const n=this.editor.getSession().getValue();this.yamcs.yamcsClient.updateAlgorithmText(this.yamcs.instance,this.yamcs.processor,this.algorithm.qualifiedName,n).then(()=>this.refreshOverrides()).catch(s=>this.messageService.showError(s))}revertText(){this.yamcs.yamcsClient.revertAlgorithmText(this.yamcs.instance,this.yamcs.processor,this.algorithm.qualifiedName).then(()=>this.refreshOverrides()).catch(r=>this.messageService.showError(r))}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(_.gz),t.Y36(o.C8),t.Y36(o.ez),t.Y36(B.e))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-algorithm-detail"]],viewQuery:function(a,r){if(1&a&&t.Gf(H,5),2&a){let s;t.iGM(s=t.CRH())&&(r.textContainer=s.first)}},inputs:{algorithm:"algorithm",status:"status"},decls:58,vars:21,consts:[[1,"dl-horizontal","no-lead"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"dl-horizontal"],["yaDataTable","",4,"ngIf"],["yaDataTable",""],["routerLink","/algorithms",1,"ya-link",3,"queryParams"],[3,"text"],[2,"display","flex","align-items","center"],[3,"status"],["class","override-annotation",4,"ngIf"],["style","padding-bottom: 5px",4,"ngIf"],[1,"algorithm-text"],["text",""],[1,"override-annotation"],[2,"padding-bottom","5px"],[1,"ya-button",2,"margin-right","5px",3,"disabled","click"],[1,"ya-button",3,"disabled","click"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"ya-link",3,"routerLink","queryParams"],[3,"routerLink","queryParams"],[2,"text-align","center"]],template:function(a,r){1&a&&(t.TgZ(0,"dl",0)(1,"dt"),t._uU(2,"Algorithm"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.ALo(5,"shortName"),t.qZA(),t.TgZ(6,"dt"),t._uU(7,"Space system"),t.qZA(),t.TgZ(8,"dd"),t.YNc(9,K,3,5,"ng-container",1),t.ALo(10,"spaceSystemName"),t.qZA(),t.YNc(11,j,5,2,"ng-container",2),t.YNc(12,X,5,1,"ng-container",1),t.YNc(13,W,5,1,"ng-container",1),t.qZA(),t._UZ(14,"mat-divider"),t.TgZ(15,"dl",3)(16,"dt"),t._uU(17,"Scope"),t.qZA(),t.TgZ(18,"dd"),t._uU(19),t.qZA(),t.TgZ(20,"dt"),t._uU(21,"Type"),t.qZA(),t.TgZ(22,"dd"),t._uU(23),t.qZA(),t.TgZ(24,"dt"),t._uU(25,"Language"),t.qZA(),t.TgZ(26,"dd"),t._uU(27),t.qZA()(),t.YNc(28,it,30,14,"ng-container",1),t.YNc(29,ct,13,5,"ng-container",1),t.YNc(30,pt,13,1,"ng-container",1),t._UZ(31,"mat-divider"),t.TgZ(32,"dl",3)(33,"dt"),t._uU(34,"Input parameters"),t.qZA(),t.TgZ(35,"dd"),t.YNc(36,At,11,1,"table",4),t.YNc(37,Tt,2,0,"span",1),t.qZA()(),t._UZ(38,"mat-divider"),t.TgZ(39,"dl",3)(40,"dt"),t._uU(41,"Output parameters"),t.qZA(),t.TgZ(42,"dd"),t.YNc(43,yt,7,1,"table",4),t.YNc(44,qt,2,0,"span",1),t.qZA()(),t._UZ(45,"mat-divider"),t.TgZ(46,"dl",3)(47,"dt"),t._uU(48,"Triggers"),t.qZA(),t.TgZ(49,"dd")(50,"table",5)(51,"tr")(52,"th"),t._uU(53,"Type"),t.qZA(),t.TgZ(54,"th"),t._uU(55,"Value"),t.qZA()(),t.YNc(56,bt,6,7,"tr",2),t.YNc(57,Ut,5,1,"tr",1),t.qZA()()()),2&a&&(t.xp6(4),t.Oqu(t.lcZ(5,17,r.algorithm.qualifiedName)),t.xp6(5),t.Q6J("ngIf",t.lcZ(10,19,r.algorithm.qualifiedName)),t.xp6(2),t.Q6J("ngForOf",r.algorithm.alias),t.xp6(1),t.Q6J("ngIf",r.algorithm.longDescription),t.xp6(1),t.Q6J("ngIf",!r.algorithm.longDescription),t.xp6(6),t.Oqu(r.algorithm.scope||"-"),t.xp6(4),t.Oqu(r.algorithm.type||"-"),t.xp6(4),t.Oqu(r.algorithm.language||"-"),t.xp6(1),t.Q6J("ngIf",r.status&&"GLOBAL"===r.algorithm.scope),t.xp6(1),t.Q6J("ngIf",r.algorithm.text),t.xp6(1),t.Q6J("ngIf",r.algorithm.mathElements),t.xp6(6),t.Q6J("ngIf",r.algorithm.inputParameter),t.xp6(1),t.Q6J("ngIf",!r.algorithm.inputParameter),t.xp6(6),t.Q6J("ngIf",r.algorithm.outputParameter),t.xp6(1),t.Q6J("ngIf",!r.algorithm.outputParameter),t.xp6(12),t.Q6J("ngForOf",r.algorithm.onParameterUpdate),t.xp6(1),t.Q6J("ngIf",r.algorithm.onPeriodicRate))},dependencies:[l.sg,l.O5,l.RF,l.n9,_.rH,o.Gj,x.Hw,E.d,o.IR,F.U,z,l.Ov,l.JJ,o.id,o.B_,o.yk,o.BC],styles:["code[_ngcontent-%COMP%]{display:block;background-color:#fafafa;padding:1em;font-size:10px;border:1px solid #d3d3d3;white-space:pre}.algorithm-text[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.12);height:300px}.override-annotation[_ngcontent-%COMP%]{font-style:italic;font-weight:300}"],changeDetection:0})}return e})();function Nt(e,i){if(1&e&&(t.ynx(0),t._UZ(1,"app-algorithm-detail",2),t.ALo(2,"async"),t.BQk()),2&e){const n=i.ngIf,a=t.oxw();t.xp6(1),t.Q6J("algorithm",n)("status",t.lcZ(2,2,a.status$))}}let v=(()=>{class e{constructor(n,a){this.yamcs=a,this.status$=new g.X(null);const r=n.parent.snapshot.paramMap.get("qualifiedName");this.algorithm$=a.yamcsClient.getAlgorithm(this.yamcs.instance,r),this.yamcs.processor&&(this.algorithmStatusSubscription=a.yamcsClient.createAlgorithmStatusSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,name:r},h=>this.status$.next(h)))}ngOnDestroy(){this.algorithmStatusSubscription&&this.algorithmStatusSubscription.cancel()}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(_.gz),t.Y36(o.C8))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],decls:3,vars:3,consts:[[1,"panel-content"],[4,"ngIf"],[3,"algorithm","status"]],template:function(a,r){1&a&&(t.TgZ(0,"div",0),t.YNc(1,Nt,3,4,"ng-container",1),t.ALo(2,"async"),t.qZA()),2&a&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,r.algorithm$)))},dependencies:[l.O5,vt,l.Ov],encapsulation:2,changeDetection:0})}return e})();function wt(e,i){if(1&e){const n=t.EpF();t.ynx(0),t._UZ(1,"span",8),t.TgZ(2,"ya-text-action",9),t.NdJ("click",function(){t.CHM(n);const r=t.oxw(4);return t.KtG(r.switchToSection("runs"))}),t._uU(3," Runs "),t.qZA(),t._uU(4," \xa0\xa0 "),t.TgZ(5,"ya-text-action",10),t.NdJ("click",function(){t.CHM(n);const r=t.oxw(4);return t.KtG(r.switchToSection("logs"))}),t._uU(6," Logs "),t.qZA(),t.BQk()}if(2&e){const n=i.ngIf;t.xp6(2),t.Q6J("active","runs"===n),t.xp6(3),t.Q6J("active","logs"===n)}}function Qt(e,i){1&e&&(t.TgZ(0,"mat-icon",19),t._uU(1,"check_circle"),t.qZA())}function Pt(e,i){1&e&&(t.TgZ(0,"mat-icon",20),t._uU(1,"error"),t.qZA())}function It(e,i){1&e&&t._UZ(0,"br")}const N=function(e){return["/telemetry/parameters/",e]},w=function(e){return{c:e}};function Jt(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"a",21),t._uU(2),t.qZA(),t._uU(3,": "),t._UZ(4,"ya-value",22),t.YNc(5,It,1,0,"br",0),t.BQk()),2&e){const n=i.$implicit,a=i.last,r=t.oxw(8);t.xp6(1),t.Q6J("routerLink",t.VKq(5,N,n.id.name))("queryParams",t.VKq(7,w,r.yamcs.context)),t.xp6(1),t.hij(" ",n.id.name,""),t.xp6(2),t.Q6J("value",n.engValue),t.xp6(1),t.Q6J("ngIf",!a)}}function St(e,i){1&e&&(t.ynx(0),t._uU(1,"-"),t.BQk())}function Ot(e,i){1&e&&t._UZ(0,"br")}function Dt(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"a",21),t._uU(2),t.qZA(),t._uU(3,": "),t._UZ(4,"ya-value",22),t.YNc(5,Ot,1,0,"br",0),t.BQk()),2&e){const n=i.$implicit,a=i.last,r=t.oxw(8);t.xp6(1),t.Q6J("routerLink",t.VKq(5,N,n.id.name))("queryParams",t.VKq(7,w,r.yamcs.context)),t.xp6(1),t.hij(" ",n.id.name,""),t.xp6(2),t.Q6J("value",n.engValue),t.xp6(1),t.Q6J("ngIf",!a)}}function Ct(e,i){1&e&&(t.ynx(0),t._uU(1,"-"),t.BQk())}const Q=function(){return[]};function Yt(e,i){if(1&e&&(t.TgZ(0,"tr")(1,"td",13),t.YNc(2,Qt,2,0,"mat-icon",15),t.YNc(3,Pt,2,0,"mat-icon",16),t.qZA(),t.TgZ(4,"td",17),t._uU(5),t.ALo(6,"datetime"),t.qZA(),t.TgZ(7,"td",18),t.YNc(8,Jt,6,9,"ng-container",14),t.YNc(9,St,2,0,"ng-container",0),t.qZA(),t.TgZ(10,"td",18),t.YNc(11,Dt,6,9,"ng-container",14),t.YNc(12,Ct,2,0,"ng-container",0),t.qZA(),t.TgZ(13,"td",17),t._uU(14),t.ALo(15,"nvl"),t.qZA(),t.TgZ(16,"td",17),t._uU(17),t.qZA(),t._UZ(18,"td"),t.qZA()),2&e){const n=i.$implicit;t.xp6(2),t.Q6J("ngIf",!n.error),t.xp6(1),t.Q6J("ngIf",n.error),t.xp6(2),t.Oqu(t.lcZ(6,9,n.time)),t.xp6(3),t.Q6J("ngForOf",n.inputs||t.DdM(14,Q)),t.xp6(1),t.Q6J("ngIf",!(null!=n.inputs&&n.inputs.length)),t.xp6(2),t.Q6J("ngForOf",n.outputs||t.DdM(15,Q)),t.xp6(1),t.Q6J("ngIf",!(null!=n.outputs&&n.outputs.length)),t.xp6(2),t.Oqu(t.xi3(15,11,n.returnValue,"-")),t.xp6(3),t.Oqu(n.error||"-")}}function kt(e,i){if(1&e&&(t.TgZ(0,"table",12)(1,"tr"),t._UZ(2,"th",13),t.TgZ(3,"th"),t._uU(4,"Started"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Inputs"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Outputs"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Return value"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Error"),t.qZA(),t._UZ(13,"th"),t.qZA(),t.YNc(14,Yt,19,16,"tr",14),t.qZA()),2&e){const n=t.oxw().ngIf;t.xp6(14),t.Q6J("ngForOf",n.runs)}}function Mt(e,i){if(1&e&&(t.ynx(0),t.YNc(1,kt,15,1,"table",11),t.BQk()),2&e){const n=i.ngIf;t.oxw(5);const a=t.MAs(5);t.xp6(1),t.Q6J("ngIf",null==n.runs?null:n.runs.length)("ngIfElse",a)}}function $t(e,i){if(1&e&&(t.ynx(0),t.YNc(1,Mt,2,2,"ng-container",3),t.ALo(2,"async"),t.BQk()),2&e){const n=t.oxw(4),a=t.MAs(5);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,n.trace$))("ngIfElse",a)}}function Lt(e,i){if(1&e&&(t.TgZ(0,"tr")(1,"td",25),t._uU(2),t.ALo(3,"datetime"),t.qZA(),t.TgZ(4,"td",26),t._uU(5),t.qZA()()),2&e){const n=i.$implicit;t.xp6(2),t.hij("[",t.lcZ(3,2,n.time),"]"),t.xp6(3),t.Oqu(n.msg)}}function Bt(e,i){if(1&e&&(t.TgZ(0,"table",24),t.YNc(1,Lt,6,4,"tr",14),t.qZA()),2&e){const n=t.oxw().ngIf;t.xp6(1),t.Q6J("ngForOf",n.logs)}}function Et(e,i){if(1&e&&(t.ynx(0),t.YNc(1,Bt,2,1,"table",23),t.BQk()),2&e){const n=i.ngIf;t.oxw(5);const a=t.MAs(5);t.xp6(1),t.Q6J("ngIf",null==n.logs?null:n.logs.length)("ngIfElse",a)}}function Ft(e,i){if(1&e&&(t.ynx(0),t.YNc(1,Et,2,2,"ng-container",3),t.ALo(2,"async"),t.BQk()),2&e){const n=t.oxw(4),a=t.MAs(5);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,n.trace$))("ngIfElse",a)}}function Vt(e,i){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",4)(2,"div",5)(3,"button",6),t.NdJ("click",function(){t.CHM(n);const r=t.oxw(3);return t.KtG(r.stopTrace())}),t._uU(4,"Stop trace"),t.qZA(),t._uU(5,"\xa0 "),t.TgZ(6,"button",6),t.NdJ("click",function(){t.CHM(n);const r=t.oxw(3);return t.KtG(r.refreshData())}),t._uU(7,"Refresh"),t.qZA(),t._uU(8,"\xa0 "),t.YNc(9,wt,7,2,"ng-container",0),t.ALo(10,"async"),t.qZA()(),t.TgZ(11,"div",7),t.YNc(12,$t,3,4,"ng-container",0),t.ALo(13,"async"),t.YNc(14,Ft,3,4,"ng-container",0),t.ALo(15,"async"),t.qZA(),t.BQk()}if(2&e){const n=t.oxw(3);t.xp6(9),t.Q6J("ngIf",t.lcZ(10,3,n.section$)),t.xp6(3),t.Q6J("ngIf","runs"===t.lcZ(13,5,n.section$)),t.xp6(2),t.Q6J("ngIf","logs"===t.lcZ(15,7,n.section$))}}function Rt(e,i){if(1&e&&(t.ynx(0),t.YNc(1,Vt,16,9,"ng-container",3),t.BQk()),2&e){const n=i.ngIf;t.oxw(2);const a=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.traceEnabled)("ngIfElse",a)}}function zt(e,i){if(1&e&&(t.ynx(0),t.YNc(1,Rt,2,2,"ng-container",0),t.ALo(2,"async"),t.BQk()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n.status$))}}function Ht(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"ya-empty-message",27)(1,"p"),t._uU(2," The trace tool captures runs, inputs, outputs and log messages of this algorithm. "),t.qZA(),t.TgZ(3,"p")(4,"button",28),t.NdJ("click",function(){t.CHM(n);const r=t.oxw();return t.KtG(r.startTrace())}),t._uU(5,"Start trace"),t.qZA()()()}}function Gt(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"ya-empty-message")(1,"p"),t._uU(2," Tracing has started. "),t.qZA(),t.TgZ(3,"p"),t._uU(4," This page does "),t.TgZ(5,"strong"),t._uU(6,"not"),t.qZA(),t._uU(7," update automatically. "),t.qZA(),t.TgZ(8,"p"),t._uU(9," Hit refresh, or check back at a later time when you think there should be trace entries. "),t.qZA(),t.TgZ(10,"p")(11,"button",28),t.NdJ("click",function(){t.CHM(n);const r=t.oxw();return t.KtG(r.refreshData())}),t._uU(12,"Refresh"),t.qZA()()()}}let P=(()=>{class e{constructor(n,a,r,s,h){this.route=n,this.router=a,this.yamcs=r,this.messageService=h,this.status$=new g.X(null),this.trace$=new g.X(null),this.section$=new g.X("runs"),this.qualifiedName=n.parent.snapshot.paramMap.get("qualifiedName"),this.algorithm$=r.yamcsClient.getAlgorithm(this.yamcs.instance,this.qualifiedName),this.algorithm$.then(Ne=>{s.setTitle(Ne.name)}),this.refreshData()}ngAfterViewInit(){const n=this.route.snapshot.queryParamMap;n.has("section")&&this.switchToSection(n.get("section"))}switchToSection(n){this.section$.next(n),this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{section:n},queryParamsHandling:"merge"})}refreshData(){this.yamcs.processor?(this.yamcs.yamcsClient.getAlgorithmStatus(this.yamcs.instance,this.yamcs.processor,this.qualifiedName).then(n=>{this.status$.next(n)}).catch(n=>{this.messageService.showError(n)}),this.yamcs.yamcsClient.getAlgorithmTrace(this.yamcs.instance,this.yamcs.processor,this.qualifiedName).then(n=>{this.trace$.next(n)}).catch(n=>{this.messageService.showError(n)})):(this.status$.next(null),this.trace$.next(null))}startTrace(){const n=this.route.parent.snapshot.paramMap.get("qualifiedName");this.yamcs.yamcsClient.startAlgorithmTrace(this.yamcs.instance,this.yamcs.processor,n).then(()=>{this.refreshData()}).catch(a=>{this.messageService.showError(a)})}stopTrace(){const n=this.route.parent.snapshot.paramMap.get("qualifiedName");this.yamcs.yamcsClient.stopAlgorithmTrace(this.yamcs.instance,this.yamcs.processor,n).then(()=>{this.refreshData(),this.switchToSection("runs"),this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{section:null},queryParamsHandling:"merge"})}).catch(a=>{this.messageService.showError(a)})}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(_.gz),t.Y36(_.F0),t.Y36(o.C8),t.Y36(f.Dx),t.Y36(o.ez))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],decls:6,vars:3,consts:[[4,"ngIf"],["notrace",""],["empty",""],[4,"ngIf","ngIfElse"],[1,"extra-bar-container"],[1,"extra-bar"],[1,"ya-button",3,"click"],[1,"panel-content"],[1,"separator",2,"margin-left","10px","margin-right","10px"],["icon","directions_run",3,"active","click"],["icon","menu_book",3,"active","click"],["yaDataTable","","class","expand",4,"ngIf","ngIfElse"],["yaDataTable","",1,"expand"],[1,"status"],[4,"ngFor","ngForOf"],["class","success",4,"ngIf"],["class","alert",4,"ngIf"],[2,"width","200px"],[2,"width","400px"],[1,"success"],[1,"alert"],[1,"secundary",3,"routerLink","queryParams"],[3,"value"],["class","logs mono","style","width: 100%",4,"ngIf","ngIfElse"],[1,"logs","mono",2,"width","100%"],["width","1",1,"time",2,"white-space","nowrap"],[1,"msg",2,"white-space","pre"],["headerTitle","Trace"],[1,"ya-button","primary",3,"click"]],template:function(a,r){1&a&&(t.YNc(0,zt,3,3,"ng-container",0),t.ALo(1,"async"),t.YNc(2,Ht,6,0,"ng-template",null,1,t.W1O),t.YNc(4,Gt,13,0,"ng-template",null,2,t.W1O)),2&a&&t.Q6J("ngIf",t.lcZ(1,1,r.algorithm$))},dependencies:[l.sg,l.O5,_.rH,o.Gj,x.Hw,o.RR,o.ll,o.u$,l.Ov,o.id,o.mc],styles:[".extra-bar-container[_ngcontent-%COMP%]{padding:12px;border-bottom:1.1px solid rgba(0,0,0,.08)}.extra-bar[_ngcontent-%COMP%]{height:24px;line-height:24px}.separator[_ngcontent-%COMP%]{border-right:1px solid rgba(0,0,0,.12)}table.logs[_ngcontent-%COMP%]{line-height:12px}table.logs[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px;color:#000000a7}table.logs[_ngcontent-%COMP%]   td.time[_ngcontent-%COMP%]{color:#00000059}"],changeDetection:0})}return e})();var I=c(8337),u=c(6223),J=c(9887);class Kt extends I.o2{constructor(i){super(),this.yamcs=i,this.items$=new g.X([]),this.totalSize$=new g.X(0),this.loading$=new g.X(!1)}connect(){return this.items$}loadAlgorithms(i){return this.loading$.next(!0),this.yamcs.yamcsClient.getAlgorithms(this.yamcs.instance,i).then(n=>{this.loading$.next(!1),this.totalSize$.next(n.totalSize);const a=[];for(const r of n.spaceSystems||[])a.push({spaceSystem:!0,name:r});for(const r of n.algorithms||[])a.push({spaceSystem:!1,name:r.qualifiedName,algorithm:r});this.items$.next(a)})}disconnect(){this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}}var m=c(9538);const jt=["top"];function Xt(e,i){if(1&e&&t._UZ(0,"ya-breadcrumb",13),2&e){const n=i.$implicit;t.Q6J("link",n.route)("queryParams",n.queryParams)("label",n.name)}}const S=function(e){return{c:e}};function Wt(e,i){if(1&e&&(t.TgZ(0,"div",4)(1,"ya-breadcrumb-trail"),t._UZ(2,"ya-breadcrumb",11),t.YNc(3,Xt,1,3,"ya-breadcrumb",12),t.qZA()()),2&e){const n=t.oxw().ngIf,a=t.oxw();t.xp6(2),t.Q6J("queryParams",t.VKq(2,S,a.yamcs.context)),t.xp6(1),t.Q6J("ngForOf",n)}}function te(e,i){if(1&e&&(t.ynx(0),t.YNc(1,Wt,4,4,"div",10),t.BQk()),2&e){const n=i.ngIf;t.xp6(1),t.Q6J("ngIf",n.length)}}function ee(e,i){1&e&&(t.TgZ(0,"th",28),t._uU(1,"Name"),t.qZA())}const ne=function(){return["/algorithms"]},ae=function(e,i){return{c:e,system:i}};function ie(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"mat-icon",30),t._uU(2,"folder"),t.qZA(),t.TgZ(3,"a",31),t._uU(4),t.ALo(5,"filename"),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit,a=t.oxw(2);t.xp6(3),t.Q6J("routerLink",t.DdM(5,ne))("queryParams",t.WLB(6,ae,a.yamcs.context,n.name)),t.xp6(1),t.hij("",t.lcZ(5,3,n.name),"/ ")}}function re(e,i){if(1&e&&t._UZ(0,"ya-highlight",33),2&e){const n=t.oxw(2).$implicit,a=t.oxw(2);t.Q6J("text",n.algorithm.qualifiedName)("term",a.filterForm.value.filter)}}function oe(e,i){if(1&e&&(t._UZ(0,"ya-highlight",33),t.ALo(1,"slice")),2&e){const n=t.oxw(2).$implicit,a=t.oxw(2);t.Q6J("text",t.xi3(1,2,n.algorithm.qualifiedName,a.system.length+1))("term",a.filterForm.value.filter)}}const se=function(e){return["/algorithms",e]};function ce(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"mat-icon",30),t._uU(2,"transform"),t.qZA(),t.TgZ(3,"a",31),t.YNc(4,re,1,2,"ya-highlight",32),t.YNc(5,oe,2,5,"ya-highlight",32),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit,a=t.oxw(2);t.xp6(3),t.Q6J("routerLink",t.VKq(4,se,n.algorithm.qualifiedName))("queryParams",t.VKq(6,S,a.yamcs.context)),t.xp6(1),t.Q6J("ngIf",!a.system),t.xp6(1),t.Q6J("ngIf",a.system)}}function le(e,i){if(1&e&&(t.TgZ(0,"td",29),t.YNc(1,ie,6,9,"ng-container",3),t.YNc(2,ce,6,8,"ng-container",3),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.Q6J("ngIf",n.spaceSystem),t.xp6(1),t.Q6J("ngIf",!n.spaceSystem)}}function _e(e,i){1&e&&(t.TgZ(0,"th",28),t._uU(1,"Type"),t.qZA())}function ge(e,i){if(1&e&&(t.TgZ(0,"td",34),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.Oqu((null==n.algorithm?null:n.algorithm.type)||"-")}}function me(e,i){1&e&&(t.TgZ(0,"th",28),t._uU(1,"Language"),t.qZA())}function ue(e,i){if(1&e&&(t.TgZ(0,"td",34),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.Oqu((null==n.algorithm?null:n.algorithm.language)||"-")}}function he(e,i){1&e&&(t.TgZ(0,"th",28),t._uU(1,"Scope"),t.qZA())}function pe(e,i){if(1&e&&(t.TgZ(0,"td",34),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.Oqu((null==n.algorithm?null:n.algorithm.scope)||"-")}}function fe(e,i){1&e&&(t.TgZ(0,"th",28),t._uU(1,"Description"),t.qZA())}function de(e,i){if(1&e&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.Oqu((null==n.algorithm?null:n.algorithm.shortDescription)||"-")}}function xe(e,i){1&e&&t._UZ(0,"th",36)}function Ae(e,i){1&e&&t._UZ(0,"td",34)}function Te(e,i){1&e&&t._UZ(0,"tr",37)}function Ze(e,i){if(1&e&&t._UZ(0,"tr",38),2&e){const n=i.$implicit,a=t.oxw(2);t.ekj("selected",a.selection.isSelected(n))}}function ye(e,i){if(1&e&&(t.TgZ(0,"table",14),t.ynx(1,15),t.YNc(2,ee,2,0,"th",16),t.YNc(3,le,3,2,"td",17),t.BQk(),t.ynx(4,18),t.YNc(5,_e,2,0,"th",16),t.YNc(6,ge,2,1,"td",19),t.BQk(),t.ynx(7,20),t.YNc(8,me,2,0,"th",16),t.YNc(9,ue,2,1,"td",19),t.BQk(),t.ynx(10,21),t.YNc(11,he,2,0,"th",16),t.YNc(12,pe,2,1,"td",19),t.BQk(),t.ynx(13,22),t.YNc(14,fe,2,0,"th",16),t.YNc(15,de,2,1,"td",23),t.BQk(),t.ynx(16,24),t.YNc(17,xe,1,0,"th",25),t.YNc(18,Ae,1,0,"td",19),t.BQk(),t.YNc(19,Te,1,0,"tr",26),t.YNc(20,Ze,1,2,"tr",27),t.qZA()),2&e){const n=t.oxw();t.Q6J("dataSource",n.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns)}}function qe(e,i){if(1&e&&(t.TgZ(0,"div",1),t._uU(1," The Mission Database for "),t.TgZ(2,"i"),t._uU(3),t.qZA(),t._uU(4," does not define any algorithms. "),t.qZA()),2&e){const n=t.oxw();t.xp6(3),t.Oqu(n.yamcs.instance)}}const be=[{path:"",canActivate:[Z.r,C._],canActivateChild:[Z.q],runGuardsAndResolvers:"always",component:Y.K,children:[{path:"",pathMatch:"full",component:(()=>{class e{constructor(n,a,r,s){this.yamcs=n,this.route=r,this.router=s,this.filterForm=new u.nJ({filter:new u.p4,scope:new u.p4("ANY")}),this.shortName=!1,this.pageSize=100,this.system=null,this.breadcrumb$=new g.X([]),this.displayedColumns=["name","type","language","scope","shortDescription","actions"],this.scopeOptions=[{id:"ANY",label:"Any scope"},{id:"GLOBAL",label:"Global"},{id:"COMMAND_VERIFICATION",label:"Command Verification"},{id:"CONTAINER_PROCESSING",label:"Container Processing"}],this.selection=new I.Ov(!1),a.setTitle("Algorithms"),this.dataSource=new Kt(n)}ngAfterViewInit(){const n=this.route.snapshot.queryParamMap;n.has("filter")&&(this.filter=n.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),n.has("scope")&&(this.scope=n.get("scope"),this.filterForm.get("scope").setValue(this.scope)),this.filterForm.get("filter").valueChanges.subscribe(a=>{this.paginator.pageIndex=0,this.filter=a,this.updateDataSource()}),this.filterForm.get("scope").valueChanges.forEach(a=>{this.scope="ANY"!==a?a:null,this.updateDataSource()}),this.changeSystem(this.route.snapshot.queryParamMap),this.queryParamMapSubscription=this.route.queryParamMap.subscribe(a=>{a.get("system")!==this.system&&this.changeSystem(a)}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(n){this.system=n.get("system"),this.updateBrowsePath(),this.paginator.pageIndex=n.has("page")?Number(n.get("page")):0,this.updateDataSource()}updateDataSource(){this.updateURL();const n={system:this.system||"/",pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize};this.filter&&(n.q=this.filter),this.scope&&(n.scope=this.scope),this.dataSource.loadAlgorithms(n).then(()=>{this.selection.clear(),this.updateBrowsePath()})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{page:this.paginator.pageIndex||null,filter:this.filter||null,scope:this.scope||null,system:this.system||null},queryParamsHandling:"merge"})}updateBrowsePath(){const n=[];let a="";if(this.system)for(const r of this.system.slice(1).split("/"))a+="/"+r,n.push({name:r,route:"/algorithms",queryParams:{system:a,c:this.yamcs.context}});this.breadcrumb$.next(n)}selectNext(){const n=this.dataSource.items$.value;let a=0;if(this.selection.hasValue()){const r=this.selection.selected[0];-1!==n.indexOf(r)&&(a=Math.min(n.indexOf(r)+1,n.length-1))}this.selection.select(n[a])}selectPrevious(){const n=this.dataSource.items$.value;let a=0;if(this.selection.hasValue()){const r=this.selection.selected[0];-1!==n.indexOf(r)&&(a=Math.max(n.indexOf(r)-1,0))}this.selection.select(n[a])}applySelection(){if(this.selection.hasValue()){const n=this.selection.selected[0];-1!==this.dataSource.items$.value.indexOf(n)&&this.router.navigate(["/algorithms",n.algorithm?.qualifiedName],{queryParams:{c:this.yamcs.context}})}}ngOnDestroy(){this.queryParamMapSubscription&&this.queryParamMapSubscription.unsubscribe(),this.dataSource.disconnect()}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(o.C8),t.Y36(f.Dx),t.Y36(_.gz),t.Y36(_.F0))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],viewQuery:function(a,r){if(1&a&&(t.Gf(jt,7),t.Gf(J.NW,7)),2&a){let s;t.iGM(s=t.CRH())&&(r.top=s.first),t.iGM(s=t.CRH())&&(r.paginator=s.first)}},decls:17,vars:13,consts:[["top",""],[1,"panel-content"],[3,"formGroup"],[4,"ngIf"],[1,"filter-bar"],["placeholder","Search by name","icon","search",3,"formControl","onArrowDown","onArrowUp","onEnter"],["formControlName","scope",3,"options"],["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["empty",""],["class","filter-bar",4,"ngIf"],["link","/algorithms","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label",4,"ngFor","ngForOf"],[3,"link","queryParams","label"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","primary-td",4,"matCellDef"],["matColumnDef","type"],["mat-cell","",4,"matCellDef"],["matColumnDef","language"],["matColumnDef","scope"],["matColumnDef","shortDescription"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],[3,"routerLink","queryParams"],[3,"text","term",4,"ngIf"],[3,"text","term"],["mat-cell",""],["mat-cell","",1,"wrap200"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(a,r){1&a&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),t._uU(2," Algorithms "),t.qZA(),t._UZ(3,"span",null,0),t.TgZ(5,"div",1)(6,"form",2),t.YNc(7,te,2,1,"ng-container",3),t.ALo(8,"async"),t.TgZ(9,"div",4)(10,"ya-search-filter",5),t.NdJ("onArrowDown",function(){return r.selectNext()})("onArrowUp",function(){return r.selectPrevious()})("onEnter",function(){return r.applySelection()}),t.qZA(),t._UZ(11,"ya-select",6),t.qZA()(),t.YNc(12,ye,21,3,"table",7),t._UZ(13,"mat-paginator",8),t.ALo(14,"async"),t.qZA(),t.YNc(15,qe,5,1,"ng-template",null,9,t.W1O),t.qZA()),2&a&&(t.xp6(6),t.Q6J("formGroup",r.filterForm),t.xp6(1),t.Q6J("ngIf",t.lcZ(8,9,r.breadcrumb$)),t.xp6(3),t.Q6J("formControl",r.filterForm.controls.filter),t.xp6(1),t.Q6J("options",r.scopeOptions),t.xp6(1),t.Q6J("ngIf",r.dataSource),t.xp6(1),t.Q6J("pageSize",r.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",t.lcZ(14,11,r.dataSource.totalSize$)))},dependencies:[l.sg,l.O5,u._Y,u.JJ,u.JL,u.oH,u.sg,u.u,_.rH,x.Hw,J.NW,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,o.LI,o.O_,o.oQ,o.cF,o.Hr,y.a,q.k,l.Ov,l.OU,o.XB],styles:[".primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}"],changeDetection:0})}return e})()},{path:":qualifiedName",component:U,children:[{path:"",pathMatch:"full",redirectTo:"summary"},{path:"summary",component:v},{path:"trace",component:P}]}]}];let Ue=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[_.Bz.forChild(be),_.Bz]})}return e})(),ve=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[D.m,Ue]})}return e})()}}]);