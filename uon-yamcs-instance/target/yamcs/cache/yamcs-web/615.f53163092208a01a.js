"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[615],{3615:(Pl,re,g)=>{g.r(re),g.d(re,{CommandingModule:()=>Sl});var Be=g(7216),e=g(5879);const Re=/yamcs<([^>]+)>_/g;let le=(()=>{class n{transform(t){if(!t||!t.startsWith("yamcs<"))return t;let i,a=[];for(;i=Re.exec(t);)a.push(i[1]);return a.length?a[a.length-1]:t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275pipe=e.Yjl({name:"cascadingPrefix",type:n,pure:!0})}return n})();var l=g(6223),r=g(6516),u=g(6814),C=g(5619),Ve=g(3997);function je(n,o){if(1&n&&(e.TgZ(0,"ya-help"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.description," ")}}function Ge(n,o){if(1&n&&e._UZ(0,"app-aggregate-argument",11),2&n){const t=e.oxw().index,i=e.oxw();e.Q6J("name",i.name)("type",i.type.elementType)("index",t)("dimensions",i.ownDimensions)("initialValue",i.entryInitialValues[t])}}function We(n,o){if(1&n&&e._UZ(0,"app-binary-argument",12),2&n){const t=e.oxw().index,i=e.oxw();e.Q6J("name",i.name)("type",i.type.elementType)("index",t)("dimensions",i.ownDimensions)("formControlName",t)}}function Xe(n,o){if(1&n&&e._UZ(0,"app-boolean-argument",12),2&n){const t=e.oxw().index,i=e.oxw();e.Q6J("name",i.name)("type",i.type.elementType)("index",t)("dimensions",i.ownDimensions)("formControlName",t)}}function ze(n,o){if(1&n&&e._UZ(0,"app-enumeration-argument",12),2&n){const t=e.oxw().index,i=e.oxw();e.Q6J("name",i.name)("type",i.type.elementType)("index",t)("dimensions",i.ownDimensions)("formControlName",t)}}function Ke(n,o){if(1&n&&e._UZ(0,"app-float-argument",12),2&n){const t=e.oxw().index,i=e.oxw();e.Q6J("name",i.name)("type",i.type.elementType)("index",t)("dimensions",i.ownDimensions)("formControlName",t)}}function et(n,o){if(1&n&&e._UZ(0,"app-integer-argument",12),2&n){const t=e.oxw().index,i=e.oxw();e.Q6J("name",i.name)("type",i.type.elementType)("index",t)("dimensions",i.ownDimensions)("formControlName",t)}}function tt(n,o){if(1&n&&e._UZ(0,"app-string-argument",12),2&n){const t=e.oxw().index,i=e.oxw();e.Q6J("name",i.name)("type",i.type.elementType)("index",t)("dimensions",i.ownDimensions)("formControlName",t)}}function nt(n,o){if(1&n&&e._UZ(0,"app-time-argument",12),2&n){const t=e.oxw().index,i=e.oxw();e.Q6J("name",i.name)("type",i.type.elementType)("index",t)("dimensions",i.ownDimensions)("formControlName",t)}}function it(n,o){if(1&n&&e._UZ(0,"app-array-argument",11),2&n){const t=e.oxw().index,i=e.oxw();e.Q6J("name",t)("type",i.type.elementType)("index",t)("dimensions",i.ownDimensions)("initialValue",i.entryInitialValues[t])}}function at(n,o){if(1&n&&(e.ynx(0)(1,8),e.YNc(2,Ge,1,5,"app-aggregate-argument",9),e.YNc(3,We,1,5,"app-binary-argument",10),e.YNc(4,Xe,1,5,"app-boolean-argument",10),e.YNc(5,ze,1,5,"app-enumeration-argument",10),e.YNc(6,Ke,1,5,"app-float-argument",10),e.YNc(7,et,1,5,"app-integer-argument",10),e.YNc(8,tt,1,5,"app-string-argument",10),e.YNc(9,nt,1,5,"app-time-argument",10),e.YNc(10,it,1,5,"app-array-argument",9),e.BQk(),e._UZ(11,"br"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngSwitch",t.type.elementType.engType),e.xp6(1),e.Q6J("ngSwitchCase","aggregate"),e.xp6(1),e.Q6J("ngSwitchCase","binary"),e.xp6(1),e.Q6J("ngSwitchCase","boolean"),e.xp6(1),e.Q6J("ngSwitchCase","enumeration"),e.xp6(1),e.Q6J("ngSwitchCase","float"),e.xp6(1),e.Q6J("ngSwitchCase","integer"),e.xp6(1),e.Q6J("ngSwitchCase","string"),e.xp6(1),e.Q6J("ngSwitchCase","time"),e.xp6(1),e.Q6J("ngSwitchCase",t.type.elementType.engType.endsWith("[]")?t.type.elementType.engType:"")}}let R=(()=>{class n{constructor(t,i,a){this.formGroupName=t,this.yamcs=i,this.formArrayName=a,this.ownDimensions=[],this.engType$=new C.X(null),this.arrayLength$=new C.X(0),this.formArray=new l.vC([]),this.entryInitialValues=[],this.subscriptions=[],this.pvalCache={},this.topLevelForm.valueChanges.subscribe(()=>{this.updateOwnDimensions(),this.formArray.updateValueAndValidity({onlySelf:!0})}),this.topLevelForm.statusChanges.subscribe(()=>{this.updateOwnDimensions(),this.formArray.updateValueAndValidity({onlySelf:!0})})}get topLevelForm(){return this.formGroupName.formDirective}ngOnInit(){this.formGroupName.control.addControl(this.name,this.formArray),this.updateOwnDimensions();let i=this.type.dimensions.filter(c=>void 0!==c.parameter).map(c=>c.parameter.qualifiedName);if(i=[...new Set(i)],i.length){const c=i.map(m=>({name:m}));let s;this.parameterSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:c,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!1,action:"REPLACE"},m=>{m.mapping&&(s={...s,...m.mapping});for(const d of m.values||[])d.engValue&&(this.pvalCache[s[d.numericId].name]=r.P6.convertValue(d.engValue),this.updateOwnDimensions())})}this.formArray.addValidators(()=>{for(let c=0;c<this.ownDimensions.length;c++){const s=this.ownDimensions[c],m=this.type.dimensions[c];if(void 0!==s&&s<0)return{invalidDimension:{dimension:s}};if(m.argument){if(void 0===s)return{argumentRequired:{name:m.argument}}}else if(m.parameter&&void 0===s)return{parameterRequired:{qualifiedName:m.parameter.qualifiedName,name:m.parameter.name}}}return null}),this.formArray.updateValueAndValidity(),this.initialValue?.length===this.arrayLength$.value&&(this.entryInitialValues=[...this.initialValue]);let a=!0;this.subscriptions.push(this.arrayLength$.pipe((0,Ve.x)()).subscribe(c=>{this.formArray.clear();for(let s=0;s<c;s++)this.type.elementType.engType.endsWith("[]")||"aggregate"===this.type.elementType.engType?this.formArray.setControl(s,"aggregate"===this.type.elementType.engType?new l.nJ({}):new l.vC([])):this.formArray.setControl(s,new l.NI(a?this.entryInitialValues[s]??"":""))})),a=!1}get label(){return void 0!==this.index?r.P6.unflattenIndex(this.index,this.dimensions).map(i=>"["+i+"]").join(""):this.name}updateEngType(){let t=this.type.elementType.engType;t.endsWith("[]")&&(t="array");for(const i of this.ownDimensions)t+=void 0!==i?`[${i}]`:"[?]";this.engType$.next(t)}updateOwnDimensions(){const{dimensions:t}=this.type;if(t){let i=[];for(const c of t)if(void 0!==c.fixedValue)i.push(Number(c.fixedValue));else if(c.argument){const s=this.findClosestControl(c.argument);if(s?.valid&&""!==s.value){const m=Number(s.value);if(isNaN(m))i.push(void 0);else{let d=m*Number(c.slope);d+=Number(c.intercept),i.push(d)}}else i.push(void 0)}else if(c.parameter){const s=this.pvalCache[c.parameter.qualifiedName];if(void 0!==s){const m=Number(s);if(isNaN(m))i.push(void 0);else{let d=m*Number(c.slope);d+=Number(c.intercept),i.push(d)}}else i.push(void 0)}else i.push(void 0);this.ownDimensions=i,this.updateEngType();let a=1;for(const c of this.ownDimensions){if(void 0===c){a=0;break}a*=c}this.arrayLength$.next(a)}}findClosestControl(t){let i=this.formGroupName.control;for(;i&&i!==this.topLevelForm.control;){if(i instanceof l.cw&&t in i.controls)return i.controls[t];i=i.parent}}ngOnDestroy(){this.parameterSubscription?.cancel(),this.subscriptions.forEach(t=>t.unsubscribe())}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(l.x0),e.Y36(r.C8),e.Y36(l.CE,8))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-array-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions",initialValue:"initialValue"},features:[e._Bn([],[{provide:l.gN,useFactory:(t,i)=>t||i,deps:[[new e.tp0,new e.FiY,l.CE],l.x0]}])],decls:12,vars:12,consts:[[1,"label"],[4,"ngIf"],[3,"controlName"],["err",""],[1,"meta"],[1,"item"],[1,"entries",3,"formArrayName"],[4,"ngFor","ngForOf"],[3,"ngSwitch"],[3,"name","type","index","dimensions","initialValue",4,"ngSwitchCase"],[3,"name","type","index","dimensions","formControlName",4,"ngSwitchCase"],[3,"name","type","index","dimensions","initialValue"],[3,"name","type","index","dimensions","formControlName"]],template:function(i,a){if(1&i&&(e.TgZ(0,"div",0),e._uU(1),e.YNc(2,je,2,1,"ya-help",1),e._UZ(3,"ya-errors",2,3),e.TgZ(5,"div",4),e.ALo(6,"async"),e.TgZ(7,"div",5),e._uU(8),e.ALo(9,"async"),e.qZA()(),e.TgZ(10,"div",6),e.YNc(11,at,12,10,"ng-container",7),e.qZA()()),2&i){const c=e.MAs(4);e.xp6(1),e.hij(" ",a.label," "),e.xp6(1),e.Q6J("ngIf",a.description),e.xp6(1),e.Q6J("controlName",a.name),e.xp6(2),e.ekj("error",e.lcZ(6,8,c.invalid$)),e.xp6(3),e.Oqu(e.lcZ(9,10,a.engType$)),e.xp6(2),e.Q6J("formArrayName",a.name),e.xp6(1),e.Q6J("ngForOf",a.formArray.controls)}},styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#5787b1;color:#fff;cursor:pointer}",".label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}return n})();function ot(n,o){if(1&n&&(e.TgZ(0,"div",3),e._uU(1," bytes: "),e._UZ(2,"ya-interval",8),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("left",t.type.minBytes)("right",t.type.maxBytes)("singleValueIfEqual",!0)}}function ct(n,o){if(1&n&&(e.TgZ(0,"ya-help"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.description," ")}}let X=(()=>{class n{constructor(){this.formControl=new l.p4,this.validators=[],this.onChange=t=>{},this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.formControl.valueChanges.subscribe(()=>{this.onChange(this.formControl.value)})),this.controlName=void 0===this.index?this.name:String(this.index),0!==this.type.minBytes&&this.validators.push(l.kI.required),this.validators.push(r.z2.requireHex),void 0!==this.type.minBytes&&this.validators.push(r.z2.minHexLengthValidator(this.type.minBytes)),void 0!==this.type.maxBytes&&this.validators.push(r.z2.maxHexLengthValidator(this.type.maxBytes))}get label(){return void 0!==this.index?r.P6.unflattenIndex(this.index,this.dimensions).map(i=>"["+i+"]").join(""):this.name}writeValue(t){this.formControl.setValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){}validate(t){for(const i of this.validators){const a=i(t);if(a)return a}return null}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-binary-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},features:[e._Bn([{provide:l.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0},{provide:l.Cf,useExisting:(0,e.Gpc)(()=>n),multi:!0}])],decls:12,vars:14,consts:[[1,"label"],[1,"meta"],["class","item",4,"ngIf"],[1,"item"],[4,"ngIf"],[3,"controlName"],["err",""],[3,"formControl"],[3,"left","right","singleValueIfEqual"]],template:function(i,a){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.ALo(2,"async"),e.YNc(3,ot,3,3,"div",2),e.TgZ(4,"div",3),e.ALo(5,"async"),e._uU(6),e.qZA()(),e._uU(7),e.YNc(8,ct,2,1,"ya-help",4),e._UZ(9,"ya-errors",5,6)(11,"ya-binary-input",7),e.qZA()),2&i){const c=e.MAs(10);e.xp6(1),e.ekj("error",e.lcZ(2,10,c.invalid$)),e.xp6(2),e.Q6J("ngIf",void 0!==a.type.minBytes||void 0!==a.type.maxBytes),e.xp6(1),e.ekj("error",e.lcZ(5,12,c.invalid$)),e.xp6(2),e.Oqu(a.type.engType),e.xp6(1),e.hij(" ",a.label," "),e.xp6(1),e.Q6J("ngIf",a.description),e.xp6(1),e.Q6J("controlName",a.controlName),e.xp6(2),e.Q6J("formControl",a.formControl)}},dependencies:[u.O5,l.JJ,l.oH,r.ar,r.uZ,r.IR,r.TM,u.Ov],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#5787b1;color:#fff;cursor:pointer}",".ng-invalid[_nghost-%COMP%]:not(.ng-pristine)     input{border-color:#dc143c!important}.label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}return n})();function st(n,o){if(1&n&&(e.TgZ(0,"div",3),e._UZ(1,"ya-interval",10),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("left",t.type.rangeMin)("right",t.type.rangeMax)}}function rt(n,o){if(1&n&&(e.TgZ(0,"div",3),e._uU(1),e.ALo(2,"units"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,t.type.unitSet)," ")}}function lt(n,o){1&n&&(e.TgZ(0,"div",3),e._uU(1,"unsigned"),e.qZA())}function mt(n,o){if(1&n&&(e.TgZ(0,"ya-help"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.description," ")}}let z=(()=>{class n{constructor(){this.validators=[],this.onChange=t=>{},this.subscriptions=[],this.formGroup=new l.cw({enabled:new l.NI(null)})}ngOnInit(){this.subscriptions.push(this.formGroup.valueChanges.subscribe(()=>{let t=this.formGroup.get("enabled").value;this.onChange(t)})),this.controlName=void 0===this.index?this.name:String(this.index),this.validators.push(l.kI.required)}get label(){return void 0!==this.index?r.P6.unflattenIndex(this.index,this.dimensions).map(i=>"["+i+"]").join(""):this.name}writeValue(t){"true"===t?this.formGroup.setValue({enabled:"true"}):"false"===t&&this.formGroup.setValue({enabled:"false"})}registerOnChange(t){this.onChange=t}registerOnTouched(t){}validate(t){for(const i of this.validators){const a=i(t);if(a)return a}return null}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-boolean-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},features:[e._Bn([{provide:l.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0},{provide:l.Cf,useExisting:(0,e.Gpc)(()=>n),multi:!0}])],decls:18,vars:14,consts:[[1,"label"],[1,"meta"],["class","item",4,"ngIf"],[1,"item"],[4,"ngIf"],[3,"controlName"],["err",""],[3,"formGroup"],["type","radio","formControlName","enabled","value","true"],["type","radio","formControlName","enabled","value","false"],[3,"left","right"]],template:function(i,a){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.ALo(2,"async"),e.YNc(3,st,2,2,"div",2),e.YNc(4,rt,3,3,"div",2),e.YNc(5,lt,2,0,"div",2),e.TgZ(6,"div",3),e._uU(7),e.qZA()(),e._uU(8),e.YNc(9,mt,2,1,"ya-help",4),e._UZ(10,"ya-errors",5,6)(12,"br"),e.ynx(13,7),e._UZ(14,"input",8),e._uU(15),e._UZ(16,"input",9),e._uU(17),e.BQk(),e.qZA()),2&i){const c=e.MAs(11);e.xp6(1),e.ekj("error",e.lcZ(2,12,c.invalid$)),e.xp6(2),e.Q6J("ngIf",void 0!==a.type.rangeMin||void 0!==a.type.rangeMax),e.xp6(1),e.Q6J("ngIf",a.type.unitSet),e.xp6(1),e.Q6J("ngIf",!1===a.type.signed),e.xp6(2),e.Oqu(a.type.engType),e.xp6(1),e.hij(" ",a.label," "),e.xp6(1),e.Q6J("ngIf",a.description),e.xp6(1),e.Q6J("controlName",a.controlName),e.xp6(3),e.Q6J("formGroup",a.formGroup),e.xp6(2),e.hij(" ",a.type.oneStringValue," "),e.xp6(2),e.hij(" ",a.type.zeroStringValue," ")}},dependencies:[u.O5,l.Fj,l._,l.JJ,l.JL,l.sg,l.u,r.uZ,r.IR,r.TM,u.Ov,r.HQ],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#5787b1;color:#fff;cursor:pointer}",".ng-invalid[_nghost-%COMP%]:not(.ng-pristine)     input{border-color:#dc143c!important}.label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}return n})();var E=g(8337),x=g(7700),M=g(9887),p=g(9538),v=g(4643),I=g(1274);function ut(n,o){1&n&&(e.TgZ(0,"th",17),e._uU(1,"Value"),e.qZA())}function dt(n,o){if(1&n&&(e.TgZ(0,"td",18),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.value," ")}}function pt(n,o){1&n&&(e.TgZ(0,"th",17),e._uU(1,"Label"),e.qZA())}function _t(n,o){if(1&n&&(e.TgZ(0,"td",18)(1,"strong"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.label)}}function gt(n,o){1&n&&(e.TgZ(0,"th",17),e._uU(1,"Hex value"),e.qZA())}function ft(n,o){if(1&n&&(e.TgZ(0,"td",18),e._uU(1),e.qZA()),2&n){const t=o.$implicit,i=e.oxw();e.xp6(1),e.hij(" ",i.toHex(t.value)," ")}}function ht(n,o){1&n&&e._UZ(0,"tr",19)}function xt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr",20),e.NdJ("click",function(){const c=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.selection.toggle(c))}),e.qZA()}if(2&n){const t=o.$implicit,i=e.oxw();e.ekj("selected",i.selection.isSelected(t))}}let yt=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i,this.filterControl=new l.p4,this.dataSource=new p.by([]),this.selection=new E.Ov,this.displayedColumns=["name","value"];const a=i.type,c="UNSIGNED"===a.dataEncoding?.encoding;this.dataSource.filterPredicate=(s,m)=>{const{label:d,value:_}=s;return d.toLowerCase().indexOf(m)>=0||String(_).indexOf(m)>=0||c&&Number(_).toString(16).indexOf(m)>=0},this.dataSource.data=a.enumValue||[],c&&this.displayedColumns.push("hex")}ngAfterViewInit(){this.filterControl.valueChanges.subscribe(()=>{this.dataSource.filter=(this.filterControl.value||"").toLowerCase()}),this.dataSource.paginator=this.paginator}selectNext(){const t=this.dataSource.filteredData;let i=0;if(this.selection.hasValue()){const a=this.selection.selected[0];-1!==t.indexOf(a)&&(i=Math.min(t.indexOf(a)+1,t.length-1))}this.selection.select(t[i])}selectPrevious(){const t=this.dataSource.filteredData;let i=0;if(this.selection.hasValue()){const a=this.selection.selected[0];-1!==t.indexOf(a)&&(i=Math.max(t.indexOf(a)-1,0))}this.selection.select(t[i])}toHex(t){return Number(t).toString(16)}applySelection(){const t=this.selection.selected;t.length&&this.dialogRef.close(t[0])}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x.so),e.Y36(x.WI))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-select-enumeration-dialog"]],viewQuery:function(i,a){if(1&i&&e.Gf(M.NW,7),2&i){let c;e.iGM(c=e.CRH())&&(a.paginator=c.first)}},decls:25,vars:8,consts:[[2,"background-color","#fff"],[1,"filter-bar"],["width","100%",3,"formControl","onArrowDown","onArrowUp","onEnter"],[1,"scrollpane"],["mat-table","",1,"ya-data-table",2,"width","100%",3,"dataSource"],["cdkColumnDef","value"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","name"],["cdkColumnDef","hex"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["align","end"],[3,"pageSize","hidePageSize","showFirstLastButtons"],[2,"flex","1 1 auto"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click"]],template:function(i,a){1&i&&(e.TgZ(0,"mat-toolbar",0),e._uU(1," Select enumeration state\n"),e.qZA(),e.TgZ(2,"mat-dialog-content")(3,"div",1)(4,"ya-search-filter",2),e.NdJ("onArrowDown",function(){return a.selectNext()})("onArrowUp",function(){return a.selectPrevious()})("onEnter",function(){return a.applySelection()}),e.qZA()(),e.TgZ(5,"div",3)(6,"table",4),e.ynx(7,5),e.YNc(8,ut,2,0,"th",6),e.YNc(9,dt,2,1,"td",7),e.BQk(),e.ynx(10,8),e.YNc(11,pt,2,0,"th",6),e.YNc(12,_t,3,1,"td",7),e.BQk(),e.ynx(13,9),e.YNc(14,gt,2,0,"th",6),e.YNc(15,ft,2,1,"td",7),e.BQk(),e.YNc(16,ht,1,0,"tr",10),e.YNc(17,xt,1,2,"tr",11),e.qZA()()(),e.TgZ(18,"mat-dialog-actions",12),e._UZ(19,"mat-paginator",13)(20,"div",14),e.TgZ(21,"button",15),e._uU(22,"CANCEL"),e.qZA(),e.TgZ(23,"button",16),e.NdJ("click",function(){return a.applySelection()}),e._uU(24," SELECT "),e.qZA()()),2&i&&(e.xp6(4),e.Q6J("formControl",a.filterControl),e.xp6(2),e.Q6J("dataSource",a.dataSource),e.xp6(10),e.Q6J("cdkHeaderRowDef",a.displayedColumns),e.xp6(1),e.Q6J("cdkRowDefColumns",a.displayedColumns),e.xp6(2),e.Q6J("pageSize",100)("hidePageSize",!0)("showFirstLastButtons",!0),e.xp6(4),e.Q6J("disabled",a.selection.isEmpty()))},dependencies:[l.JJ,l.oH,v.Sq,v.O_,v.D5,v.fo,v.s$,x.ZT,x.xY,x.H8,M.NW,p.BZ,p.ge,p.ev,p.XQ,p.Gk,I.Ye,r.cF],styles:["td[_ngcontent-%COMP%]{cursor:pointer}.scrollpane[_ngcontent-%COMP%]{overflow:auto;height:200px}.mat-mdc-dialog-actions[_ngcontent-%COMP%]{padding:24px}.filter-bar[_ngcontent-%COMP%]{display:block;padding:24px}"],changeDetection:0})}return n})();var S=g(617),U=g(2596);function Tt(n,o){if(1&n&&(e.TgZ(0,"ya-help"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.description," ")}}let K=(()=>{class n{constructor(t){this.dialog=t,this.formControl=new l.p4,this.selectOptions$=new C.X([]),this.validators=[],this.onChange=i=>{},this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.formControl.valueChanges.subscribe(()=>{this.onChange(this.formControl.value)})),this.controlName=void 0===this.index?this.name:String(this.index);const t=[];for(const i of this.type.enumValue||[])t.push({id:i.label,label:i.label});this.selectOptions$.next(t),this.validators.push(l.kI.required)}get label(){return void 0!==this.index?r.P6.unflattenIndex(this.index,this.dimensions).map(i=>"["+i+"]").join(""):this.name}writeValue(t){this.formControl.setValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){}openSelectEnumerationDialog(){this.dialog.open(yt,{width:"600px",data:{type:this.type},panelClass:["no-padding-dialog"]}).afterClosed().subscribe(t=>{t&&this.writeValue(t.label)})}validate(t){for(const i of this.validators){const a=i(t);if(a)return a}return null}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x.uw))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-enumeration-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},features:[e._Bn([{provide:l.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0},{provide:l.Cf,useExisting:(0,e.Gpc)(()=>n),multi:!0}])],decls:16,vars:12,consts:[[1,"label"],[1,"meta"],[1,"item"],[4,"ngIf"],[3,"controlName"],["err",""],[1,"control-group"],[3,"formControl","options"],["matTooltip","Lookup enumeration state",1,"ya-button",3,"click"]],template:function(i,a){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.ALo(2,"async"),e.TgZ(3,"div",2),e._uU(4),e.qZA()(),e._uU(5),e.YNc(6,Tt,2,1,"ya-help",3),e._UZ(7,"ya-errors",4,5),e.TgZ(9,"div",6),e._UZ(10,"ya-select",7),e.ALo(11,"async"),e._uU(12,"\xa0 "),e.TgZ(13,"button",8),e.NdJ("click",function(){return a.openSelectEnumerationDialog()}),e.TgZ(14,"mat-icon"),e._uU(15,"search"),e.qZA()()()()),2&i){const c=e.MAs(8);e.xp6(1),e.ekj("error",e.lcZ(2,8,c.invalid$)),e.xp6(3),e.Oqu(a.type.engType),e.xp6(1),e.hij(" ",a.label," "),e.xp6(1),e.Q6J("ngIf",a.description),e.xp6(1),e.Q6J("controlName",a.controlName),e.xp6(3),e.Q6J("formControl",a.formControl)("options",e.lcZ(11,10,a.selectOptions$))}},dependencies:[u.O5,l.JJ,l.oH,S.Hw,U.gM,r.uZ,r.IR,r.Hr,u.Ov],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#5787b1;color:#fff;cursor:pointer}",".label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}return n})();function Ct(n,o){if(1&n&&(e.TgZ(0,"div",3),e._UZ(1,"ya-interval",8),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("left",t.type.rangeMin)("right",t.type.rangeMax)}}function bt(n,o){if(1&n&&(e.TgZ(0,"div",3),e._uU(1),e.ALo(2,"units"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,t.type.unitSet)," ")}}function Zt(n,o){1&n&&(e.TgZ(0,"div",3),e._uU(1,"unsigned"),e.qZA())}function vt(n,o){if(1&n&&(e.TgZ(0,"ya-help"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.description," ")}}let ee=(()=>{class n{constructor(){this.formControl=new l.p4,this.validators=[],this.onChange=t=>{},this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.formControl.valueChanges.subscribe(()=>{this.onChange(this.formControl.value)})),this.controlName=void 0===this.index?this.name:String(this.index),this.validators.push(l.kI.required),this.validators.push(r.z2.requireFloat),!1===this.type.signed&&this.validators.push(r.z2.requireUnsigned),void 0!==this.type.rangeMax&&this.validators.push(l.kI.max(this.type.rangeMax)),void 0!==this.type.rangeMin&&this.validators.push(l.kI.min(this.type.rangeMin))}get label(){return void 0!==this.index?r.P6.unflattenIndex(this.index,this.dimensions).map(i=>"["+i+"]").join(""):this.name}writeValue(t){this.formControl.setValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){}validate(t){for(const i of this.validators){const a=i(t);if(a)return a}return null}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-float-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},features:[e._Bn([{provide:l.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0},{provide:l.Cf,useExisting:(0,e.Gpc)(()=>n),multi:!0}])],decls:13,vars:12,consts:[[1,"label"],[1,"meta"],["class","item",4,"ngIf"],[1,"item"],[4,"ngIf"],[3,"controlName"],["err",""],["type","text","autocomplete","off",3,"formControl"],[3,"left","right"]],template:function(i,a){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.ALo(2,"async"),e.YNc(3,Ct,2,2,"div",2),e.YNc(4,bt,3,3,"div",2),e.YNc(5,Zt,2,0,"div",2),e.TgZ(6,"div",3),e._uU(7),e.qZA()(),e._uU(8),e.YNc(9,vt,2,1,"ya-help",4),e._UZ(10,"ya-errors",5,6)(12,"input",7),e.qZA()),2&i){const c=e.MAs(11);e.xp6(1),e.ekj("error",e.lcZ(2,10,c.invalid$)),e.xp6(2),e.Q6J("ngIf",void 0!==a.type.rangeMin||void 0!==a.type.rangeMax),e.xp6(1),e.Q6J("ngIf",a.type.unitSet),e.xp6(1),e.Q6J("ngIf",!1===a.type.signed),e.xp6(2),e.Oqu(a.type.engType),e.xp6(1),e.hij(" ",a.label," "),e.xp6(1),e.Q6J("ngIf",a.description),e.xp6(1),e.Q6J("controlName",a.controlName),e.xp6(2),e.Q6J("formControl",a.formControl)}},dependencies:[u.O5,l.Fj,l.JJ,l.oH,r.uZ,r.IR,r.TM,u.Ov,r.HQ],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#5787b1;color:#fff;cursor:pointer}",".ng-invalid[_nghost-%COMP%]:not(.ng-pristine)     input{border-color:#dc143c!important}.label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}return n})();var w=g(7988);function At(n,o){if(1&n&&(e.TgZ(0,"div",3),e._UZ(1,"ya-interval",13),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("left",t.type.rangeMin)("right",t.type.rangeMax)}}function kt(n,o){if(1&n&&(e.TgZ(0,"div",3),e._uU(1),e.ALo(2,"units"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,t.type.unitSet)," ")}}function wt(n,o){1&n&&(e.TgZ(0,"div",3),e._uU(1,"unsigned"),e.qZA())}function St(n,o){if(1&n&&(e.TgZ(0,"div",14),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(1,"\u2630"),e.qZA()),2&n){e.oxw();const t=e.MAs(9);e.Q6J("matMenuTriggerFor",t)}}function Nt(n,o){if(1&n&&(e.TgZ(0,"ya-help"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.description," ")}}function Pt(n,o){if(1&n&&e._UZ(0,"input",15),2&n){const t=e.oxw();e.Q6J("formControl",t.formControl)}}function Ut(n,o){if(1&n&&e._UZ(0,"ya-hex-integer-input",16),2&n){const t=e.oxw();e.Q6J("formControl",t.formControl)}}let te=(()=>{class n{constructor(){this.formControl=new l.p4,this.validators=[],this.onChange=t=>{},this.subscriptions=[],this.hexToggle$=new C.X(!1)}ngOnInit(){this.subscriptions.push(this.formControl.valueChanges.subscribe(()=>{let t=this.formControl.value;null!==t&&this.hexToggle$.value&&(t=String(t)),this.onChange(t)})),this.controlName=void 0===this.index?this.name:String(this.index),this.validators.push(l.kI.required),this.validators.push(r.z2.requireInteger),!1===this.type.signed&&this.validators.push(r.z2.requireUnsigned),void 0!==this.type.rangeMax&&this.validators.push(l.kI.max(this.type.rangeMax)),void 0!==this.type.rangeMin&&this.validators.push(l.kI.min(this.type.rangeMin))}get label(){return void 0!==this.index?r.P6.unflattenIndex(this.index,this.dimensions).map(i=>"["+i+"]").join(""):this.name}writeValue(t){this.formControl.setValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){}setDisabledState(t){}validate(t){for(const i of this.validators){const a=i(t);if(a)return a}return null}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-integer-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},features:[e._Bn([{provide:l.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0},{provide:l.Cf,useExisting:(0,e.Gpc)(()=>n),multi:!0}])],decls:29,vars:26,consts:[[1,"label"],[1,"meta"],["class","item",4,"ngIf"],[1,"item"],[1,"ya-menu"],["argMenu","matMenu"],["mat-menu-item","",3,"click"],["class","item menu","matTooltip","Input options",3,"matMenuTriggerFor","click",4,"ngIf"],[4,"ngIf"],[3,"controlName"],["err",""],["type","text","autocomplete","off",3,"formControl",4,"ngIf"],[3,"formControl",4,"ngIf"],[3,"left","right"],["matTooltip","Input options",1,"item","menu",3,"matMenuTriggerFor","click"],["type","text","autocomplete","off",3,"formControl"],[3,"formControl"]],template:function(i,a){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.ALo(2,"async"),e.YNc(3,At,2,2,"div",2),e.YNc(4,kt,3,3,"div",2),e.YNc(5,wt,2,0,"div",2),e.TgZ(6,"div",3),e._uU(7),e.qZA(),e.TgZ(8,"mat-menu",4,5)(10,"button",6),e.NdJ("click",function(){return a.hexToggle$.next(!0)}),e.TgZ(11,"mat-icon"),e.ALo(12,"async"),e._uU(13,"check"),e.qZA(),e._uU(14," Hex input "),e.qZA(),e.TgZ(15,"button",6),e.NdJ("click",function(){return a.hexToggle$.next(!1)}),e.TgZ(16,"mat-icon"),e.ALo(17,"async"),e._uU(18,"check"),e.qZA(),e._uU(19," Decimal input "),e.qZA()(),e.YNc(20,St,2,1,"div",7),e.qZA(),e._uU(21),e.YNc(22,Nt,2,1,"ya-help",8),e._UZ(23,"ya-errors",9,10),e.YNc(25,Pt,1,1,"input",11),e.ALo(26,"async"),e.YNc(27,Ut,1,1,"ya-hex-integer-input",12),e.ALo(28,"async"),e.qZA()),2&i){const c=e.MAs(24);e.xp6(1),e.ekj("error",e.lcZ(2,16,c.invalid$)),e.xp6(2),e.Q6J("ngIf",void 0!==a.type.rangeMin||void 0!==a.type.rangeMax),e.xp6(1),e.Q6J("ngIf",a.type.unitSet),e.xp6(1),e.Q6J("ngIf",!1===a.type.signed),e.xp6(2),e.Oqu(a.type.engType),e.xp6(4),e.Udp("visibility",e.lcZ(12,18,a.hexToggle$)?"visible":"hidden"),e.xp6(5),e.Udp("visibility",e.lcZ(17,20,a.hexToggle$)?"hidden":"visible"),e.xp6(4),e.Q6J("ngIf",!1===a.type.signed),e.xp6(1),e.hij(" ",a.label," "),e.xp6(1),e.Q6J("ngIf",a.description),e.xp6(1),e.Q6J("controlName",a.controlName),e.xp6(2),e.Q6J("ngIf",!e.lcZ(26,22,a.hexToggle$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(28,24,a.hexToggle$))}},dependencies:[u.O5,l.Fj,l.JJ,l.oH,S.Hw,w.VK,w.OP,w.p6,U.gM,r.uZ,r.IR,r.TM,r.Dr,u.Ov,r.HQ],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#5787b1;color:#fff;cursor:pointer}",".ng-invalid[_nghost-%COMP%]:not(.ng-pristine)     input{border-color:#dc143c!important}.label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}return n})();function Qt(n,o){if(1&n&&(e.TgZ(0,"div",3),e._uU(1," chars: "),e._UZ(2,"ya-interval",8),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("left",t.type.minChars)("right",t.type.maxChars)("singleValueIfEqual",!0)}}function qt(n,o){if(1&n&&(e.TgZ(0,"div",3),e._uU(1),e.ALo(2,"units"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,t.type.unitSet)," ")}}function Ot(n,o){if(1&n&&(e.TgZ(0,"ya-help"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.description," ")}}let ne=(()=>{class n{constructor(){this.formControl=new l.p4,this.validators=[],this.onChange=t=>{},this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.formControl.valueChanges.subscribe(()=>{this.onChange(this.formControl.value)})),this.controlName=void 0===this.index?this.name:String(this.index),void 0!==this.type.minChars&&0!==this.type.minChars&&this.validators.push(l.kI.required),void 0!==this.type.minChars&&this.validators.push(l.kI.minLength(this.type.minChars)),void 0!==this.type.maxChars&&this.validators.push(l.kI.maxLength(this.type.maxChars))}get label(){return void 0!==this.index?r.P6.unflattenIndex(this.index,this.dimensions).map(i=>"["+i+"]").join(""):this.name}writeValue(t){this.formControl.setValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){}validate(t){for(const i of this.validators){const a=i(t);if(a)return a}return null}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-string-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},features:[e._Bn([{provide:l.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0},{provide:l.Cf,useExisting:(0,e.Gpc)(()=>n),multi:!0}])],decls:12,vars:11,consts:[[1,"label"],[1,"meta"],["class","item",4,"ngIf"],[1,"item"],[4,"ngIf"],[3,"controlName"],["err",""],["type","text","autocomplete","off",3,"formControl"],[3,"left","right","singleValueIfEqual"]],template:function(i,a){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.ALo(2,"async"),e.YNc(3,Qt,3,3,"div",2),e.YNc(4,qt,3,3,"div",2),e.TgZ(5,"div",3),e._uU(6),e.qZA()(),e._uU(7),e.YNc(8,Ot,2,1,"ya-help",4),e._UZ(9,"ya-errors",5,6)(11,"input",7),e.qZA()),2&i){const c=e.MAs(10);e.xp6(1),e.ekj("error",e.lcZ(2,9,c.invalid$)),e.xp6(2),e.Q6J("ngIf",void 0!==a.type.minChars||void 0!==a.type.maxChars),e.xp6(1),e.Q6J("ngIf",null==a.type?null:a.type.unitSet),e.xp6(2),e.Oqu(a.type.engType),e.xp6(1),e.hij(" ",a.label," "),e.xp6(1),e.Q6J("ngIf",a.description),e.xp6(1),e.Q6J("controlName",a.controlName),e.xp6(2),e.Q6J("formControl",a.formControl)}},dependencies:[u.O5,l.Fj,l.JJ,l.oH,r.uZ,r.IR,r.TM,u.Ov,r.HQ],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#5787b1;color:#fff;cursor:pointer}",".ng-invalid[_nghost-%COMP%]:not(.ng-pristine)     input{border-color:#dc143c!important}.label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}return n})();function It(n,o){if(1&n&&(e.TgZ(0,"ya-help"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.description," ")}}let ie=(()=>{class n{constructor(){this.formControl=new l.p4,this.validators=[],this.onChange=t=>{},this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.formControl.valueChanges.subscribe(()=>{this.onChange(this.formControl.value)})),this.controlName=void 0===this.index?this.name:String(this.index),this.validators.push(l.kI.required)}get label(){return void 0!==this.index?r.P6.unflattenIndex(this.index,this.dimensions).map(i=>"["+i+"]").join(""):this.name}writeValue(t){this.formControl.setValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){}validate(t){for(const i of this.validators){const a=i(t);if(a)return a}return this.formControl.errors}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-time-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},features:[e._Bn([{provide:l.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0},{provide:l.Cf,useExisting:(0,e.Gpc)(()=>n),multi:!0}])],decls:10,vars:10,consts:[[1,"label"],[1,"meta"],[1,"item"],[4,"ngIf"],[3,"controlName"],["err",""],[3,"formControl","showMillis"]],template:function(i,a){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.ALo(2,"async"),e.TgZ(3,"div",2),e._uU(4),e.qZA()(),e._uU(5),e.YNc(6,It,2,1,"ya-help",3),e._UZ(7,"ya-errors",4,5)(9,"ya-date-time-input",6),e.qZA()),2&i){const c=e.MAs(8);e.xp6(1),e.ekj("error",e.lcZ(2,8,c.invalid$)),e.xp6(3),e.Oqu(a.type.engType),e.xp6(1),e.hij(" ",a.label," "),e.xp6(1),e.Q6J("ngIf",a.description),e.xp6(1),e.Q6J("controlName",a.controlName),e.xp6(2),e.Q6J("formControl",a.formControl)("showMillis",!0)}},dependencies:[u.O5,l.JJ,l.oH,r.t,r.uZ,r.IR,u.Ov],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#5787b1;color:#fff;cursor:pointer}",".ng-invalid[_nghost-%COMP%]:not(.ng-pristine)     input{border-color:#dc143c!important}.label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}return n})();function Jt(n,o){if(1&n&&(e.TgZ(0,"ya-help"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.description," ")}}function Dt(n,o){if(1&n&&e._UZ(0,"app-aggregate-argument",9),2&n){const t=e.oxw(),i=t.$implicit,a=t.index,c=e.oxw();e.Q6J("name",i.name)("type",i.type)("description",i.shortDescription)("initialValue",c.memberInitialValues[a])}}function Mt(n,o){if(1&n&&e._UZ(0,"app-binary-argument",10),2&n){const t=e.oxw().$implicit;e.Q6J("name",t.name)("type",t.type)("description",t.shortDescription)("formControlName",t.name)}}function Yt(n,o){if(1&n&&e._UZ(0,"app-boolean-argument",10),2&n){const t=e.oxw().$implicit;e.Q6J("name",t.name)("type",t.type)("description",t.shortDescription)("formControlName",t.name)}}function Ft(n,o){if(1&n&&e._UZ(0,"app-enumeration-argument",10),2&n){const t=e.oxw().$implicit;e.Q6J("name",t.name)("type",t.type)("description",t.shortDescription)("formControlName",t.name)}}function $t(n,o){if(1&n&&e._UZ(0,"app-float-argument",10),2&n){const t=e.oxw().$implicit;e.Q6J("name",t.name)("type",t.type)("description",t.shortDescription)("formControlName",t.name)}}function Lt(n,o){if(1&n&&e._UZ(0,"app-integer-argument",10),2&n){const t=e.oxw().$implicit;e.Q6J("name",t.name)("type",t.type)("description",t.shortDescription)("formControlName",t.name)}}function Et(n,o){if(1&n&&e._UZ(0,"app-string-argument",10),2&n){const t=e.oxw().$implicit;e.Q6J("name",t.name)("type",t.type)("description",t.shortDescription)("formControlName",t.name)}}function Ht(n,o){if(1&n&&e._UZ(0,"app-time-argument",10),2&n){const t=e.oxw().$implicit;e.Q6J("name",t.name)("type",t.type)("description",t.shortDescription)("formControlName",t.name)}}function Bt(n,o){if(1&n&&e._UZ(0,"app-array-argument",9),2&n){const t=e.oxw(),i=t.$implicit,a=t.index,c=e.oxw();e.Q6J("name",i.name)("type",i.type)("description",i.shortDescription)("initialValue",c.memberInitialValues[a])}}function Rt(n,o){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,Dt,1,4,"app-aggregate-argument",7),e.YNc(2,Mt,1,4,"app-binary-argument",8),e.YNc(3,Yt,1,4,"app-boolean-argument",8),e.YNc(4,Ft,1,4,"app-enumeration-argument",8),e.YNc(5,$t,1,4,"app-float-argument",8),e.YNc(6,Lt,1,4,"app-integer-argument",8),e.YNc(7,Et,1,4,"app-string-argument",8),e.YNc(8,Ht,1,4,"app-time-argument",8),e.YNc(9,Bt,1,4,"app-array-argument",7),e.qZA()),2&n){const t=o.$implicit;e.Udp("padding-top",o.first?0:5,"px"),e.Q6J("ngSwitch",t.type.engType),e.xp6(1),e.Q6J("ngSwitchCase","aggregate"),e.xp6(1),e.Q6J("ngSwitchCase","binary"),e.xp6(1),e.Q6J("ngSwitchCase","boolean"),e.xp6(1),e.Q6J("ngSwitchCase","enumeration"),e.xp6(1),e.Q6J("ngSwitchCase","float"),e.xp6(1),e.Q6J("ngSwitchCase","integer"),e.xp6(1),e.Q6J("ngSwitchCase","string"),e.xp6(1),e.Q6J("ngSwitchCase","time"),e.xp6(1),e.Q6J("ngSwitchCase",t.type.engType.endsWith("[]")?t.type.engType:"")}}let me=(()=>{class n{constructor(t,i){this.formGroupName=t,this.formArrayName=i,this.memberInitialValues=[]}ngOnInit(){const t=this.formGroupName.control;let i;if(void 0===this.index)this.controlName=this.name,i=new l.cw({}),t.setControl(this.name,i);else{this.controlName=String(this.index);const a=Number(this.index);i=t.controls[this.name].at(a)}for(const a of this.type.member){let c;if("aggregate"===a.type.engType)c={},this.initialValue&&this.initialValue.hasOwnProperty(a.name)&&(c=this.initialValue[a.name]);else if(a.type.engType.endsWith("[]"))c=[],this.initialValue&&this.initialValue.hasOwnProperty(a.name)&&(c=this.initialValue[a.name]);else{c=a.initialValue??"",this.initialValue&&this.initialValue.hasOwnProperty(a.name)&&(c=this.initialValue[a.name]);const s=new l.p4(c);i.setControl(a.name,s)}this.memberInitialValues.push(c)}}get label(){return void 0===this.index?this.name:r.P6.unflattenIndex(this.index,this.dimensions).map(i=>"["+i+"]").join("")}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(l.x0),e.Y36(l.CE,8))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-aggregate-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions",initialValue:"initialValue"},features:[e._Bn([],[{provide:l.gN,useFactory:(t,i)=>t||i,deps:[[new e.tp0,new e.FiY,l.CE],l.x0]}])],decls:8,vars:4,consts:[[1,"label"],[1,"meta"],[1,"item"],[4,"ngIf"],[1,"members",3,"formGroupName"],[3,"ngSwitch","paddingTop",4,"ngFor","ngForOf"],[3,"ngSwitch"],[3,"name","type","description","initialValue",4,"ngSwitchCase"],[3,"name","type","description","formControlName",4,"ngSwitchCase"],[3,"name","type","description","initialValue"],[3,"name","type","description","formControlName"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"aggregate"),e.qZA()(),e._uU(4),e.YNc(5,Jt,2,1,"ya-help",3),e.TgZ(6,"div",4),e.YNc(7,Rt,10,12,"div",5),e.qZA()()),2&i&&(e.xp6(4),e.hij(" ",a.label," "),e.xp6(1),e.Q6J("ngIf",a.description),e.xp6(1),e.Q6J("formGroupName",a.controlName),e.xp6(1),e.Q6J("ngForOf",a.type.member))},dependencies:[u.sg,u.O5,u.RF,u.n9,l.JJ,l.JL,l.u,l.x0,r.IR,n,R,X,z,K,ee,te,ne,ie],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#5787b1;color:#fff;cursor:pointer}",".label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}return n})();function Vt(n,o){if(1&n&&e._UZ(0,"app-aggregate-argument",3),2&n){const t=e.oxw();e.Q6J("name",t.name)("description",t.description)("type",t.type)("initialValue",t.parsedInitialValue)}}function jt(n,o){if(1&n&&e._UZ(0,"app-binary-argument",4),2&n){const t=e.oxw();e.Q6J("name",t.name)("description",t.description)("type",t.type)("formControlName",t.name)}}function Gt(n,o){if(1&n&&e._UZ(0,"app-boolean-argument",4),2&n){const t=e.oxw();e.Q6J("name",t.name)("description",t.description)("type",t.type)("formControlName",t.name)}}function Wt(n,o){if(1&n&&e._UZ(0,"app-enumeration-argument",4),2&n){const t=e.oxw();e.Q6J("name",t.name)("description",t.description)("type",t.type)("formControlName",t.name)}}function Xt(n,o){if(1&n&&e._UZ(0,"app-float-argument",4),2&n){const t=e.oxw();e.Q6J("name",t.name)("description",t.description)("type",t.type)("formControlName",t.name)}}function zt(n,o){if(1&n&&e._UZ(0,"app-integer-argument",4),2&n){const t=e.oxw();e.Q6J("name",t.name)("description",t.description)("type",t.type)("formControlName",t.name)}}function Kt(n,o){if(1&n&&e._UZ(0,"app-string-argument",4),2&n){const t=e.oxw();e.Q6J("name",t.name)("description",t.description)("type",t.type)("formControlName",t.name)}}function en(n,o){if(1&n&&e._UZ(0,"app-time-argument",4),2&n){const t=e.oxw();e.Q6J("name",t.name)("description",t.description)("type",t.type)("formControlName",t.name)}}function tn(n,o){if(1&n&&e._UZ(0,"app-array-argument",3),2&n){const t=e.oxw();e.Q6J("name",t.name)("description",t.description)("type",t.type)("initialValue",t.parsedInitialValue)}}function J(n){switch(n.type){case"BOOLEAN":return""+n.booleanValue;case"FLOAT":return""+n.floatValue;case"DOUBLE":return""+n.doubleValue;case"UINT32":return""+n.uint32Value;case"SINT32":return""+n.sint32Value;case"BINARY":return r.P6.convertBase64ToHex(n.binaryValue);case"ENUMERATED":case"STRING":case"TIMESTAMP":return n.stringValue;case"UINT64":return""+n.uint64Value;case"SINT64":return""+n.sint64Value;case"AGGREGATE":const{name:o,value:t}=n.aggregateValue,i={};for(let a=0;a<o.length;a++)i[o[a]]=J(t[a]);return i;case"ARRAY":return n.arrayValue.map(a=>J(a))}}function ae(n){if(Array.isArray(n))return n.map(o=>ae(o));if("object"==typeof n){const o={};for(const t in n)o[t]=ae(n[t]);return o}return""+n}let nn=(()=>{class n{ngOnInit(){if(this.initialValue&&(this.parsedInitialValue="AGGREGATE"===this.type.engType||"ARRAY"===this.type.engType?ae(JSON.parse(this.initialValue)):"BOOLEAN"===this.type.engType?""+(this.initialValue===this.type.oneStringValue):this.initialValue),this.templateProvider){const t=this.templateProvider.getAssignment(this.name);"AGGREGATE"===t?.type?this.parsedInitialValue={...this.parsedInitialValue||{},...J(t)}:"ARRAY"===t?.type&&(this.parsedInitialValue=J(t))}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-argument"]],inputs:{name:"name",description:"description",type:"type",initialValue:"initialValue",templateProvider:"templateProvider"},features:[e._Bn([],[{provide:l.gN,useExisting:l.x0}])],decls:10,vars:10,consts:[[3,"ngSwitch"],[3,"name","description","type","initialValue",4,"ngSwitchCase"],[3,"name","description","type","formControlName",4,"ngSwitchCase"],[3,"name","description","type","initialValue"],[3,"name","description","type","formControlName"]],template:function(i,a){1&i&&(e.ynx(0,0),e.YNc(1,Vt,1,4,"app-aggregate-argument",1),e.YNc(2,jt,1,4,"app-binary-argument",2),e.YNc(3,Gt,1,4,"app-boolean-argument",2),e.YNc(4,Wt,1,4,"app-enumeration-argument",2),e.YNc(5,Xt,1,4,"app-float-argument",2),e.YNc(6,zt,1,4,"app-integer-argument",2),e.YNc(7,Kt,1,4,"app-string-argument",2),e.YNc(8,en,1,4,"app-time-argument",2),e.YNc(9,tn,1,4,"app-array-argument",1),e.BQk()),2&i&&(e.Q6J("ngSwitch",a.type.engType),e.xp6(1),e.Q6J("ngSwitchCase","aggregate"),e.xp6(1),e.Q6J("ngSwitchCase","binary"),e.xp6(1),e.Q6J("ngSwitchCase","boolean"),e.xp6(1),e.Q6J("ngSwitchCase","enumeration"),e.xp6(1),e.Q6J("ngSwitchCase","float"),e.xp6(1),e.Q6J("ngSwitchCase","integer"),e.xp6(1),e.Q6J("ngSwitchCase","string"),e.xp6(1),e.Q6J("ngSwitchCase","time"),e.xp6(1),e.Q6J("ngSwitchCase",a.type.engType.endsWith("[]")?a.type.engType:""))},dependencies:[u.RF,u.n9,l.JJ,l.u,me,R,X,z,K,ee,te,ne,ie],encapsulation:2,changeDetection:0})}return n})();var Y=g(4518);function an(n,o){1&n&&e._UZ(0,"br")}function on(n,o){if(1&n&&(e.ynx(0),e.YNc(1,an,1,0,"br",3),e._UZ(2,"app-argument",6),e.BQk()),2&n){const t=o.$implicit,i=o.first,a=e.oxw();e.xp6(1),e.Q6J("ngIf",!i),e.xp6(1),e.Q6J("name",t.name)("description",t.description)("type",t.type)("initialValue",t.initialValue)("templateProvider",a.templateProvider)}}function cn(n,o){1&n&&e._UZ(0,"br",9)}function sn(n,o){if(1&n&&(e.ynx(0),e.YNc(1,cn,1,0,"br",7),e._UZ(2,"app-argument",8),e.BQk()),2&n){const t=o.$implicit,i=o.first,a=e.oxw();e.xp6(1),e.Q6J("ngIf",!i||a.arguments.length),e.xp6(1),e.Q6J("name",t.name)("description",t.description)("type",t.type)("initialValue",t.initialValue)("templateProvider",a.templateProvider)}}function rn(n,o){1&n&&e._UZ(0,"br")}function ln(n,o){1&n&&(e.ynx(0),e._uU(1,"s"),e.BQk())}function mn(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,rn,1,0,"br",3),e.TgZ(2,"ya-text-action",10),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.showAll$.next(!0))}),e._uU(3),e.YNc(4,ln,2,0,"ng-container",3),e._uU(5," with defaults "),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.arguments.length),e.xp6(2),e.hij(" Show ",t.argumentsWithInitial.length," argument"),e.xp6(1),e.Q6J("ngIf",1!==t.argumentsWithInitial.length)}}function un(n,o){if(1&n&&(e.ynx(0),e.YNc(1,mn,6,3,"ng-container",3),e.ALo(2,"async"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.argumentsWithInitial.length&&!e.lcZ(2,1,t.showAll$))}}function dn(n,o){if(1&n&&(e.TgZ(0,"ya-help",18),e._UZ(1,"div",19),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.Q6J("dialogTitle",t.verboseName||t.id),e.xp6(1),e.Q6J("innerHTML",t.help,e.oJD)}}function pn(n,o){if(1&n&&(e.TgZ(0,"div",14),e._uU(1),e.YNc(2,dn,2,2,"ya-help",15),e._UZ(3,"br")(4,"input",16),e._uU(5," true "),e._UZ(6,"input",17),e._uU(7," false "),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.verboseName||t.id," "),e.xp6(1),e.Q6J("ngIf",t.help),e.xp6(2),e.Q6J("formControlName","extra__"+t.id),e.xp6(2),e.Q6J("formControlName","extra__"+t.id)}}function _n(n,o){if(1&n&&(e.TgZ(0,"ya-help",18),e._UZ(1,"div",19),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.Q6J("dialogTitle",t.verboseName||t.id),e.xp6(1),e.Q6J("innerHTML",t.help,e.oJD)}}function gn(n,o){if(1&n&&(e.TgZ(0,"div",14),e._uU(1),e.YNc(2,_n,2,2,"ya-help",15),e._UZ(3,"input",20),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.verboseName||t.id," "),e.xp6(1),e.Q6J("ngIf",t.help),e.xp6(1),e.Q6J("formControlName","extra__"+t.id)}}function fn(n,o){if(1&n&&(e.ynx(0)(1,11),e.YNc(2,pn,8,4,"div",12),e.YNc(3,gn,4,3,"div",13),e.BQk(),e._UZ(4,"br"),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngSwitch",t.type),e.xp6(1),e.Q6J("ngSwitchCase","BOOLEAN")}}function hn(n,o){if(1&n&&(e.ynx(0),e.YNc(1,fn,5,2,"ng-container",2),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.commandOptions)}}let oe=(()=>{class n{constructor(t,i,a){this.arguments=[],this.argumentsWithInitial=[],this.showAll$=new C.X(!1),this.hasArguments$=new C.X(!1),this.form=a.group({args:a.group({})}),this.user=i.getUser(),this.commandOptions=t.getCommandOptions(),this.form.addControl("comment",new l.NI(""));for(const c of this.commandOptions)this.form.addControl("extra__"+c.id,new l.p4(""));this.config=t.getConfig(),this.showAll$.next(!this.config.collapseInitializedArguments)}get argsGroup(){return this.form.get("args")}ngOnChanges(){this.arguments=[],this.argumentsWithInitial=[],this.showAll$.next(!this.config.collapseInitializedArguments);for(const s in this.argsGroup.controls)this.argsGroup.removeControl(s);this.form.reset();const t=this.templateProvider?.getComment()||"";if(this.form.controls.comment.setValue(t),!this.command)return;if(this.templateProvider&&this.showCommandOptions())for(const s of this.config.commandOptions||[]){const m=this.templateProvider.getOption(s.id,s.type);void 0!==m&&this.form.controls["extra__"+s.id].setValue(J(m))}const i=[];let a=this.command;for(;a;)i.unshift(a),a=a.baseCommand;const c=new Map;for(const s of i){if(s.argument)for(const m of s.argument){if(this.templateProvider){const _=this.templateProvider.getAssignment(m.name);if(void 0!==_){const y=J(_);let f=m.initialValue;"boolean"===m.type.engType&&void 0!==f&&(f=""+(m.type.oneStringValue===f)),y===f?this.argumentsWithInitial.push(m):this.arguments.push(m);continue}}let d=void 0!==m.initialValue;if(d&&"aggregate"===m.type.engType){const _=JSON.parse(m.initialValue);d=this.isAggregateFullyInitialized(m,_)}d?this.argumentsWithInitial.push(m):this.arguments.push(m)}if(s.argumentAssignment)for(const m of s.argumentAssignment)c.set(m.name,m.value)}this.arguments=this.arguments.filter(s=>!c.has(s.name)),this.argumentsWithInitial=this.argumentsWithInitial.filter(s=>!c.has(s.name));for(const s of this.arguments)this.addControl(s,this.templateProvider);for(const s of this.argumentsWithInitial)this.addControl(s,this.templateProvider);this.hasArguments$.next(this.arguments.length>0||this.argumentsWithInitial.length>0)}getAssignments(){const t={};for(const i of[...this.arguments,...this.argumentsWithInitial])if("aggregate"===i.type.engType){const a=this.argsGroup.get(i.name);t[i.name]=this.getMemberAssignments(a,i.type)}else if(i.type.engType.endsWith("[]")){const a=this.argsGroup.get(i.name);t[i.name]=this.getArrayAssignment(a,i.type.elementType)}else{const a=this.argsGroup.controls[i.name];(!this.isArgumentWithInitialValue(i.name)||a.dirty)&&(t[i.name]="boolean"===i.type.engType?"true"===this.argsGroup.value[i.name]:String(this.argsGroup.value[i.name]))}return t}getMemberAssignments(t,i){const a={};for(const c of i.member||[])if("aggregate"===c.type.engType){const s=t.get(c.name);a[c.name]=this.getMemberAssignments(s,c.type)}else if(c.type.engType.endsWith("[]")){const s=t.get(c.name);a[c.name]=this.getArrayAssignment(s,c.type.elementType)}else if("boolean"===c.type.engType){const s=t.get(c.name);a[c.name]="true"===s.value}else{const s=t.get(c.name);a[c.name]=s.value}return a}getArrayAssignment(t,i){let a=[];for(const c of t.controls)"aggregate"===i.engType?a.push(this.getMemberAssignments(c,i)):i.engType.endsWith("[]")?a.push(this.getArrayAssignment(c,i)):a.push("boolean"===i.engType?"true"===c.value:c.value);return a}getComment(){return this.form.value.comment||void 0}getExtraOptions(){const t={};for(const i in this.form.controls)if(i.startsWith("extra__")){const a=this.form.controls[i];if(null!==a.value){const c=i.replace("extra__","");t[c]=this.toYamcsValue(c,a.value)}}return t}toYamcsValue(t,i){let a;for(const c of this.commandOptions)c.id===t&&(a=c);switch(a.type){case"BOOLEAN":return"true"===i?{type:"BOOLEAN",booleanValue:!0}:{type:"BOOLEAN",booleanValue:!1};case"NUMBER":return{type:"SINT32",sint32Value:Number(i)};default:return{type:"STRING",stringValue:String(i)}}}showCommandOptions(){return this.user.hasSystemPrivilege("CommandOptions")}addControl(t,i){if("aggregate"!==t.type.engType&&!t.type.engType.endsWith("[]")){let a;if(a="boolean"===t.type.engType&&t.initialValue?""+(t.initialValue===t.type.oneStringValue):t.initialValue,i){const c=i.getAssignment(t.name);void 0!==c&&(a=J(c))}void 0===a&&(a=""),this.argsGroup.addControl(t.name,new l.p4(a))}}isArgumentWithInitialValue(t){for(const i of this.argumentsWithInitial)if(i.name===t)return!0;return!1}isAggregateFullyInitialized(t,i){for(const a of t.type.member){if(!i.hasOwnProperty(a.name)&&void 0===t.initialValue)return!1;if("aggregate"===a.type.engType&&!this.isAggregateFullyInitialized(a,i[a.name]))return!1}return!0}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.E4),e.Y36(Y.e),e.Y36(l.qu))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-command-form"]],inputs:{command:"command",templateProvider:"templateProvider"},features:[e.TTD],decls:16,vars:9,consts:[[1,"ya-form",3,"formGroup"],["formGroupName","args"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"hint"],["formControlName","comment","rows","3",2,"width","100%","resize","none"],[3,"name","description","type","initialValue","templateProvider"],["class","hasInitial",4,"ngIf"],[1,"hasInitial",3,"name","description","type","initialValue","templateProvider"],[1,"hasInitial"],["icon","double_arrow",3,"click"],[3,"ngSwitch"],["class","label",4,"ngSwitchCase"],["class","label",4,"ngSwitchDefault"],[1,"label"],[3,"dialogTitle",4,"ngIf"],["type","radio","value","true",3,"formControlName"],["type","radio","value","false",3,"formControlName"],[3,"dialogTitle"],[3,"innerHTML"],["type","text",3,"formControlName"]],template:function(i,a){1&i&&(e.TgZ(0,"form",0),e.ALo(1,"async"),e.ynx(2,1),e.YNc(3,on,3,6,"ng-container",2),e.YNc(4,sn,3,6,"ng-container",2),e.YNc(5,un,3,3,"ng-container",3),e.BQk(),e.TgZ(6,"p"),e._uU(7,"\xa0"),e.qZA(),e.TgZ(8,"h3"),e._uU(9,"Options"),e.qZA(),e.YNc(10,hn,2,1,"ng-container",3),e.TgZ(11,"label"),e._uU(12," Comment "),e.TgZ(13,"span",4),e._uU(14,"(optional)"),e.qZA(),e._UZ(15,"textarea",5),e.qZA()()),2&i&&(e.ekj("showAll",e.lcZ(1,7,a.showAll$)),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("ngForOf",a.arguments),e.xp6(1),e.Q6J("ngForOf",a.argumentsWithInitial),e.xp6(1),e.Q6J("ngIf",a.config.collapseInitializedArguments),e.xp6(5),e.Q6J("ngIf",a.showCommandOptions()))},styles:[".hasInitial[_ngcontent-%COMP%]{display:none}.showAll[_ngcontent-%COMP%]   .hasInitial[_ngcontent-%COMP%]{display:block}"],changeDetection:0})}return n})();var T=g(1896),xn=g(3906),ue=g(7914);let de=(()=>{class n{constructor(t,i){this.authService=t,this.router=i}canActivate(t,i){return!!this.authService.getUser().hasSystemPrivilege("ControlCommandQueue")||(this.router.navigate(["/403"],{queryParams:{page:i.url}}),!1)}canActivateChild(t,i){return this.canActivate(t,i)}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(Y.e),e.LFG(T.F0))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Tn=g(4529),Q=g(6593),N=g(3422),P=g(858),F=g(4104);const Cn=function(){return{matrixParams:"exact",paths:"exact",queryParams:"ignored"}},pe=function(n){return{c:n}};let _e=(()=>{class n{constructor(t){this.yamcs=t}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.C8))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-clearances-page-tabs"]],decls:10,vars:12,consts:[["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","/commanding/clearances","routerLinkActive","",3,"routerLinkActiveOptions","active","queryParams"],["rla","routerLinkActive"],["mat-tab-link","","routerLink","/commanding/clearances/log","routerLinkActive","",3,"active","queryParams"],["rlb","routerLinkActive"],["tabPanel",""]],template:function(i,a){if(1&i&&(e.TgZ(0,"nav",0)(1,"a",1,2),e._uU(3," Clearances "),e.qZA(),e.TgZ(4,"a",3,4),e._uU(6," Action log "),e.qZA()(),e.TgZ(7,"mat-tab-nav-panel",null,5),e._UZ(9,"router-outlet"),e.qZA()),2&i){const c=e.MAs(2),s=e.MAs(5),m=e.MAs(8);e.Q6J("mat-stretch-tabs",!1)("tabPanel",m),e.xp6(1),e.Q6J("routerLinkActiveOptions",e.DdM(7,Cn))("active",c.isActive)("queryParams",e.VKq(8,pe,a.yamcs.context)),e.xp6(3),e.Q6J("active",s.isActive)("queryParams",e.VKq(10,pe,a.yamcs.context))}},dependencies:[T.lC,T.rH,T.Od,F.BU,F.sW,F.Nj],styles:[".mat-mdc-tab-link[_ngcontent-%COMP%]{height:36px;min-width:0;font-size:13px}"],changeDetection:0})}return n})();const bn=["intervalSelect"];function Zn(n,o){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"ya-date-time-input",16)(2,"ya-date-time-input",17),e.TgZ(3,"button",18),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.applyCustomDates())}),e._uU(4,"Apply"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",t.filterForm.invalid)}}function vn(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",19),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.jumpToNow())}),e._uU(2," Jump to now "),e.qZA(),e.BQk()}}function An(n,o){1&n&&(e.TgZ(0,"th",20),e._uU(1,"Time"),e.qZA())}function kn(n,o){if(1&n&&(e.TgZ(0,"td",21),e._uU(1),e.ALo(2,"datetime"),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t.time))}}function wn(n,o){1&n&&(e.TgZ(0,"th",20),e._uU(1,"User"),e.qZA())}function Sn(n,o){if(1&n&&(e.TgZ(0,"td",21),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Oqu(t.user||"-")}}function Nn(n,o){1&n&&(e.TgZ(0,"th",20),e._uU(1,"Action"),e.qZA())}function Pn(n,o){if(1&n&&(e.TgZ(0,"td",21),e._UZ(1,"span",22),e.ALo(2,"actionLogFormat"),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,t.summary)||"-",e.oJD)}}function Un(n,o){1&n&&e._UZ(0,"th",23)}function Qn(n,o){1&n&&e._UZ(0,"td",21)}function qn(n,o){1&n&&e._UZ(0,"tr",24)}function On(n,o){1&n&&e._UZ(0,"tr",25)}let ge=(()=>{class n{constructor(t,i,a,c,s){this.yamcs=t,this.messageService=i,this.router=a,this.route=c,this.filterForm=new l.nJ({filter:new l.p4,interval:new l.p4("NO_LIMIT"),customStart:new l.p4(null),customStop:new l.p4(null)}),this.displayedColumns=["time","user","summary","actions"],this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.dataSource=new p.by,s.setTitle("Clearances"),this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(m=>{if("CUSTOM"===m){const d=new Date,_=this.validStart||d,y=this.validStop||d;this.filterForm.get("customStart").setValue(r.P6.toISOString(_)),this.filterForm.get("customStop").setValue(r.P6.toISOString(y))}else"NO_LIMIT"===m?(this.validStart=null,this.validStop=null,this.appliedInterval=m,this.loadData()):(this.validStop=new Date,this.validStart=r.P6.subtractDuration(this.validStop,m),this.appliedInterval=m,this.loadData())})}initializeOptions(){const t=this.route.snapshot.queryParamMap;if(t.has("filter")&&(this.filter=t.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),t.has("interval"))if(this.appliedInterval=t.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const i=t.get("customStart");this.filterForm.get("customStart").setValue(i),this.validStart=r.P6.toDate(i);const a=t.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=r.P6.toDate(a)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=r.P6.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval="NO_LIMIT",this.validStop=null,this.validStart=null}jumpToNow(){this.filterForm.get("interval").setValue("NO_LIMIT")}applyCustomDates(){this.validStart=r.P6.toDate(this.filterForm.value.customStart),this.validStop=r.P6.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const t={service:"ClearanceApi"};this.validStart&&(t.start=this.validStart.toISOString()),this.validStop&&(t.stop=this.validStop.toISOString()),this.filter&&(t.q=this.filter),this.yamcs.yamcsClient.getAuditRecords("_global",t).then(i=>this.dataSource.data=i.records||[]).catch(i=>this.messageService.showError(i))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filter||null,interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.C8),e.Y36(r.ez),e.Y36(T.F0),e.Y36(T.gz),e.Y36(Q.Dx))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(i,a){if(1&i&&e.Gf(bn,5),2&i){let c;e.iGM(c=e.CRH())&&(a.intervalSelect=c.first)}},decls:26,vars:7,consts:[[1,"panel-content"],[2,"margin-top","16px",3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],[4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","summary"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],["mat-header-cell",""],["mat-cell",""],[3,"innerHTML"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(i,a){1&i&&(e.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),e._uU(2," Clearances "),e.qZA(),e.TgZ(3,"div",0),e._UZ(4,"app-clearances-page-tabs"),e.TgZ(5,"form",1)(6,"div",2),e._UZ(7,"ya-select",3,4),e.YNc(9,Zn,5,1,"ng-container",5),e.YNc(10,vn,3,0,"ng-container",5),e.qZA()(),e.TgZ(11,"table",6),e.ynx(12,7),e.YNc(13,An,2,0,"th",8),e.YNc(14,kn,3,3,"td",9),e.BQk(),e.ynx(15,10),e.YNc(16,wn,2,0,"th",8),e.YNc(17,Sn,2,1,"td",9),e.BQk(),e.ynx(18,11),e.YNc(19,Nn,2,0,"th",8),e.YNc(20,Pn,3,3,"td",9),e.BQk(),e.ynx(21,12),e.YNc(22,Un,1,0,"th",13),e.YNc(23,Qn,1,0,"td",9),e.BQk(),e.YNc(24,qn,1,0,"tr",14),e.YNc(25,On,1,0,"tr",15),e.qZA()()()),2&i&&(e.xp6(5),e.Q6J("formGroup",a.filterForm),e.xp6(2),e.Q6J("options",a.intervalOptions),e.xp6(2),e.Q6J("ngIf","CUSTOM"===a.filterForm.value.interval),e.xp6(1),e.Q6J("ngIf","CUSTOM"!==a.filterForm.value.interval),e.xp6(1),e.Q6J("dataSource",a.dataSource),e.xp6(13),e.Q6J("matHeaderRowDef",a.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",a.displayedColumns))},dependencies:[u.O5,l._Y,l.JJ,l.JL,l.sg,l.u,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,r.t,r.Hr,N.a,P.k,_e,r.NE,r.id],encapsulation:2,changeDetection:0})}return n})(),fe=(()=>{class n{constructor(t,i){this.router=i,this.config=t.getConfig()}canActivate(t,i){return this.config.commandClearanceEnabled}canActivateChild(t,i){return this.canActivate(t,i)}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(r.E4),e.LFG(T.F0))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var $=g(3566),L=g(424);let Jn=(()=>{class n{constructor(t,i,a){this.dialogRef=t,this.data=a,this.form=i.group({level:new l.p4(null,[l.kI.required])}),a.clearance&&this.form.setValue({level:a.clearance.level||"DISABLED"})}confirm(){this.dialogRef.close({level:"DISABLED"===this.form.value.level?void 0:this.form.value.level})}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x.so),e.Y36(l.QS),e.Y36(x.WI))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-change-level-dialog"]],decls:31,vars:8,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","radio","formControlName","level","value","DISABLED"],[2,"font-weight","normal"],["type","radio","formControlName","level","value","NONE"],["level","NONE",3,"grayscale"],["type","radio","formControlName","level","value","WATCH"],["level","WATCH",3,"grayscale"],["type","radio","formControlName","level","value","WARNING"],["level","WARNING",3,"grayscale"],["type","radio","formControlName","level","value","DISTRESS"],["level","DISTRESS",3,"grayscale"],["type","radio","formControlName","level","value","CRITICAL"],["level","CRITICAL",3,"grayscale"],["type","radio","formControlName","level","value","SEVERE"],["level","SEVERE",3,"grayscale"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(i,a){1&i&&(e.TgZ(0,"h2",0),e._uU(1,"Command clearance"),e.qZA(),e.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),e._UZ(5,"input",3),e.TgZ(6,"span",4),e._uU(7,"No clearance"),e.qZA()(),e.TgZ(8,"label"),e._UZ(9,"input",5)(10,"app-significance-level",6),e.qZA(),e.TgZ(11,"label"),e._UZ(12,"input",7)(13,"app-significance-level",8),e.qZA(),e.TgZ(14,"label"),e._UZ(15,"input",9)(16,"app-significance-level",10),e.qZA(),e.TgZ(17,"label"),e._UZ(18,"input",11)(19,"app-significance-level",12),e.qZA(),e.TgZ(20,"label"),e._UZ(21,"input",13)(22,"app-significance-level",14),e.qZA(),e.TgZ(23,"label"),e._UZ(24,"input",15)(25,"app-significance-level",16),e.qZA()()(),e.TgZ(26,"mat-dialog-actions",17)(27,"button",18),e._uU(28,"CANCEL"),e.qZA(),e.TgZ(29,"button",19),e.NdJ("click",function(){return a.confirm()}),e._uU(30,"SAVE CHANGES"),e.qZA()()),2&i&&(e.xp6(3),e.Q6J("formGroup",a.form),e.xp6(7),e.Q6J("grayscale",!0),e.xp6(3),e.Q6J("grayscale",!0),e.xp6(3),e.Q6J("grayscale",!0),e.xp6(3),e.Q6J("grayscale",!0),e.xp6(3),e.Q6J("grayscale",!0),e.xp6(3),e.Q6J("grayscale",!0),e.xp6(4),e.Q6J("disabled",!a.form.valid))},dependencies:[l._Y,l.Fj,l._,l.JJ,l.JL,l.sg,l.u,x.ZT,x.uh,x.xY,x.H8,L.U],styles:["[_ngcontent-%COMP%]:focus{outline:none}"]})}return n})();var O=g(2296);function Dn(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"th",19)(1,"input",20),e.NdJ("change",function(a){e.CHM(t);const c=e.oxw(2);return e.KtG(a?c.masterToggle():null)}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("checked",t.selection.hasValue()&&t.isAllSelected())}}function Mn(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",21)(1,"input",22),e.NdJ("click",function(a){return a.stopPropagation()})("change",function(a){const s=e.CHM(t).$implicit,m=e.oxw(2);return e.KtG(a?m.selection.toggle(s):null)}),e.qZA()()}if(2&n){const t=o.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("checked",i.selection.isSelected(t))}}function Yn(n,o){1&n&&(e.TgZ(0,"th",23),e._uU(1,"Username"),e.qZA())}function Fn(n,o){if(1&n&&(e.TgZ(0,"td",24),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.username," ")}}function $n(n,o){1&n&&(e.TgZ(0,"th",23),e._uU(1,"May Command"),e.qZA())}function Ln(n,o){1&n&&(e.TgZ(0,"mat-icon"),e._uU(1,"check"),e.qZA())}function En(n,o){1&n&&(e.TgZ(0,"mat-icon"),e._uU(1,"close"),e.qZA())}function Hn(n,o){if(1&n&&(e.TgZ(0,"td",24),e.YNc(1,Ln,2,0,"mat-icon",25),e.YNc(2,En,2,0,"mat-icon",25),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",t.hasCommandPrivileges),e.xp6(1),e.Q6J("ngIf",!t.hasCommandPrivileges)}}function Bn(n,o){1&n&&(e.TgZ(0,"th",23),e._uU(1,"Clearance Level"),e.qZA())}function Rn(n,o){1&n&&(e.ynx(0),e._uU(1,"No clearance"),e.BQk())}function Vn(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"app-significance-level",26),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("level",t.level)("grayscale",!0)}}function jn(n,o){if(1&n&&(e.TgZ(0,"td",24),e.YNc(1,Rn,2,0,"ng-container",25),e.YNc(2,Vn,2,2,"ng-container",25),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",!t.level),e.xp6(1),e.Q6J("ngIf",t.level)}}function Gn(n,o){1&n&&(e.TgZ(0,"th",23),e._uU(1,"Issued"),e.qZA())}function Wn(n,o){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" by ",t.issuedBy," ")}}function Xn(n,o){if(1&n&&(e.TgZ(0,"td",24),e._uU(1),e.ALo(2,"datetime"),e.YNc(3,Wn,2,1,"ng-container",25),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,2,t.issueTime)||"-"," "),e.xp6(2),e.Q6J("ngIf",t.issuedBy)}}function zn(n,o){1&n&&e._UZ(0,"th",27)}function Kn(n,o){1&n&&e._UZ(0,"td",28)}function ei(n,o){1&n&&e._UZ(0,"tr",29)}function ti(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr",30),e.NdJ("click",function(){const c=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.toggleOne(c))}),e.qZA()}if(2&n){const t=o.$implicit,i=e.oxw(2);e.ekj("selected",i.selection.isSelected(t))}}function ni(n,o){if(1&n&&(e.TgZ(0,"table",4),e.ynx(1,5),e.YNc(2,Dn,2,1,"th",6),e.YNc(3,Mn,2,1,"td",7),e.BQk(),e.ynx(4,8),e.YNc(5,Yn,2,0,"th",9),e.YNc(6,Fn,2,1,"td",10),e.BQk(),e.ynx(7,11),e.YNc(8,$n,2,0,"th",9),e.YNc(9,Hn,3,2,"td",10),e.BQk(),e.ynx(10,12),e.YNc(11,Bn,2,0,"th",9),e.YNc(12,jn,3,2,"td",10),e.BQk(),e.ynx(13,13),e.YNc(14,Gn,2,0,"th",9),e.YNc(15,Xn,4,4,"td",10),e.BQk(),e.ynx(16,14),e.YNc(17,zn,1,0,"th",15),e.YNc(18,Kn,1,0,"td",16),e.BQk(),e.YNc(19,ei,1,0,"tr",17),e.YNc(20,ti,1,2,"tr",18),e.qZA()),2&n){const t=e.oxw();e.Q6J("dataSource",t.dataSource),e.xp6(19),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}let he=(()=>{class n{constructor(t,i,a){this.yamcs=t,this.dialog=a,this.displayedColumns=["select","username","hasCommandPrivileges","level","issued","actions"],this.dataSource=new p.by,this.selection=new E.Ov(!0,[]),i.setTitle("Clearances"),this.refresh()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}isAllSelected(){const i=this.dataSource.filteredData.length;return this.selection.selected.length===i&&i>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(t=>this.selection.select(t))}toggleOne(t){(!this.selection.isSelected(t)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(t)}refresh(){this.selection.clear(),this.yamcs.yamcsClient.getClearances().then(t=>{this.dataSource.data=t.clearances||[]})}isGroupChangeLevelEnabled(){return!this.selection.isEmpty()}openChangeLevelDialog(){let t;1===this.selection.selected.length&&(t=this.selection.selected[0]),this.dialog.open(Jn,{data:{clearance:t},width:"400px"}).afterClosed().subscribe(a=>{if(a){const c=[];if(a.level)for(const s of this.selection.selected)c.push(this.yamcs.yamcsClient.changeClearance(s.username,{level:a.level}));else for(const s of this.selection.selected)c.push(this.yamcs.yamcsClient.deleteClearance(s.username));c.length&&Promise.all(c).then(()=>this.refresh())}})}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.C8),e.Y36(Q.Dx),e.Y36(x.uw))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(i,a){if(1&i&&(e.Gf($.YE,5),e.Gf(M.NW,5)),2&i){let c;e.iGM(c=e.CRH())&&(a.sort=c.first),e.iGM(c=e.CRH())&&(a.paginator=c.first)}},decls:17,vars:5,consts:[["mat-button","","color","primary",3,"disabled","click"],[1,"panel-content"],["mat-table","","matSort","","class","ya-data-table expand","style","margin-top: 16px","matSortActive","username","matSortDirection","asc","matSortDisableClear","",3,"dataSource",4,"ngIf"],[3,"pageSize","hidePageSize","showFirstLastButtons"],["mat-table","","matSort","","matSortActive","username","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",2,"margin-top","16px",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["matColumnDef","username"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","hasCommandPrivileges"],["matColumnDef","level"],["matColumnDef","issued"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","expand",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked","change"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"checked","click","change"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[4,"ngIf"],[3,"level","grayscale"],["mat-header-cell",""],["mat-cell","",1,"expand"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(i,a){1&i&&(e.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),e._uU(2," Clearances "),e.TgZ(3,"ya-help")(4,"p"),e._uU(5,"Clearances allow central control over the level of commands that users are able to send."),e.qZA(),e.TgZ(6,"p"),e._uU(7," Clearance works in addition to regular permission checks. So if a user does anyway not have authorization to send certain commands, giving this user clearance will not change this fact. "),e.qZA()(),e._uU(8," \xa0\xa0\xa0 "),e.TgZ(9,"button",0),e.NdJ("click",function(){return a.openChangeLevelDialog()}),e.TgZ(10,"mat-icon"),e._uU(11,"how_to_reg"),e.qZA(),e._uU(12," Change level "),e.qZA()(),e.TgZ(13,"div",1),e._UZ(14,"app-clearances-page-tabs"),e.YNc(15,ni,21,3,"table",2),e._UZ(16,"mat-paginator",3),e.qZA()()),2&i&&(e.xp6(9),e.Q6J("disabled",!a.isGroupChangeLevelEnabled()),e.xp6(6),e.Q6J("ngIf",a.dataSource),e.xp6(1),e.Q6J("pageSize",100)("hidePageSize",!0)("showFirstLastButtons",!0))},dependencies:[u.O5,v.O_,v.D5,v.fo,O.lW,S.Hw,M.NW,$.YE,$.nU,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,r.IR,N.a,P.k,L.U,_e,r.id],encapsulation:2,changeDetection:0})}return n})();var ii=g(3620),q=g(5861);class ai{constructor(o){this.watermarkObserver=o,this.dirty=!1,this.archiveRecords=[],this.bufferSize=500,this.bufferWatermark=400,this.pointer=0,this.alreadyWarned=!1,this.realtimeBuffer=Array(this.bufferSize).fill(void 0)}addArchiveData(o){this.archiveRecords=this.archiveRecords.concat(o),this.dirty=!0}addRealtimeCommand(o){this.pointer<this.bufferSize&&(this.realtimeBuffer[this.pointer]=o,this.pointer>=this.bufferWatermark&&this.watermarkObserver&&!this.alreadyWarned&&(this.alreadyWarned=!0,this.watermarkObserver()),this.pointer=this.pointer+1),this.dirty=!0}reset(){this.archiveRecords=[],this.realtimeBuffer.fill(void 0),this.pointer=0,this.alreadyWarned=!1,this.dirty=!0}snapshot(){const o=this.archiveRecords;return this.realtimeBuffer.map(t=>{if(!t)return;const i=o.findIndex(a=>a.id==t.id);-1==i?o.push(new r.mq(t)):o[i]=o[i].mergeEntry(t)}),o.sort((t,i)=>{let a=-t.generationTime.localeCompare(i.generationTime);return 0===a&&(a=-t.origin.localeCompare(i.origin)),0!==a?a:i.sequenceNumber-t.sequenceNumber}),o}compact(o){const t=this.snapshot();t.length=Math.min(o,t.length),this.reset(),this.archiveRecords=t,this.dirty=!0}}class oi extends E.o2{constructor(o,t){super(),this.yamcs=o,this.pageSize=100,this.blockHasMore=!1,this.records$=new C.X([]),this.loading$=new C.X(!1),this.streaming$=new C.X(!1),this.namespaces$=new C.X([]),this.syncSubscription=t.sync(()=>{this.buffer.dirty&&!this.loading$.getValue()&&(this.records$.next(this.buffer.snapshot()),this.buffer.dirty=!1)}),this.buffer=new ai(()=>{this.blockHasMore=!0,this.buffer.compact(500)})}connect(){return this.records$}loadEntries(o){return this.loading$.next(!0),this.loadPage({...o,limit:this.pageSize}).then(t=>{this.buffer.reset(),this.blockHasMore=!1,this.buffer.addArchiveData(t.map(i=>new r.mq(i)))}).finally(()=>{this.loading$.next(!1)})}hasMore(){return!!this.continuationToken&&!this.blockHasMore}loadPage(o){var t=this;return(0,q.Z)(function*(){return t.yamcs.yamcsClient.getCommandHistoryEntries(t.yamcs.instance,o).then(i=>{t.continuationToken=i.continuationToken;var a=i.entry||[];for(const c of a)t.updateNamespaces(c);return a})})()}loadMoreData(o){var t=this;return(0,q.Z)(function*(){if(t.continuationToken)return t.loadPage({...o,next:t.continuationToken,limit:t.pageSize}).then(i=>{t.buffer.addArchiveData(i.map(a=>new r.mq(a)))})})()}startStreaming(){this.streaming$.next(!0),this.realtimeSubscription=this.yamcs.yamcsClient.createCommandSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor},o=>{this.loading$.getValue()||(this.updateNamespaces(o),this.buffer.addRealtimeCommand(o))})}updateNamespaces(o){const t=this.namespaces$.value;if(o.aliases)for(const i in o.aliases)-1===t.indexOf(i)&&(t.push(i),t.sort(),this.namespaces$.next([...t]))}stopStreaming(){this.realtimeSubscription?.cancel(),this.streaming$.next(!1)}disconnect(){this.syncSubscription?.unsubscribe(),this.records$.complete(),this.loading$.complete(),this.streaming$.complete(),this.namespaces$.complete()}isEmpty(){return!this.records$.getValue().length}}var xe=g(342),D=g(6385),ci=g(3170);function si(n,o){if(1&n&&(e.TgZ(0,"mat-icon",7),e._uU(1,"schedule"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("matTooltip",t.ack.name+": Scheduled")}}function ri(n,o){if(1&n&&(e.TgZ(0,"mat-icon",8),e._uU(1,"check_circle_outline"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("matTooltip",t.ack.name+": OK")}}function li(n,o){if(1&n&&(e.TgZ(0,"mat-icon",7),e._uU(1,"lens"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("matTooltip",t.ack.name+": PENDING")}}function mi(n,o){if(1&n&&(e.TgZ(0,"mat-icon",9),e._uU(1,"block"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("matTooltip",t.ack.name+": CANCELLED")}}function ui(n,o){if(1&n&&(e.TgZ(0,"mat-icon",9),e._uU(1,"block"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("matTooltip",t.ack.name+": DISABLED")}}function di(n,o){if(1&n&&(e.TgZ(0,"mat-icon",10),e._uU(1,"highlight_off"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("matTooltip",t.ack.name+": TIMEOUT")}}function pi(n,o){if(1&n&&(e.TgZ(0,"mat-icon",10),e._uU(1,"highlight_off"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("matTooltip",t.ack.name+": "+t.ack.status+" ("+t.ack.message+")")}}function _i(n,o){if(1&n&&(e.ynx(0)(1,1),e.YNc(2,si,2,1,"mat-icon",2),e.YNc(3,ri,2,1,"mat-icon",3),e.YNc(4,li,2,1,"mat-icon",2),e.YNc(5,mi,2,1,"mat-icon",4),e.YNc(6,ui,2,1,"mat-icon",4),e.YNc(7,di,2,1,"mat-icon",5),e.YNc(8,pi,2,1,"mat-icon",6),e.BQk()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngSwitch",t.ack.status),e.xp6(1),e.Q6J("ngSwitchCase","SCHEDULED"),e.xp6(1),e.Q6J("ngSwitchCase","OK"),e.xp6(1),e.Q6J("ngSwitchCase","PENDING"),e.xp6(1),e.Q6J("ngSwitchCase","CANCELLED"),e.xp6(1),e.Q6J("ngSwitchCase","DISABLED"),e.xp6(1),e.Q6J("ngSwitchCase","TIMEOUT")}}function gi(n,o){1&n&&(e.ynx(0),e.TgZ(1,"mat-icon",11),e._uU(2,"lens"),e.qZA(),e.BQk()),2&n&&(e.xp6(1),e.Q6J("matTooltip","Unknown"))}let ce=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-acknowledgment-icon"]],inputs:{ack:"ack"},decls:2,vars:2,consts:[[4,"ngIf"],[3,"ngSwitch"],["class","icon16 down",3,"matTooltip",4,"ngSwitchCase"],["class","icon16","style","color: #00c752",3,"matTooltip",4,"ngSwitchCase"],["class","icon16","style","color: lightgrey",3,"matTooltip",4,"ngSwitchCase"],["class","icon16","style","color: red",3,"matTooltip",4,"ngSwitchCase"],["class","icon16","style","color: red",3,"matTooltip",4,"ngSwitchDefault"],[1,"icon16","down",3,"matTooltip"],[1,"icon16",2,"color","#00c752",3,"matTooltip"],[1,"icon16",2,"color","lightgrey",3,"matTooltip"],[1,"icon16",2,"color","red",3,"matTooltip"],[1,"down","icon16",3,"matTooltip"]],template:function(i,a){1&i&&(e.YNc(0,_i,9,7,"ng-container",0),e.YNc(1,gi,3,1,"ng-container",0)),2&i&&(e.Q6J("ngIf",a.ack),e.xp6(1),e.Q6J("ngIf",!a.ack))},dependencies:[u.O5,u.RF,u.n9,u.ED,S.Hw,U.gM],styles:["[_nghost-%COMP%]{line-height:0;font-size:0}"],changeDetection:0})}return n})();function fi(n,o){if(1&n&&(e.TgZ(0,"td",7)(1,"div",8),e._UZ(2,"app-acknowledgment-icon",9),e.qZA()()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("ack",t)}}function hi(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1,"-"),e.qZA())}function xi(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1,"-"),e.qZA())}function yi(n,o){if(1&n&&(e.TgZ(0,"span",10),e._uU(1),e.ALo(2,"deltaWith"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw();e.Q6J("matTooltip",t.time),e.xp6(1),e.hij(" ",e.xi3(2,2,t.time,i.command.generationTime)," ")}}function Ti(n,o){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,fi,3,1,"td",1),e.TgZ(2,"td",2),e._uU(3),e.qZA(),e.TgZ(4,"td",3),e._uU(5),e.qZA(),e.TgZ(6,"td"),e.ynx(7,4),e.YNc(8,hi,2,0,"span",5),e.YNc(9,xi,2,0,"span",5),e.YNc(10,yi,3,5,"span",6),e.BQk(),e.qZA()()),2&n){const t=o.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.showIcons),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Q6J("ngSwitch",t.status),e.xp6(1),e.Q6J("ngSwitchCase","SCHEDULED"),e.xp6(1),e.Q6J("ngSwitchCase","PENDING")}}let ye=(()=>{class n{constructor(){this.inline=!1,this.showIcons=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-extra-acknowledgments-table"]],inputs:{command:"command",inline:"inline",showIcons:"showIcons"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["style","width: 16px",4,"ngIf"],[2,"width","150px"],[2,"width","70px"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"matTooltip",4,"ngSwitchDefault"],[2,"width","16px"],[2,"display","flex","align-items","center"],[3,"ack"],[3,"matTooltip"]],template:function(i,a){1&i&&(e.TgZ(0,"table"),e.YNc(1,Ti,11,6,"tr",0),e.qZA()),2&i&&(e.xp6(1),e.Q6J("ngForOf",a.command.extraAcks))},dependencies:[u.sg,u.O5,u.RF,u.n9,u.ED,U.gM,ce,r.mX],styles:["table[_ngcontent-%COMP%]{width:auto}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;padding:0}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(:first-child){padding-left:10px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px;line-height:16px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#000000a7}"],changeDetection:0})}return n})();function Ci(n,o){1&n&&(e.TgZ(0,"mat-icon",3),e._uU(1,"cached "),e.qZA())}function bi(n,o){1&n&&(e.TgZ(0,"mat-icon",4),e._uU(1,"lens"),e.qZA())}let Te=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-transmission-constraints-icon"]],inputs:{command:"command"},decls:3,vars:2,consts:[[3,"ngSwitch"],["class","down icon16 spin","matTooltip","Checking transmission constraints",4,"ngSwitchCase"],["class","down icon16",4,"ngSwitchDefault"],["matTooltip","Checking transmission constraints",1,"down","icon16","spin"],[1,"down","icon16"]],template:function(i,a){1&i&&(e.ynx(0,0),e.YNc(1,Ci,2,0,"mat-icon",1),e.YNc(2,bi,2,0,"mat-icon",2),e.BQk()),2&i&&(e.Q6J("ngSwitch",null==a.command.transmissionConstraints?null:a.command.transmissionConstraints.status),e.xp6(1),e.Q6J("ngSwitchCase","PENDING"))},dependencies:[u.RF,u.n9,u.ED,S.Hw,U.gM],styles:["[_nghost-%COMP%]{line-height:0;font-size:0}.spin[_ngcontent-%COMP%]{animation:yspin 2s infinite linear}"],changeDetection:0})}return n})();function Zi(n,o){if(1&n&&(e.TgZ(0,"td",5)(1,"div",6),e._UZ(2,"app-acknowledgment-icon",7),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ack",t.command.queued)}}function vi(n,o){if(1&n&&e._UZ(0,"app-transmission-constraints-icon",10),2&n){const t=e.oxw(3);e.Q6J("command",t.command)}}function Ai(n,o){if(1&n&&e._UZ(0,"app-acknowledgment-icon",7),2&n){const t=e.oxw(3);e.Q6J("ack",t.command.released)}}function ki(n,o){if(1&n&&(e.TgZ(0,"td")(1,"div",6),e.YNc(2,vi,1,1,"app-transmission-constraints-icon",8),e.YNc(3,Ai,1,1,"app-acknowledgment-icon",9),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",!t.command.released),e.xp6(1),e.Q6J("ngIf",t.command.released)}}function wi(n,o){if(1&n&&(e.TgZ(0,"td")(1,"div",6),e._UZ(2,"app-acknowledgment-icon",7),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ack",t.command.sent)}}function Si(n,o){if(1&n&&(e.TgZ(0,"table")(1,"tr"),e.YNc(2,Zi,3,1,"td",1),e.TgZ(3,"td",2),e._uU(4,"Queued"),e.qZA(),e.TgZ(5,"td",3),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"span",4),e._uU(9),e.ALo(10,"deltaWith"),e.qZA()()(),e.TgZ(11,"tr"),e.YNc(12,ki,4,2,"td",0),e.TgZ(13,"td"),e._uU(14,"Released"),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td")(18,"span",4),e._uU(19),e.ALo(20,"deltaWith"),e.qZA()()(),e.TgZ(21,"tr"),e.YNc(22,wi,3,1,"td",0),e.TgZ(23,"td"),e._uU(24,"Sent"),e.qZA(),e.TgZ(25,"td"),e._uU(26),e.qZA(),e.TgZ(27,"td")(28,"span",4),e._uU(29),e.ALo(30,"deltaWith"),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.showIcons),e.xp6(4),e.Oqu((null==t.command.queued?null:t.command.queued.status)||"-"),e.xp6(2),e.Q6J("matTooltip",null==t.command.queued?null:t.command.queued.time),e.xp6(1),e.hij(" ",e.xi3(10,12,null==t.command.queued?null:t.command.queued.time,t.command.generationTime)||"-"," "),e.xp6(3),e.Q6J("ngIf",t.showIcons),e.xp6(4),e.hij(" ",(null==t.command.released?null:t.command.released.status)||(null==t.command.transmissionConstraints?null:t.command.transmissionConstraints.status)||"-"," "),e.xp6(2),e.Q6J("matTooltip",null==t.command.released?null:t.command.released.time),e.xp6(1),e.hij(" ",e.xi3(20,15,null==t.command.released?null:t.command.released.time,t.command.generationTime)||"-"," "),e.xp6(3),e.Q6J("ngIf",t.showIcons),e.xp6(4),e.Oqu((null==t.command.sent?null:t.command.sent.status)||"-"),e.xp6(2),e.Q6J("matTooltip",null==t.command.sent?null:t.command.sent.time),e.xp6(1),e.hij(" ",e.xi3(30,18,null==t.command.sent?null:t.command.sent.time,t.command.generationTime)||"-"," ")}}let Ce=(()=>{class n{constructor(){this.inline=!1,this.showIcons=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-yamcs-acknowledgments-table"]],inputs:{command:"command",inline:"inline",showIcons:"showIcons"},decls:1,vars:1,consts:[[4,"ngIf"],["style","width: 16px",4,"ngIf"],[2,"width","150px"],[2,"width","70px"],[3,"matTooltip"],[2,"width","16px"],[2,"display","flex","align-items","center"],[3,"ack"],[3,"command",4,"ngIf"],[3,"ack",4,"ngIf"],[3,"command"]],template:function(i,a){1&i&&e.YNc(0,Si,31,21,"table",0),2&i&&e.Q6J("ngIf",a.command)},dependencies:[u.O5,U.gM,ce,Te,r.mX],styles:["table[_ngcontent-%COMP%]{width:auto}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;padding:0}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(:first-child){padding-left:10px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px;line-height:16px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#000000a7}"],changeDetection:0})}return n})();function Ni(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",9),e._uU(2),e.qZA(),e.TgZ(3,"td",10),e._UZ(4,"ya-value",11),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Q6J("value",t.value)}}function Pi(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2),e._uU(2," Unprocessed binary "),e.TgZ(3,"ya-more",12)(4,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.copyHex(a.command.unprocessedBinary))}),e._uU(5," Copy Hex "),e.qZA(),e.TgZ(6,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.copyBinary(a.command.unprocessedBinary))}),e._uU(7," Copy Binary "),e.qZA()()(),e.TgZ(8,"div",14),e._UZ(9,"app-hex",15),e.qZA(),e.TgZ(10,"div",16)(11,"pre"),e._uU(12),e.ALo(13,"hexDump"),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("base64String",t.command.unprocessedBinary),e.xp6(3),e.Oqu(e.lcZ(13,2,t.command.unprocessedBinary)||"-")}}function Ui(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2),e._uU(2," Binary "),e.TgZ(3,"ya-more",12)(4,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.copyHex(a.command.binary))}),e._uU(5," Copy Hex "),e.qZA(),e.TgZ(6,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.copyBinary(a.command.binary))}),e._uU(7," Copy Binary "),e.qZA()()(),e.TgZ(8,"div",14),e._UZ(9,"app-hex",15),e.qZA(),e.TgZ(10,"div",16)(11,"pre"),e._uU(12),e.ALo(13,"hexDump"),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("base64String",t.command.binary),e.xp6(3),e.Oqu(e.lcZ(13,2,t.command.binary)||"-")}}function Qi(n,o){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.hij("@",t.command.origin," ")}}function qi(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",2),e._uU(2,"Queue"),e.qZA(),e.TgZ(3,"div",1),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(4),e.hij(" ",t.command.queue||"-"," ")}}function Oi(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"mat-divider",7),e.TgZ(2,"div",0),e._uU(3,"Comment"),e.qZA(),e.TgZ(4,"div",1),e._uU(5),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(5),e.hij(" ",t.command.comment," ")}}function Ii(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"ya-more",12)(1,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,c=e.oxw(2);return e.KtG(c.copyHex(a.value.binaryValue))}),e._uU(2," Copy Hex "),e.qZA(),e.TgZ(3,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,c=e.oxw(2);return e.KtG(c.copyBinary(a.value.binaryValue))}),e._uU(4," Copy Binary "),e.qZA()()}}function Ji(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",14),e._UZ(2,"app-hex",15),e.qZA(),e.TgZ(3,"div",16)(4,"pre"),e._uU(5),e.ALo(6,"hexDump"),e.qZA()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("base64String",t.value.binaryValue),e.xp6(3),e.Oqu(e.lcZ(6,2,t.value.binaryValue)||"-")}}function Di(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",1),e._uU(2),e.ALo(3,"value"),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",e.lcZ(3,1,t.value)," ")}}function Mi(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",2),e._uU(2),e.YNc(3,Ii,5,0,"ya-more",17),e.qZA(),e.ynx(4,18),e.YNc(5,Ji,7,4,"ng-container",19),e.YNc(6,Di,4,3,"ng-container",20),e.BQk()()),2&n){const t=o.$implicit,i=o.first;e.xp6(1),e.ekj("first",i),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf","BINARY"===t.value.type),e.xp6(1),e.Q6J("ngSwitch",t.value.type),e.xp6(1),e.Q6J("ngSwitchCase","BINARY")}}function Yi(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"mat-divider",7),e.YNc(2,Mi,7,6,"ng-container",5),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.command.extra)}}function Fi(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",2),e._uU(2,"Extra acknowledgments"),e.qZA(),e.TgZ(3,"div",1),e._UZ(4,"app-extra-acknowledgments-table",8),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(4),e.Q6J("command",t.command)("showIcons",t.showIcons)}}function $i(n,o){1&n&&(e.ynx(0),e._uU(1,"SUCCESS"),e.BQk())}function Li(n,o){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.hij(" FAILURE: ",null==t.command.completed?null:t.command.completed.message," ")}}function Ei(n,o){1&n&&(e.ynx(0),e._uU(1,"-"),e.BQk())}function Hi(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",2),e._uU(2),e.ALo(3,"cascadingPrefix"),e.qZA(),e.TgZ(4,"div",1),e._UZ(5,"app-extra-acknowledgments-table",8),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit,i=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,3,t.key)," extra acknowledgments"),e.xp6(3),e.Q6J("command",t.value)("showIcons",i.showIcons)}}function Bi(n,o){1&n&&(e.ynx(0),e._uU(1,"SUCCESS"),e.BQk())}function Ri(n,o){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" FAILURE: ",null==t.value.completed?null:t.value.completed.message," ")}}function Vi(n,o){1&n&&(e.ynx(0),e._uU(1,"-"),e.BQk())}function ji(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"mat-divider",7),e.TgZ(2,"div",0),e._uU(3),e.ALo(4,"cascadingPrefix"),e.qZA(),e.TgZ(5,"div",1),e._UZ(6,"app-yamcs-acknowledgments-table",8),e.qZA(),e.YNc(7,Hi,6,5,"ng-container",6),e.TgZ(8,"div",2),e._uU(9),e.ALo(10,"cascadingPrefix"),e.qZA(),e.TgZ(11,"div",1),e.YNc(12,Bi,2,0,"ng-container",6),e.YNc(13,Ri,2,1,"ng-container",6),e.YNc(14,Vi,2,0,"ng-container",6),e.qZA(),e.BQk()),2&n){const t=o.$implicit,i=e.oxw();e.xp6(3),e.hij("",e.lcZ(4,8,t.key)," acknowledgments"),e.xp6(3),e.Q6J("command",t.value)("showIcons",i.showIcons),e.xp6(1),e.Q6J("ngIf",t.value.extraAcks.length),e.xp6(2),e.hij("",e.lcZ(10,10,t.key)," completion"),e.xp6(3),e.Q6J("ngIf","OK"===(null==t.value.completed?null:t.value.completed.status)),e.xp6(1),e.Q6J("ngIf","NOK"===(null==t.value.completed?null:t.value.completed.status)),e.xp6(1),e.Q6J("ngIf",!t.value.completed)}}let V=(()=>{class n{constructor(t){this.clipboard=t,this.showIcons=!0}copyHex(t){const i=r.P6.convertBase64ToHex(t);this.clipboard.copy(i)}copyBinary(t){const i=window.atob(t);this.clipboard.copy(i)}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(xe.TU))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-command-detail2"]],inputs:{command:"command",showIcons:"showIcons"},decls:40,vars:22,consts:[[1,"block-title",2,"padding-top","0"],[1,"block"],[1,"block-title"],[1,"block","command-text"],[1,"args"],[4,"ngFor","ngForOf"],[4,"ngIf"],[2,"margin-top","1em","margin-bottom","1em"],[3,"command","showIcons"],["width","1",1,"key"],[1,"value"],[3,"value"],["icon","more_horiz"],["mat-menu-item","",3,"click"],[1,"block","no-print",2,"margin-top","4px"],[3,"base64String"],[1,"block","print-only"],["icon","more_horiz",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0),e._uU(1,"ID"),e.qZA(),e.TgZ(2,"div",1),e._uU(3),e.qZA(),e.TgZ(4,"div",2),e._uU(5,"Command"),e.qZA(),e.TgZ(6,"div",3),e._uU(7),e.TgZ(8,"table",4),e.YNc(9,Ni,5,2,"tr",5),e.qZA()(),e.YNc(10,Pi,14,4,"ng-container",6),e.YNc(11,Ui,14,4,"ng-container",6),e._UZ(12,"mat-divider",7),e.TgZ(13,"div",0),e._uU(14,"Time"),e.qZA(),e.TgZ(15,"div",1),e._uU(16),e.ALo(17,"datetime"),e.qZA(),e.TgZ(18,"div",2),e._uU(19,"Issuer"),e.qZA(),e.TgZ(20,"div",1),e._uU(21),e.YNc(22,Qi,2,1,"ng-container",6),e.qZA(),e.YNc(23,qi,5,1,"ng-container",6),e.YNc(24,Oi,6,1,"ng-container",6),e.YNc(25,Yi,3,1,"ng-container",6),e._UZ(26,"mat-divider",7),e.TgZ(27,"div",0),e._uU(28,"Yamcs acknowledgments"),e.qZA(),e.TgZ(29,"div",1),e._UZ(30,"app-yamcs-acknowledgments-table",8),e.qZA(),e.YNc(31,Fi,5,2,"ng-container",6),e.TgZ(32,"div",2),e._uU(33,"Completion"),e.qZA(),e.TgZ(34,"div",1),e.YNc(35,$i,2,0,"ng-container",6),e.YNc(36,Li,2,1,"ng-container",6),e.YNc(37,Ei,2,0,"ng-container",6),e.qZA(),e.YNc(38,ji,15,12,"ng-container",5),e.ALo(39,"keyvalue")),2&i&&(e.xp6(3),e.hij(" ",a.command.id,"\n"),e.xp6(4),e.hij(" ",a.command.commandName," "),e.xp6(2),e.Q6J("ngForOf",a.command.userAssignments),e.xp6(1),e.Q6J("ngIf",a.command.unprocessedBinary&&a.command.unprocessedBinary!==a.command.binary),e.xp6(1),e.Q6J("ngIf",a.command.binary),e.xp6(5),e.hij(" ",e.lcZ(17,18,a.command.generationTime),"\n"),e.xp6(5),e.hij(" ",a.command.username,""),e.xp6(1),e.Q6J("ngIf",a.command.origin),e.xp6(1),e.Q6J("ngIf",a.command.queue),e.xp6(1),e.Q6J("ngIf",a.command.comment),e.xp6(1),e.Q6J("ngIf",a.command.extra.length),e.xp6(5),e.Q6J("command",a.command)("showIcons",a.showIcons),e.xp6(1),e.Q6J("ngIf",a.command.extraAcks.length),e.xp6(4),e.Q6J("ngIf","OK"===(null==a.command.completed?null:a.command.completed.status)),e.xp6(1),e.Q6J("ngIf","NOK"===(null==a.command.completed?null:a.command.completed.status)),e.xp6(1),e.Q6J("ngIf",!a.command.completed),e.xp6(1),e.Q6J("ngForOf",e.lcZ(39,20,a.command.cascadedRecordsByPrefix)))},dependencies:[u.sg,u.O5,u.RF,u.n9,u.ED,D.d,w.OP,r.cQ,r.u$,ci.p,ye,Ce,u.Nd,r.id,r.Wc,r.VC,le],styles:[".command-text[_ngcontent-%COMP%]   .args[_ngcontent-%COMP%]{margin:0 0 0 10px}.command-text[_ngcontent-%COMP%]   .args[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{min-width:80px;white-space:nowrap;vertical-align:top}.command-text[_ngcontent-%COMP%]   .args[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:gray;padding-left:10px}.block-title.first[_ngcontent-%COMP%]{padding-top:0}"],changeDetection:0})}return n})();function Gi(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"app-command-detail2",1)(2,"div",2),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("command",t)("showIcons",!1)}}let Wi=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-command-history-printable"]],inputs:{pageTitle:"pageTitle",data:"data"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"command","showIcons"],[2,"page-break-after","always"]],template:function(i,a){1&i&&e.YNc(0,Gi,3,2,"ng-container",0),2&i&&e.Q6J("ngForOf",a.data)},dependencies:[u.sg,V],encapsulation:2,changeDetection:0})}return n})(),be=(()=>{class n{constructor(t){this.yamcs=t}transform(t){return t?this.yamcs.yamcsClient.getCommandDownloadURL(this.yamcs.instance,t.id):null}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.C8,16))};static#t=this.\u0275pipe=e.Yjl({name:"commandDownloadLink",type:n,pure:!0})}return n})();const Xi=["intervalSelect"];function zi(n,o){if(1&n&&(e.TgZ(0,"button",12),e.ALo(1,"async"),e.TgZ(2,"mat-icon"),e._uU(3,"save_alt"),e.qZA(),e._uU(4," Export "),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(4);let a;e.Q6J("matMenuTriggerFor",i)("disabled",!(null!=(a=e.lcZ(1,2,t.dataSource.records$))&&a.length))}}function Ki(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.startStreaming())}),e.TgZ(1,"mat-icon"),e._uU(2,"play_arrow"),e.qZA(),e._uU(3," Start streaming "),e.qZA()}}function ea(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.stopStreaming())}),e.TgZ(1,"mat-icon"),e._uU(2,"pause"),e.qZA(),e._uU(3," Stop streaming "),e.qZA()}}const Ze=function(n){return["/commanding/send",n]},ve=function(n,o){return{c:n,template:o}};function ta(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"br")(2,"mat-divider")(3,"br"),e.TgZ(4,"button",18),e._uU(5," Resend "),e.qZA(),e.BQk()),2&n){const t=e.oxw().ngIf,i=e.oxw();e.xp6(4),e.Q6J("routerLink",e.VKq(2,Ze,null==t?null:t.commandName))("queryParams",e.WLB(4,ve,i.yamcs.context,null==t?null:t.id))}}function na(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"ya-detail-toolbar"),e._uU(2," Command Detail "),e.qZA(),e.TgZ(3,"div",15),e._UZ(4,"app-command-detail2",16),e.YNc(5,ta,6,7,"ng-container",17),e.TgZ(6,"p"),e._uU(7,"\xa0"),e.qZA()(),e.BQk()),2&n){const t=o.ngIf,i=e.oxw();e.xp6(4),e.Q6J("command",t),e.xp6(1),e.Q6J("ngIf",i.showResend())}}function ia(n,o){1&n&&(e.TgZ(0,"ya-detail-toolbar"),e._uU(1," Select a command "),e.qZA())}function aa(n,o){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"ya-date-time-input",64)(2,"ya-date-time-input",65),e.TgZ(3,"button",63),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.applyCustomDates())}),e._uU(4,"Apply"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("disabled",t.filterForm.invalid)}}function oa(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",66),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.jumpToNow())}),e._uU(2," Jump to now "),e.qZA(),e.BQk()}}function ca(n,o){1&n&&e._UZ(0,"ya-dots")}function sa(n,o){1&n&&(e.TgZ(0,"div",67),e._uU(1," Listening for commands "),e._UZ(2,"ya-dots",68),e.qZA())}function ra(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1," Showing entries from "),e.TgZ(2,"b"),e._uU(3,"the last hour"),e.qZA(),e._uU(4," ending at "),e.TgZ(5,"b"),e._uU(6),e.ALo(7,"datetime"),e.qZA(),e._uU(8," (Mission Time) "),e.qZA()),2&n){const t=e.oxw(2);e.xp6(6),e.Oqu(e.lcZ(7,1,t.validStop))}}function la(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1," Showing entries from "),e.TgZ(2,"b"),e._uU(3,"the last 6 hours"),e.qZA(),e._uU(4," ending at "),e.TgZ(5,"b"),e._uU(6),e.ALo(7,"datetime"),e.qZA(),e._uU(8," (Mission Time) "),e.qZA()),2&n){const t=e.oxw(2);e.xp6(6),e.Oqu(e.lcZ(7,1,t.validStop))}}function ma(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1," Showing entries from "),e.TgZ(2,"b"),e._uU(3,"the last 24 hours"),e.qZA(),e._uU(4," ending at "),e.TgZ(5,"b"),e._uU(6),e.ALo(7,"datetime"),e.qZA(),e._uU(8," (Mission Time) "),e.qZA()),2&n){const t=e.oxw(2);e.xp6(6),e.Oqu(e.lcZ(7,1,t.validStop))}}function ua(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1," Showing entries from "),e.TgZ(2,"b"),e._uU(3,"all time"),e.qZA()())}function da(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1," Showing entries from "),e.TgZ(2,"b"),e._uU(3),e.ALo(4,"datetime"),e.qZA(),e._uU(5," to "),e.TgZ(6,"b"),e._uU(7),e.ALo(8,"datetime"),e.qZA(),e._uU(9," (Mission Time) "),e.qZA()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(e.lcZ(4,2,t.validStart)),e.xp6(4),e.Oqu(e.lcZ(8,4,t.validStop))}}function pa(n,o){1&n&&(e.TgZ(0,"th",69),e._uU(1,"ID"),e.qZA())}const _a=function(n){return["/commanding/history",n]},ga=function(n){return{c:n}};function fa(n,o){if(1&n&&(e.TgZ(0,"td",70)(1,"a",71),e._uU(2),e.qZA()()),2&n){const t=o.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("routerLink",e.VKq(3,_a,t.id))("queryParams",e.VKq(5,ga,i.yamcs.context)),e.xp6(1),e.Oqu(t.id)}}function ha(n,o){1&n&&(e.TgZ(0,"th",69),e._uU(1,"Time"),e.qZA())}function xa(n,o){if(1&n&&(e.TgZ(0,"td",70),e._uU(1),e.ALo(2,"datetime"),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.generationTime)," ")}}function ya(n,o){1&n&&(e.TgZ(0,"th",72)(1,"mat-icon",73),e._uU(2,"comment"),e.qZA()())}function Ta(n,o){if(1&n&&(e.TgZ(0,"mat-icon",76),e._uU(1,"comment"),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("matTooltip",t.comment)}}function Ca(n,o){1&n&&(e.ynx(0),e._uU(1,"-"),e.BQk())}function ba(n,o){if(1&n&&(e.TgZ(0,"td",74),e.YNc(1,Ta,2,1,"mat-icon",75),e.YNc(2,Ca,2,0,"ng-container",17),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",t.comment),e.xp6(1),e.Q6J("ngIf",!t.comment)}}function Za(n,o){1&n&&(e.TgZ(0,"th",69),e._uU(1,"Command"),e.qZA())}function va(n,o){if(1&n&&(e.TgZ(0,"td",70),e._UZ(1,"ya-highlight",77),e.qZA()),2&n){const t=o.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("text",t.commandName)("term",i.filterForm.value.filter)}}function Aa(n,o){if(1&n&&(e.TgZ(0,"th",69),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.label," ")}}function ka(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"ya-highlight",77),e.BQk()),2&n){const t=o.ngIf,i=e.oxw(4);e.xp6(1),e.Q6J("text",t)("term",i.filterForm.value.filter)}}function wa(n,o){if(1&n&&(e.TgZ(0,"td",70),e.YNc(1,ka,2,2,"ng-container",7),e.ALo(2,"alias"),e.qZA()),2&n){const t=o.$implicit,i=e.oxw().$implicit;e.oxw(2);const a=e.MAs(25);e.xp6(1),e.Q6J("ngIf",e.xi3(2,2,t,i.id))("ngIfElse",a)}}function Sa(n,o){1&n&&(e.ynx(0,78),e.YNc(1,Aa,2,1,"th",34),e.YNc(2,wa,3,5,"td",35),e.BQk()),2&n&&e.Q6J("matColumnDef",o.$implicit.id)}function Na(n,o){1&n&&(e.TgZ(0,"th",69),e._uU(1,"Issuer"),e.qZA())}function Pa(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("@",t.origin,"")}}function Ua(n,o){if(1&n&&(e.TgZ(0,"td",70),e._uU(1),e.YNc(2,Pa,2,1,"span",17),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.username,""),e.xp6(1),e.Q6J("ngIf",t.origin)}}function Qa(n,o){1&n&&(e.TgZ(0,"th",69),e._uU(1,"Queue"),e.qZA())}function qa(n,o){if(1&n&&(e.TgZ(0,"td",70),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.queue||"-"," ")}}function Oa(n,o){1&n&&(e.TgZ(0,"th",69),e._uU(1,"Sequence number"),e.qZA())}function Ia(n,o){if(1&n&&(e.TgZ(0,"td",70),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.sequenceNumber," ")}}function Ja(n,o){1&n&&(e.TgZ(0,"th",79),e._uU(1,"Q "),e.qZA())}function Da(n,o){if(1&n&&(e.TgZ(0,"td",80)(1,"div",81),e._UZ(2,"app-acknowledgment-icon",82),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Q6J("ack",t.queued)}}function Ma(n,o){1&n&&(e.TgZ(0,"th",83),e._uU(1," R "),e.qZA())}function Ya(n,o){if(1&n&&e._UZ(0,"app-transmission-constraints-icon",16),2&n){const t=e.oxw().$implicit;e.Q6J("command",t)}}function Fa(n,o){if(1&n&&e._UZ(0,"app-acknowledgment-icon",82),2&n){const t=e.oxw().$implicit;e.Q6J("ack",t.released)}}function $a(n,o){if(1&n&&(e.TgZ(0,"td",80)(1,"div",81),e.YNc(2,Ya,1,1,"app-transmission-constraints-icon",84),e.YNc(3,Fa,1,1,"app-acknowledgment-icon",85),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Q6J("ngIf",!t.released),e.xp6(1),e.Q6J("ngIf",t.released)}}function La(n,o){1&n&&(e.TgZ(0,"th",86),e._uU(1,"S "),e.qZA())}function Ea(n,o){if(1&n&&(e.TgZ(0,"td",80)(1,"div",81),e._UZ(2,"app-acknowledgment-icon",82),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Q6J("ack",t.sent)}}function Ha(n,o){1&n&&(e.TgZ(0,"th",87),e._uU(1,"Acks"),e.qZA())}function Ba(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"app-acknowledgment-icon",82),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ack",t)}}function Ra(n,o){1&n&&(e.ynx(0),e._uU(1,"-"),e.BQk())}function Va(n,o){if(1&n&&(e.TgZ(0,"td",88)(1,"div",81),e.YNc(2,Ba,2,1,"ng-container",89),e.qZA(),e.YNc(3,Ra,2,0,"ng-container",17),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Q6J("ngForOf",t.extraAcks),e.xp6(1),e.Q6J("ngIf",!t.extraAcks.length)}}function ja(n,o){1&n&&(e.TgZ(0,"th",90),e._uU(1,"Completion"),e.qZA())}function Ga(n,o){1&n&&(e.ynx(0),e._uU(1,"SUCCESS"),e.BQk())}function Wa(n,o){if(1&n&&(e.TgZ(0,"span",93),e._uU(1," FAILURE "),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("matTooltip",null==t.completed?null:t.completed.message)}}function Xa(n,o){1&n&&(e.ynx(0),e._uU(1,"-"),e.BQk())}function za(n,o){if(1&n&&(e.TgZ(0,"td",91),e.YNc(1,Ga,2,0,"ng-container",17),e.YNc(2,Wa,2,1,"span",92),e.YNc(3,Xa,2,0,"ng-container",17),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf","OK"===(null==t.completed?null:t.completed.status)),e.xp6(1),e.Q6J("ngIf","NOK"===(null==t.completed?null:t.completed.status)),e.xp6(1),e.Q6J("ngIf",!t.completed)}}function Ka(n,o){1&n&&e._UZ(0,"th",94)}function eo(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"button",95),e._uU(2," Resend "),e.qZA(),e._UZ(3,"mat-divider"),e.BQk()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("routerLink",e.VKq(2,Ze,t.commandName))("queryParams",e.WLB(4,ve,i.yamcs.context,t.id))}}function to(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"mat-divider"),e.TgZ(2,"ya-download-menu-item",96),e.ALo(3,"commandDownloadLink"),e._uU(4," Download "),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("link",e.lcZ(3,1,t))}}function no(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",70)(1,"ya-more"),e.YNc(2,eo,4,7,"ng-container",17),e.TgZ(3,"button",2),e.NdJ("click",function(){const c=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.copyHex(c))}),e._uU(4," Copy Hex "),e.qZA(),e.TgZ(5,"button",2),e.NdJ("click",function(){const c=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.copyBinary(c))}),e._uU(6," Copy Binary "),e.qZA(),e.YNc(7,to,5,3,"ng-container",17),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.showResend()),e.xp6(5),e.Q6J("ngIf",t.showCommandExports())}}function io(n,o){1&n&&e._UZ(0,"tr",97)}function ao(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr",98),e.NdJ("click",function(){const c=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.selectRecord(c))}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=o.$implicit,i=e.oxw(2);e.ekj("selected",e.lcZ(1,7,i.selectedRecord$)===t)("success","OK"===(null==t.completed?null:t.completed.status))("failed","NOK"===(null==t.completed?null:t.completed.status)),e.Q6J("@rowAnimation",t.animate)}}function oo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",19)(1,"form",20)(2,"div",21),e._UZ(3,"ya-search-filter",22)(4,"ya-column-chooser",23,24),e.qZA(),e.TgZ(6,"div",21),e._UZ(7,"ya-select",25)(8,"ya-select",26,27),e.YNc(10,aa,5,1,"ng-container",17),e.YNc(11,oa,3,0,"ng-container",17),e.YNc(12,ca,1,0,"ya-dots",17),e.ALo(13,"async"),e.YNc(14,sa,3,0,"div",28),e.ALo(15,"async"),e.qZA()(),e.TgZ(16,"div",29),e._UZ(17,"div",30),e.YNc(18,ra,9,3,"span",31),e.YNc(19,la,9,3,"span",31),e.YNc(20,ma,9,3,"span",31),e.YNc(21,ua,4,0,"span",31),e.YNc(22,da,10,6,"span",31),e.qZA(),e.TgZ(23,"table",32),e.ynx(24,33),e.YNc(25,pa,2,0,"th",34),e.YNc(26,fa,3,7,"td",35),e.BQk(),e.ynx(27,36),e.YNc(28,ha,2,0,"th",34),e.YNc(29,xa,3,3,"td",35),e.BQk(),e.ynx(30,37),e.YNc(31,ya,3,0,"th",38),e.YNc(32,ba,3,2,"td",39),e.BQk(),e.ynx(33,40),e.YNc(34,Za,2,0,"th",34),e.YNc(35,va,2,2,"td",35),e.BQk(),e.YNc(36,Sa,3,1,"ng-container",41),e.ALo(37,"async"),e.ynx(38,42),e.YNc(39,Na,2,0,"th",34),e.YNc(40,Ua,3,2,"td",35),e.BQk(),e.ynx(41,43),e.YNc(42,Qa,2,0,"th",34),e.YNc(43,qa,2,1,"td",35),e.BQk(),e.ynx(44,44),e.YNc(45,Oa,2,0,"th",34),e.YNc(46,Ia,2,1,"td",35),e.BQk(),e.ynx(47,45),e.YNc(48,Ja,2,0,"th",46),e.YNc(49,Da,3,1,"td",47),e.BQk(),e.ynx(50,48),e.YNc(51,Ma,2,0,"th",49),e.YNc(52,$a,4,2,"td",47),e.BQk(),e.ynx(53,50),e.YNc(54,La,2,0,"th",51),e.YNc(55,Ea,3,1,"td",47),e.BQk(),e.ynx(56,52),e.YNc(57,Ha,2,0,"th",53),e.YNc(58,Va,4,2,"td",54),e.BQk(),e.ynx(59,55),e.YNc(60,ja,2,0,"th",56),e.YNc(61,za,4,3,"td",57),e.BQk(),e.ynx(62,58),e.YNc(63,Ka,1,0,"th",59),e.YNc(64,no,8,2,"td",35),e.BQk(),e.YNc(65,io,1,0,"tr",60),e.ALo(66,"async"),e.YNc(67,ao,2,9,"tr",61),e.ALo(68,"async"),e.qZA(),e.TgZ(69,"mat-toolbar"),e._UZ(70,"span",62),e.TgZ(71,"button",63),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.loadMoreData())}),e._uU(72,"Load More"),e.qZA(),e._UZ(73,"span",62),e.qZA()()}if(2&n){const t=e.MAs(5),i=e.oxw();e.xp6(1),e.Q6J("formGroup",i.filterForm),e.xp6(3),e.Q6J("columns",i.columns),e.xp6(3),e.Q6J("options",i.queueOptions),e.xp6(1),e.Q6J("options",i.intervalOptions),e.xp6(2),e.Q6J("ngIf","CUSTOM"===i.filterForm.value.interval),e.xp6(1),e.Q6J("ngIf","CUSTOM"!==i.filterForm.value.interval),e.xp6(1),e.Q6J("ngIf",e.lcZ(13,19,i.dataSource.loading$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(15,21,i.dataSource.streaming$)),e.xp6(2),e.Q6J("ngSwitch",i.appliedInterval),e.xp6(2),e.Q6J("ngSwitchCase","PT1H"),e.xp6(1),e.Q6J("ngSwitchCase","PT6H"),e.xp6(1),e.Q6J("ngSwitchCase","P1D"),e.xp6(1),e.Q6J("ngSwitchCase","NO_LIMIT"),e.xp6(1),e.Q6J("ngSwitchCase","CUSTOM"),e.xp6(1),e.Q6J("dataSource",i.dataSource),e.xp6(13),e.Q6J("ngForOf",e.lcZ(37,23,i.aliasColumns$)),e.xp6(29),e.Q6J("matHeaderRowDef",e.lcZ(66,25,t.displayedColumns$)),e.xp6(2),e.Q6J("matRowDefColumns",e.lcZ(68,27,t.displayedColumns$)),e.xp6(4),e.Q6J("disabled",!i.dataSource.hasMore())}}function co(n,o){1&n&&e._uU(0," -\n")}const H="PT1H";let Ae=(()=>{class n{constructor(t,i,a,c,s,m,d,_,y,f){this.yamcs=t,this.messageService=c,this.router=s,this.route=m,this.printService=d,this.clipboard=f,this.selectedRecord$=new C.X(null),this.filterForm=new l.nJ({filter:new l.p4,queue:new l.p4("ANY"),interval:new l.p4(H),customStart:new l.p4(null),customStop:new l.p4(null)}),this.columns=[{id:"commandId",label:"ID",alwaysVisible:!0},{id:"generationTime",label:"Time",alwaysVisible:!0},{id:"comment",label:"Comment",visible:!0},{id:"command",label:"Command",alwaysVisible:!0},{id:"issuer",label:"Issuer"},{id:"queue",label:"Queue"},{id:"queued",label:"Queued",visible:!0},{id:"released",label:"Released",visible:!0},{id:"sent",label:"Sent",visible:!0},{id:"acknowledgments",label:"Extra acknowledgments",visible:!0},{id:"completion",label:"Completion",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],this.aliasColumns$=new C.X([]),this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.subscriptions=[],this.config=i.getConfig(),this.user=a.getUser(),_.setTitle("Command History"),this.dataSource=new oi(this.yamcs,y),this.queueOptions=[{id:"ANY",label:"Any queue"}];for(const h of this.config.queueNames)this.queueOptions.push({id:h,label:h});this.initializeOptions(),this.loadData(),this.filterForm.get("filter").valueChanges.pipe((0,ii.b)(400)).forEach(h=>{this.filter=h,this.loadData()}),this.filterForm.get("queue").valueChanges.forEach(h=>{this.queue="ANY"!==h?h:null,this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(h=>{if("CUSTOM"===h){const b=this.validStart||this.yamcs.getMissionTime(),Z=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(r.P6.toISOString(b)),this.filterForm.get("customStop").setValue(r.P6.toISOString(Z))}else"NO_LIMIT"===h?(this.validStart=null,this.validStop=null,this.appliedInterval=h,this.loadData()):(this.validStop=t.getMissionTime(),this.validStart=r.P6.subtractDuration(this.validStop,h),this.appliedInterval=h,this.loadData())})}ngAfterViewInit(){this.subscriptions.push(this.dataSource.namespaces$.subscribe(t=>{for(const c of this.aliasColumns$.value){const s=this.columns.indexOf(c);-1!==s&&this.columns.splice(s,1)}const i=[];for(const c of t)i.push({id:c,label:c,alwaysVisible:!0});const a=this.columns.findIndex(c=>"command"===c.id);this.columns.splice(a+1,0,...i),this.aliasColumns$.next(i),this.columnChooser.recalculate(this.columns)}))}initializeOptions(){const t=this.route.snapshot.queryParamMap;if(t.has("filter")&&(this.filter=t.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),t.has("queue")&&(this.queue=t.get("queue"),this.filterForm.get("queue").setValue(this.queue)),t.has("interval"))if(this.appliedInterval=t.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const i=t.get("customStart");this.filterForm.get("customStart").setValue(i),this.validStart=new Date(i);const a=t.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=new Date(a)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=r.P6.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=H,this.validStop=this.yamcs.getMissionTime(),this.validStart=r.P6.subtractDuration(this.validStop,H)}jumpToNow(){const t=this.filterForm.value.interval;"NO_LIMIT"===t||"CUSTOM"===t?this.filterForm.get("interval").setValue(H):(this.validStop=this.yamcs.getMissionTime(),this.validStart=r.P6.subtractDuration(this.validStop,t),this.loadData())}startStreaming(){this.filterForm.get("interval").setValue("NO_LIMIT"),this.dataSource.startStreaming()}stopStreaming(){this.dataSource.stopStreaming()}applyCustomDates(){this.validStart=r.P6.toDate(this.filterForm.value.customStart),this.validStop=r.P6.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const t={};this.validStart&&(t.start=this.validStart.toISOString()),this.validStop&&(t.stop=this.validStop.toISOString()),this.filter&&(t.q=this.filter),this.queue&&(t.queue=this.queue),this.dataSource.loadEntries(t).catch(i=>this.messageService.showError(i))}loadMoreData(){const t={};this.validStart&&(t.start=this.validStart.toISOString()),this.filter&&(t.q=this.filter),this.queue&&(t.queue=this.queue),this.dataSource.loadMoreData(t).catch(i=>this.messageService.showError(i))}showResend(){return this.config.tc&&this.user.hasAnyObjectPrivilegeOfType("Command")}showCommandExports(){return this.config.commandExports}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filter||null,queue:this.queue||null,interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}copyHex(t){const i=r.P6.convertBase64ToHex(t.binary);this.clipboard.copy(i)}copyBinary(t){const i=window.atob(t.binary);this.clipboard.copy(i)}selectRecord(t){this.selectedRecord$.next(t)}printReport(){const t=this.dataSource.records$.value.slice().reverse();this.printService.printComponent(Wi,"Command Report",t)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.C8),e.Y36(r.E4),e.Y36(Y.e),e.Y36(r.ez),e.Y36(T.F0),e.Y36(T.gz),e.Y36(r.$b),e.Y36(Q.Dx),e.Y36(r.jF),e.Y36(xe.TU))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(i,a){if(1&i&&(e.Gf(Xi,5),e.Gf(r.b8,5)),2&i){let c;e.iGM(c=e.CRH())&&(a.intervalSelect=c.first),e.iGM(c=e.CRH())&&(a.columnChooser=c.first)}},decls:26,vars:12,consts:[[1,"ya-menu"],["exportMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-button","","color","primary",3,"matMenuTriggerFor","disabled",4,"ngIf"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","matTooltip","Pause streaming events","color","primary",3,"click",4,"ngIf"],["mat-button","","matTooltip","Jump to now","color","primary",3,"click"],[4,"ngIf","ngIfElse"],["noSelection",""],[1,"table-wrapper"],["class","panel-content",4,"ngIf"],["dash",""],["mat-button","","color","primary",3,"matMenuTriggerFor","disabled"],["mat-button","","color","primary",3,"click"],["mat-button","","matTooltip","Pause streaming events","color","primary",3,"click"],[2,"padding","0 16px"],[3,"command"],[4,"ngIf"],[1,"ya-button",3,"routerLink","queryParams"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","filter","placeholder","Filter by text search"],["preferenceKey","cmdhist",3,"columns"],["columnChooser",""],["formControlName","queue",3,"options"],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],["style","text-align: right; flex: 1 1 150px",4,"ngIf"],[1,"table-status",3,"ngSwitch"],[1,"message-zone"],[4,"ngSwitchCase"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","commandId"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","comment"],["mat-header-cell","","class","iconcol",4,"matHeaderCellDef"],["mat-cell","","class","iconcol",4,"matCellDef"],["matColumnDef","command"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","issuer"],["matColumnDef","queue"],["matColumnDef","sequenceNumber"],["matColumnDef","queued"],["mat-header-cell","","class","iconcol dense","style","text-align: center","matTooltip","Command queued",4,"matHeaderCellDef"],["mat-cell","","class","iconcol dense","style","text-align: center",4,"matCellDef"],["matColumnDef","released"],["mat-header-cell","","class","iconcol dense","style","text-align: center","matTooltip","Command released",4,"matHeaderCellDef"],["matColumnDef","sent"],["mat-header-cell","","class","iconcol dense","style","text-align: center","matTooltip","Command sent",4,"matHeaderCellDef"],["matColumnDef","acknowledgments"],["mat-header-cell","","class","dense",4,"matHeaderCellDef"],["mat-cell","","class","dense",4,"matCellDef"],["matColumnDef","completion"],["mat-header-cell","","style","padding-left: 8px",4,"matHeaderCellDef"],["mat-cell","","class","completion","style","text-align: center; padding-left: 8px",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","success","failed","click",4,"matRowDef","matRowDefColumns"],[2,"flex","1 1 auto"],[1,"ya-button",3,"disabled","click"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"click"],[2,"text-align","right","flex","1 1 150px"],["fontSize","16px","color","#1b61b9"],["mat-header-cell",""],["mat-cell",""],[3,"routerLink","queryParams"],["mat-header-cell","",1,"iconcol"],["matTooltip","Comment",1,"icon16"],["mat-cell","",1,"iconcol"],["class","icon16",3,"matTooltip",4,"ngIf"],[1,"icon16",3,"matTooltip"],[3,"text","term"],[3,"matColumnDef"],["mat-header-cell","","matTooltip","Command queued",1,"iconcol","dense",2,"text-align","center"],["mat-cell","",1,"iconcol","dense",2,"text-align","center"],[2,"display","flex","align-items","center"],[3,"ack"],["mat-header-cell","","matTooltip","Command released",1,"iconcol","dense",2,"text-align","center"],[3,"command",4,"ngIf"],[3,"ack",4,"ngIf"],["mat-header-cell","","matTooltip","Command sent",1,"iconcol","dense",2,"text-align","center"],["mat-header-cell","",1,"dense"],["mat-cell","",1,"dense"],[4,"ngFor","ngForOf"],["mat-header-cell","",2,"padding-left","8px"],["mat-cell","",1,"completion",2,"text-align","center","padding-left","8px"],[3,"matTooltip",4,"ngIf"],[3,"matTooltip"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"routerLink","queryParams"],[3,"link"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(i,a){if(1&i&&(e.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),e._uU(2," Command History \xa0\xa0\xa0 "),e.TgZ(3,"mat-menu",0,1)(5,"button",2),e.NdJ("click",function(){return a.printReport()}),e.TgZ(6,"mat-icon"),e._uU(7,"print"),e.qZA(),e._uU(8," Print report "),e.qZA()(),e.YNc(9,zi,5,4,"button",3),e.YNc(10,Ki,4,0,"button",4),e.ALo(11,"async"),e.YNc(12,ea,4,0,"button",5),e.ALo(13,"async"),e.TgZ(14,"button",6),e.NdJ("click",function(){return a.jumpToNow()}),e.TgZ(15,"mat-icon"),e._uU(16,"refresh"),e.qZA()()(),e.TgZ(17,"ya-detail-pane"),e.YNc(18,na,8,2,"ng-container",7),e.ALo(19,"async"),e.YNc(20,ia,2,0,"ng-template",null,8,e.W1O),e.qZA(),e.TgZ(22,"div",9),e.YNc(23,oo,74,29,"div",10),e.qZA()(),e.YNc(24,co,1,0,"ng-template",null,11,e.W1O)),2&i){const c=e.MAs(21);e.xp6(9),e.Q6J("ngIf",a.showCommandExports()),e.xp6(1),e.Q6J("ngIf",!e.lcZ(11,6,a.dataSource.streaming$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(13,8,a.dataSource.streaming$)),e.xp6(6),e.Q6J("ngIf",e.lcZ(19,10,a.selectedRecord$))("ngIfElse",c),e.xp6(5),e.Q6J("ngIf",a.dataSource)}},dependencies:[u.sg,u.O5,u.RF,u.n9,l._Y,l.JJ,l.JL,l.sg,l.u,T.rH,O.lW,S.Hw,D.d,w.VK,w.OP,w.p6,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,I.Ye,U.gM,r.b8,r.t,r.J8,r.MD,r.Zy,r.U9,r.oQ,r.cQ,r.cF,r.Hr,N.a,P.k,ce,V,Te,u.Ov,r.p3,r.id,be],styles:[".table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.table-status[_ngcontent-%COMP%]{background-color:#f7f7f7;height:24px;line-height:24px;font-size:12px;padding-left:6px}.table-status[_ngcontent-%COMP%]   .message-zone[_ngcontent-%COMP%]{float:right;height:24px;line-height:24px;font-size:12px;padding-right:6px}.mat-mdc-row[_ngcontent-%COMP%]{cursor:pointer}tr.failed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], tr.failed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:red}tr.success[_ngcontent-%COMP%]   td.completion[_ngcontent-%COMP%]{background-color:#e6ffed;color:#00c752}tr.failed[_ngcontent-%COMP%]   td.completion[_ngcontent-%COMP%]{background-color:#ffeef0;color:red}th.dense[_ngcontent-%COMP%], td.dense[_ngcontent-%COMP%]{width:1px;white-space:nowrap;padding-left:12px;padding-right:12px}"],data:{animation:[r.q5]},changeDetection:0})}return n})();const so=function(n){return{c:n}};function ro(n,o){if(1&n&&(e.TgZ(0,"app-instance-page")(1,"app-instance-toolbar")(2,"a",1)(3,"mat-icon"),e._uU(4,"arrow_back"),e.qZA()(),e._uU(5),e.qZA(),e.TgZ(6,"div",2),e._UZ(7,"app-command-detail2",3),e.qZA()()),2&n){const t=o.ngIf,i=e.oxw();e.xp6(2),e.Q6J("queryParams",e.VKq(3,so,i.yamcs.context)),e.xp6(3),e.hij(" Command History / ",t.id," "),e.xp6(2),e.Q6J("command",t)}}let ke=(()=>{class n{constructor(t,i){this.yamcs=i,this.command$=new C.X(null);const a=t.snapshot.paramMap.get("commandId");i.yamcsClient.getCommandHistoryEntry(i.instance,a).then(c=>{this.mergeEntry(c),this.commandSubscription=i.yamcsClient.createCommandSubscription({instance:i.instance,processor:i.processor,ignorePastCommands:!1},s=>{s.id===a&&this.mergeEntry(s)})})}mergeEntry(t){const i=this.command$.value;if(i){const a=i.mergeEntry(t);this.command$.next(a)}else this.command$.next(new r.mq(t))}ngOnDestroy(){this.commandSubscription?.cancel()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(T.gz),e.Y36(r.C8))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-icon-button","","routerLink","..","color","primary",3,"queryParams"],[1,"panel-content"],[3,"command"]],template:function(i,a){1&i&&(e.YNc(0,ro,8,5,"app-instance-page",0),e.ALo(1,"async")),2&i&&e.Q6J("ngIf",e.lcZ(1,1,a.command$))},dependencies:[u.O5,T.rH,O.o6,S.Hw,N.a,P.k,V,u.Ov],encapsulation:2,changeDetection:0})}return n})(),se=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-send-command-wizard-step"]],inputs:{step:"step"},decls:11,vars:6,consts:[[1,"sub"]],template:function(i,a){1&i&&(e.TgZ(0,"mat-toolbar",0)(1,"mat-toolbar-row")(2,"span")(3,"span"),e._uU(4,"1. Select command"),e.qZA(),e._uU(5," \xa0\xa0\xa0\xa0\xa0\xa0\xa0 "),e.TgZ(6,"span"),e._uU(7,"2. Configure command"),e.qZA(),e._uU(8," \xa0\xa0\xa0\xa0\xa0\xa0\xa0 "),e.TgZ(9,"span"),e._uU(10,"3. View report"),e.qZA()()()()),2&i&&(e.xp6(3),e.ekj("active",1==a.step),e.xp6(3),e.ekj("active",2==a.step),e.xp6(3),e.ekj("active",3==a.step))},dependencies:[I.Ye,I.rD],styles:["span[_ngcontent-%COMP%]{cursor:default}span[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.3}span[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{opacity:1}mat-toolbar.sub[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;background-color:#fff;font-size:12px}.mat-toolbar-row[_ngcontent-%COMP%]{height:32px;padding:0 24px}.mat-toolbar-multiple-rows[_ngcontent-%COMP%]{min-height:32px}"],changeDetection:0})}return n})();const lo=function(n){return{c:n}},mo=function(n){return["/commanding/send",n]},uo=function(n,o){return{c:n,template:o}};function po(n,o){if(1&n&&(e.TgZ(0,"div",2),e._UZ(1,"app-command-detail2",3),e.ynx(2),e._UZ(3,"br")(4,"mat-divider")(5,"br"),e.TgZ(6,"button",4),e._uU(7," Send another command "),e.qZA(),e._uU(8," \xa0\xa0 "),e.TgZ(9,"button",5),e._uU(10," Resend this command "),e.qZA(),e.BQk(),e.qZA()),2&n){const t=o.ngIf,i=e.oxw();e.xp6(1),e.Q6J("command",t),e.xp6(5),e.Q6J("queryParams",e.VKq(4,lo,i.yamcs.context)),e.xp6(3),e.Q6J("routerLink",e.VKq(6,mo,t.commandName))("queryParams",e.WLB(8,uo,i.yamcs.context,t.id))}}let we=(()=>{class n{constructor(t,i){this.yamcs=i,this.command$=new C.X(null);const a=t.snapshot.paramMap.get("commandId");this.commandSubscription=i.yamcsClient.createCommandSubscription({instance:i.instance,processor:i.processor,ignorePastCommands:!1},c=>{c.id===a&&this.mergeEntry(c,!1)}),this.commandSubscription.addReplyListener(()=>{i.yamcsClient.getCommandHistoryEntry(this.yamcs.instance,a).then(c=>{this.mergeEntry(c,!0)})})}mergeEntry(t,i){const a=this.command$.value;if(a){const c=a.mergeEntry(t,i);this.command$.next(c)}else this.command$.next(new r.mq(t))}ngOnDestroy(){this.commandSubscription?.cancel()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(T.gz),e.Y36(r.C8))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:6,vars:3,consts:[["step","3"],["class","panel-content",4,"ngIf"],[1,"panel-content"],[3,"command"],["routerLink","/commanding/send",1,"ya-button",3,"queryParams"],[1,"ya-button",3,"routerLink","queryParams"]],template:function(i,a){1&i&&(e.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),e._uU(2," Send a command "),e.qZA(),e._UZ(3,"app-send-command-wizard-step",0),e.YNc(4,po,11,11,"div",1),e.ALo(5,"async"),e.qZA()),2&i&&(e.xp6(4),e.Q6J("ngIf",e.lcZ(5,1,a.command$)))},dependencies:[u.O5,T.rH,D.d,N.a,P.k,V,se,u.Ov],encapsulation:2,changeDetection:0})}return n})();var _o=g(2599),Se=g(998),Ne=g(2842);const go=["commandForm"];function fo(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"dt"),e._uU(2),e.qZA(),e.TgZ(3,"dd"),e._uU(4),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.namespace),e.xp6(2),e.Oqu(t.name)}}function ho(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"dt"),e._uU(2,"Description"),e.qZA(),e.TgZ(3,"dd"),e._UZ(4,"app-markdown",14),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).ngIf;e.xp6(4),e.Q6J("text",t.longDescription)}}function xo(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"dt"),e._uU(2,"Description"),e.qZA(),e.TgZ(3,"dd"),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).ngIf;e.xp6(4),e.hij(" ",t.shortDescription||"-"," ")}}function yo(n,o){if(1&n&&(e.ynx(0),e.YNc(1,ho,5,1,"ng-container",3),e.YNc(2,xo,5,1,"ng-container",3),e.BQk()),2&n){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngIf",t.longDescription),e.xp6(1),e.Q6J("ngIf",!t.longDescription)}}function To(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"app-significance-level",15),e._uU(2),e.BQk()),2&n){const t=o.ngIf;e.xp6(1),e.Q6J("level",t.consequenceLevel),e.xp6(1),e.hij(" \xa0\xa0",t.reasonForWarning," ")}}function Co(n,o){if(1&n&&(e.TgZ(0,"dl",11)(1,"dt"),e._uU(2,"Command"),e.qZA(),e.TgZ(3,"dd"),e._uU(4),e.ALo(5,"shortName"),e.qZA(),e.TgZ(6,"dt"),e._uU(7,"Space system"),e.qZA(),e.TgZ(8,"dd"),e._uU(9),e.ALo(10,"spaceSystemName"),e.qZA(),e.YNc(11,fo,5,2,"ng-container",12),e.YNc(12,yo,3,2,"ng-container",3),e.TgZ(13,"dt"),e._uU(14,"Significance"),e.qZA(),e.TgZ(15,"dd"),e.YNc(16,To,3,2,"ng-container",13),e.qZA()()),2&n){const t=o.ngIf;e.oxw();const i=e.MAs(31);e.xp6(4),e.Oqu(e.lcZ(5,6,t.qualifiedName)),e.xp6(5),e.Oqu(e.lcZ(10,8,t.qualifiedName)||"-"),e.xp6(2),e.Q6J("ngForOf",t.alias),e.xp6(1),e.Q6J("ngIf",t.longDescription||t.shortDescription),e.xp6(4),e.Q6J("ngIf",null==t?null:t.effectiveSignificance)("ngIfElse",i)}}function bo(n,o){1&n&&(e.TgZ(0,"ya-warning-message"),e._uU(1," You're not cleared to send this command "),e.qZA())}function Zo(n,o){1&n&&(e.TgZ(0,"span",21),e._uU(1," satisfied "),e.qZA())}function vo(n,o){1&n&&(e.TgZ(0,"span",22),e._uU(1," not satisfied "),e.qZA())}function Ao(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e.YNc(6,Zo,2,0,"span",17),e.ALo(7,"async"),e.YNc(8,vo,2,0,"span",18),e.ALo(9,"async"),e._UZ(10,"app-live-expression",19,20),e.qZA()()),2&n){const t=o.$implicit,i=e.MAs(11);e.xp6(2),e.Oqu(t.expression),e.xp6(2),e.Oqu(t.timeout||"-"),e.xp6(2),e.Q6J("ngIf",!0===e.lcZ(7,7,i.result$)),e.xp6(2),e.Q6J("ngIf",!1===e.lcZ(9,9,i.result$)),e.xp6(2),e.Udp("display","none"),e.Q6J("expression",t.expression)}}function ko(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"p"),e._uU(2,"\xa0"),e.qZA(),e.TgZ(3,"h3"),e._uU(4,"Constraints"),e.qZA(),e.TgZ(5,"table",16)(6,"tr")(7,"th"),e._uU(8,"Constraint"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Timeout"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Live Evaluation"),e.qZA()(),e.YNc(13,Ao,12,11,"tr",12),e.qZA(),e.BQk()),2&n){const t=e.oxw().ngIf;e.xp6(13),e.Q6J("ngForOf",t.constraint)}}function wo(n,o){if(1&n&&(e.ynx(0),e.YNc(1,ko,14,1,"ng-container",3),e.BQk()),2&n){const t=o.ngIf;e.xp6(1),e.Q6J("ngIf",t.constraint)}}function So(n,o){1&n&&(e.ynx(0),e.TgZ(1,"p"),e._uU(2,"\xa0"),e.qZA(),e.TgZ(3,"h3"),e._uU(4,"Arguments"),e.qZA(),e.BQk())}function No(n,o){if(1&n&&(e.TgZ(0,"mat-slide-toggle",23),e._uU(1," Arm "),e.qZA()),2&n){const t=e.oxw();e.Q6J("formControl",t.armControl)}}function Po(n,o){1&n&&e._uU(0," -\n")}let Pe=(()=>{class n{constructor(t,i,a,c,s,m,d,_,y){this.router=i,this.messageService=c,this.yamcs=s,this.location=m,this.changeDetection=y,this.command$=new C.X(null),this.templateProvider$=new C.X(null),this.cleared$=new C.X(!0),this.armControl=new l.p4,this.config=d.getConfig();const f=t.snapshot.paramMap.get("qualifiedName");a.setTitle(`Send a command: ${f}`);const h=[this.yamcs.yamcsClient.getCommand(this.yamcs.instance,f)],b=t.snapshot.queryParamMap.get("template");if(b){const Z=this.yamcs.yamcsClient.getCommandHistoryEntry(this.yamcs.instance,b);h.push(Z)}Promise.all(h).then(Z=>{const A=Z[0];let k;Z.length>1&&(k=Z[1]),this.command$.next(A),this.templateProvider$.next(k?new Uo(k):null),this.config.commandClearanceEnabled&&(this.connectionInfoSubscription=s.clearance$.subscribe(B=>{const Nl=A.effectiveSignificance;this.cleared$.next(this.isCleared(B,Nl?.consequenceLevel))}))})}ngAfterViewInit(){this.config.twoStageCommanding&&(this.commandForm.form.valueChanges.subscribe(()=>{this.armControl.setValue(!1)}),this.commandForm.form.statusChanges.subscribe(()=>{this.commandForm.form.valid?this.armControl.enable():this.armControl.disable()})),this.commandForm.hasArguments$.subscribe(t=>{this.changeDetection.detectChanges()})}goBack(){this.location.back()}sendCommand(){this.armControl.setValue(!1);const t=this.commandForm.getAssignments(),i=this.commandForm.getComment(),a=this.commandForm.getExtraOptions();this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,this.command$.value.qualifiedName,{args:t,comment:i,extra:a}).then(s=>{this.router.navigate(["/commanding/report",s.id],{queryParams:{c:this.yamcs.context}})}).catch(s=>{this.messageService.showError(s)})}isCleared(t,i){if(!t)return!1;switch(t.level){case"SEVERE":if("SEVERE"===i)return!0;case"CRITICAL":if("CRITICAL"===i)return!0;case"DISTRESS":if("DISTRESS"===i)return!0;case"WARNING":if("WARNING"===i)return!0;case"WATCH":if("WATCH"===i)return!0;case"NONE":if("NONE"===i||!i)return!0}return!1}ngOnDestroy(){this.connectionInfoSubscription&&this.connectionInfoSubscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(T.gz),e.Y36(T.F0),e.Y36(Q.Dx),e.Y36(r.ez),e.Y36(r.C8),e.Y36(u.Ye),e.Y36(r.E4),e.Y36(Y.e),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(i,a){if(1&i&&e.Gf(go,5),2&i){let c;e.iGM(c=e.CRH())&&(a.commandForm=c.first)}},decls:32,vars:22,consts:[["step","2"],[1,"form-content"],["class","dl-horizontal no-lead no-trail",4,"ngIf"],[4,"ngIf"],[3,"command","templateProvider"],["commandForm",""],[1,"ya-button",3,"click"],[2,"flex","1 1 auto"],["color","primary",3,"formControl",4,"ngIf"],[1,"ya-button","primary",3,"disabled","click"],["dash",""],[1,"dl-horizontal","no-lead","no-trail"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],[3,"text"],[3,"level"],["yaDataTable",""],["class","evaluation valid",4,"ngIf"],["class","evaluation invalid",4,"ngIf"],[3,"expression"],["expr",""],[1,"evaluation","valid"],[1,"evaluation","invalid"],["color","primary",3,"formControl"]],template:function(i,a){if(1&i&&(e.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),e._uU(2," Send a command "),e.qZA(),e._UZ(3,"app-send-command-wizard-step",0),e.TgZ(4,"div",1),e.YNc(5,Co,17,10,"dl",2),e.ALo(6,"async"),e.YNc(7,bo,2,0,"ya-warning-message",3),e.ALo(8,"async"),e.YNc(9,wo,2,1,"ng-container",3),e.ALo(10,"async"),e.YNc(11,So,5,0,"ng-container",3),e.ALo(12,"async"),e._UZ(13,"app-command-form",4,5),e.ALo(15,"async"),e.ALo(16,"async"),e.TgZ(17,"p"),e._uU(18,"\xa0"),e.qZA(),e.TgZ(19,"mat-toolbar")(20,"button",6),e.NdJ("click",function(){return a.goBack()}),e._uU(21," Cancel "),e.qZA(),e._UZ(22,"span",7),e.YNc(23,No,2,1,"mat-slide-toggle",8),e._uU(24," \xa0\xa0\xa0\xa0 "),e.TgZ(25,"button",9),e.NdJ("click",function(){return a.sendCommand()}),e.ALo(26,"async"),e.TgZ(27,"mat-icon"),e._uU(28,"send"),e.qZA(),e._uU(29," Send "),e.qZA()()()(),e.YNc(30,Po,1,0,"ng-template",null,10,e.W1O)),2&i){const c=e.MAs(14);e.xp6(5),e.Q6J("ngIf",e.lcZ(6,8,a.command$)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(8,10,a.cleared$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(10,12,a.command$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(12,14,c.hasArguments$)),e.xp6(2),e.Q6J("command",e.lcZ(15,16,a.command$))("templateProvider",e.lcZ(16,18,a.templateProvider$)),e.xp6(10),e.Q6J("ngIf",a.config.twoStageCommanding),e.xp6(2),e.Q6J("disabled",a.config.twoStageCommanding&&!a.armControl.value||!e.lcZ(26,20,a.cleared$)||!c.form.valid)}},dependencies:[u.sg,u.O5,l.JJ,l.oH,r.Gj,S.Hw,_o.Rr,I.Ye,r.Rl,N.a,P.k,Se.Q,Ne.U,L.U,oe,se,u.Ov,r.yk,r.BC],styles:[".evaluation[_ngcontent-%COMP%]{font-family:Roboto Mono,monospace;background-color:#ffeef0;color:red;padding-left:2px;padding-right:2px}.evaluation.valid[_ngcontent-%COMP%]{background-color:#e6ffed;color:#00c752}"],changeDetection:0})}return n})();class Uo{constructor(o){this.entry=o}getAssignment(o){if(this.entry.assignments)for(const t of this.entry.assignments)if(t.name===o)return t.value}getOption(o,t){for(const i of this.entry.attr||[])if(i.name===o)switch(t){case"BOOLEAN":return this.getBooleanOption(i.value);case"NUMBER":return this.getNumberOption(i.value);case"STRING":return this.getStringOption(i.value)}}getBooleanOption(o){if("BOOLEAN"===o.type)return o}getNumberOption(o){switch(o.type){case"SINT32":case"UINT32":case"SINT64":case"UINT64":return o}}getStringOption(o){if("STRING"===o.type)return o}getComment(){}}var Qo=g(7641);const qo=["top"];function Oo(n,o){if(1&n&&e._UZ(0,"ya-breadcrumb",16),2&n){const t=o.$implicit;e.Q6J("link",t.route)("queryParams",t.queryParams)("label",t.name)}}const Ue=function(n){return{c:n}};function Io(n,o){if(1&n&&(e.TgZ(0,"div",6)(1,"ya-breadcrumb-trail"),e._UZ(2,"ya-breadcrumb",14),e.YNc(3,Oo,1,3,"ya-breadcrumb",15),e.qZA()()),2&n){const t=e.oxw().ngIf,i=e.oxw(2);e.xp6(2),e.Q6J("queryParams",e.VKq(2,Ue,i.yamcs.context)),e.xp6(1),e.Q6J("ngForOf",t)}}function Jo(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Io,4,4,"div",13),e.BQk()),2&n){const t=o.ngIf;e.xp6(1),e.Q6J("ngIf",t.length)}}function Do(n,o){1&n&&(e.TgZ(0,"th",31),e._uU(1,"Significance"),e.qZA())}function Mo(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"app-significance-level",34),e.BQk()),2&n){const t=o.ngIf;e.xp6(1),e.Q6J("level",t.consequenceLevel)}}function Yo(n,o){if(1&n&&(e.TgZ(0,"td",32),e.YNc(1,Mo,2,1,"ng-container",33),e.qZA()),2&n){const t=o.$implicit;e.oxw(3);const i=e.MAs(9);e.xp6(1),e.Q6J("ngIf",null==t.command?null:t.command.effectiveSignificance)("ngIfElse",i)}}function Fo(n,o){1&n&&(e.TgZ(0,"th",31),e._uU(1,"Name"),e.qZA())}const $o=function(){return["/commanding/send"]},Lo=function(n,o){return{c:n,system:o}};function Eo(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-icon",36),e._uU(2,"folder"),e.qZA(),e.TgZ(3,"a",37),e._uU(4),e.ALo(5,"filename"),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(3),e.Q6J("routerLink",e.DdM(5,$o))("queryParams",e.WLB(6,Lo,i.yamcs.context,t.name)),e.xp6(1),e.hij("",e.lcZ(5,3,t.name),"/ ")}}function Ho(n,o){if(1&n&&e._UZ(0,"ya-highlight",39),2&n){const t=e.oxw(2).$implicit,i=e.oxw(3);e.Q6J("text",t.command.qualifiedName)("term",i.filterControl.value)}}function Bo(n,o){if(1&n&&(e._UZ(0,"ya-highlight",39),e.ALo(1,"slice")),2&n){const t=e.oxw(2).$implicit,i=e.oxw(3);e.Q6J("text",e.xi3(1,2,t.command.qualifiedName,i.system.length+1))("term",i.filterControl.value)}}const Ro=function(n){return["/commanding/send",n]};function Vo(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-icon",36),e._uU(2,"rss_feed"),e.qZA(),e.TgZ(3,"a",37),e.YNc(4,Ho,1,2,"ya-highlight",38),e.YNc(5,Bo,2,5,"ya-highlight",38),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(3),e.Q6J("routerLink",e.VKq(4,Ro,t.command.qualifiedName))("queryParams",e.VKq(6,Ue,i.yamcs.context)),e.xp6(1),e.Q6J("ngIf",!i.system),e.xp6(1),e.Q6J("ngIf",i.system)}}function jo(n,o){if(1&n&&(e.TgZ(0,"td",35),e.YNc(1,Eo,6,9,"ng-container",5),e.YNc(2,Vo,6,8,"ng-container",5),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",t.spaceSystem),e.xp6(1),e.Q6J("ngIf",!t.spaceSystem)}}function Go(n,o){1&n&&(e.TgZ(0,"th",31),e._uU(1,"Description"),e.qZA())}function Wo(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"ya-highlight",39),e.BQk()),2&n){const t=o.ngIf,i=e.oxw(4);e.xp6(1),e.Q6J("text",t)("term",i.filterControl.value)}}function Xo(n,o){if(1&n&&(e.TgZ(0,"td",40),e.YNc(1,Wo,2,2,"ng-container",33),e.qZA()),2&n){const t=o.$implicit;e.oxw(3);const i=e.MAs(9);e.xp6(1),e.Q6J("ngIf",null==t.command?null:t.command.shortDescription)("ngIfElse",i)}}function zo(n,o){if(1&n&&(e.TgZ(0,"th",31),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.label," ")}}function Ko(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"ya-highlight",39),e.BQk()),2&n){const t=o.ngIf,i=e.oxw(5);e.xp6(1),e.Q6J("text",t)("term",i.filterControl.value)}}function ec(n,o){if(1&n&&(e.TgZ(0,"td",32),e.YNc(1,Ko,2,2,"ng-container",33),e.ALo(2,"alias"),e.qZA()),2&n){const t=o.$implicit,i=e.oxw().$implicit;e.oxw(3);const a=e.MAs(9);e.xp6(1),e.Q6J("ngIf",e.xi3(2,2,t.command,i.id))("ngIfElse",a)}}function tc(n,o){1&n&&(e.ynx(0,41),e.YNc(1,zo,2,1,"th",19),e.YNc(2,ec,3,5,"td",20),e.BQk()),2&n&&e.Q6J("matColumnDef",o.$implicit.id)}function nc(n,o){1&n&&e._UZ(0,"th",42)}function ic(n,o){1&n&&e._UZ(0,"td",32)}function ac(n,o){1&n&&e._UZ(0,"tr",43)}function oc(n,o){if(1&n&&e._UZ(0,"tr",44),2&n){const t=o.$implicit,i=e.oxw(3);e.ekj("selected",i.selection.isSelected(t))}}function cc(n,o){if(1&n&&(e.TgZ(0,"table",17),e.ynx(1,18),e.YNc(2,Do,2,0,"th",19),e.YNc(3,Yo,2,2,"td",20),e.BQk(),e.ynx(4,21),e.YNc(5,Fo,2,0,"th",22),e.YNc(6,jo,3,2,"td",23),e.BQk(),e.ynx(7,24),e.YNc(8,Go,2,0,"th",19),e.YNc(9,Xo,2,2,"td",25),e.BQk(),e.YNc(10,tc,3,1,"ng-container",26),e.ALo(11,"async"),e.ynx(12,27),e.YNc(13,nc,1,0,"th",28),e.YNc(14,ic,1,0,"td",20),e.BQk(),e.YNc(15,ac,1,0,"tr",29),e.ALo(16,"async"),e.YNc(17,oc,1,2,"tr",30),e.ALo(18,"async"),e.qZA()),2&n){e.oxw();const t=e.MAs(7),i=e.oxw();e.Q6J("dataSource",i.dataSource),e.xp6(10),e.Q6J("ngForOf",e.lcZ(11,4,i.aliasColumns$)),e.xp6(5),e.Q6J("matHeaderRowDef",e.lcZ(16,6,t.displayedColumns$)),e.xp6(2),e.Q6J("matRowDefColumns",e.lcZ(18,8,t.displayedColumns$))}}function sc(n,o){1&n&&(e.ynx(0),e._uU(1,"replay"),e.BQk())}function rc(n,o){if(1&n&&(e.TgZ(0,"ya-empty-message",45)(1,"p"),e._uU(2," You are connected to the "),e.YNc(3,sc,2,0,"ng-container",5),e._uU(4," processor "),e.TgZ(5,"strong"),e._uU(6),e.qZA(),e._uU(7,". "),e.qZA(),e.TgZ(8,"p"),e._uU(9," This processor does not support commanding. "),e.qZA()()),2&n){const t=e.oxw().ngIf;e.xp6(3),e.Q6J("ngIf",null==t.processor?null:t.processor.replay),e.xp6(3),e.Oqu(null==t.processor?null:t.processor.name)}}function lc(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",4)(1,"div"),e.YNc(2,Jo,2,1,"ng-container",5),e.ALo(3,"async"),e.TgZ(4,"div",6)(5,"ya-search-filter",7),e.NdJ("onArrowDown",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.selectNext())})("onArrowUp",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.selectPrevious())})("onEnter",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.applySelection())}),e.qZA(),e._UZ(6,"ya-column-chooser",8,9),e.qZA(),e.YNc(8,cc,19,10,"table",10),e._UZ(9,"mat-paginator",11),e.ALo(10,"async"),e.qZA(),e.YNc(11,rc,10,2,"ya-empty-message",12),e.qZA()}if(2&n){const t=o.ngIf,i=e.oxw();e.xp6(1),e.ekj("noDisplay",!(null!=t.processor&&t.processor.hasCommanding)),e.xp6(1),e.Q6J("ngIf",e.lcZ(3,11,i.breadcrumb$)),e.xp6(3),e.Q6J("formControl",i.filterControl),e.xp6(1),e.Q6J("columns",i.columns),e.xp6(2),e.Q6J("ngIf",i.dataSource),e.xp6(1),e.Q6J("pageSize",i.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",e.lcZ(10,13,i.dataSource.totalSize$)),e.xp6(2),e.Q6J("ngIf",!(null!=t.processor&&t.processor.hasCommanding))}}function mc(n,o){1&n&&e._uU(0," -\n")}let Qe=(()=>{class n{constructor(t,i,a,c){this.yamcs=i,this.route=a,this.router=c,this.pageSize=100,this.system=null,this.breadcrumb$=new C.X([]),this.filterControl=new l.p4,this.columns=[{id:"name",label:"Name",alwaysVisible:!0},{id:"significance",label:"Significance",visible:!0},{id:"shortDescription",label:"Description"},{id:"actions",label:"",alwaysVisible:!0}],this.aliasColumns$=new C.X([]),this.selection=new E.Ov(!1),t.setTitle("Send a command"),this.connectionInfo$=i.connectionInfo$,this.dataSource=new Qo.S(i)}ngAfterViewInit(){this.filterControl.setValue(this.route.snapshot.queryParamMap.get("filter")),this.changeSystem(this.route.snapshot.queryParamMap),this.queryParamMapSubscription=this.route.queryParamMap.subscribe(t=>{t.get("system")!==this.system&&this.changeSystem(t)}),this.filterControl.valueChanges.subscribe(()=>{this.paginator.pageIndex=0,this.updateDataSource()}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(t){this.system=t.get("system"),this.updateBrowsePath(),this.paginator.pageIndex=t.has("page")?Number(t.get("page")):0,this.updateDataSource()}updateDataSource(){this.updateURL();const t={system:this.system||"/",noAbstract:!0,details:!0,pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize,fields:["name","qualifiedName","alias","effectiveSignificance","shortDescription"]},i=this.filterControl.value;i&&(t.q=i.toLowerCase()),this.dataSource.loadCommands(t).then(()=>{this.selection.clear(),this.updateBrowsePath();for(const c of this.aliasColumns$.value){const s=this.columns.indexOf(c);-1!==s&&this.columns.splice(s,1)}const a=[];for(const c of this.dataSource.getAliasNamespaces())a.push({id:c,label:c,alwaysVisible:!0});this.columns.splice(1,0,...a),this.aliasColumns$.next(a),this.columnChooser.recalculate(this.columns)})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{page:this.paginator.pageIndex||null,filter:this.filterControl.value||null,system:this.system||null},queryParamsHandling:"merge"})}updateBrowsePath(){const t=[];let i="";if(this.system)for(const a of this.system.slice(1).split("/"))i+="/"+a,t.push({name:a,route:"/commanding/send",queryParams:{system:i,c:this.yamcs.context}});this.breadcrumb$.next(t)}selectNext(){const t=this.dataSource.items$.value;let i=0;if(this.selection.hasValue()){const a=this.selection.selected[0];-1!==t.indexOf(a)&&(i=Math.min(t.indexOf(a)+1,t.length-1))}this.selection.select(t[i])}selectPrevious(){const t=this.dataSource.items$.value;let i=0;if(this.selection.hasValue()){const a=this.selection.selected[0];-1!==t.indexOf(a)&&(i=Math.max(t.indexOf(a)-1,0))}this.selection.select(t[i])}applySelection(){if(this.selection.hasValue()){const t=this.selection.selected[0];t.command&&-1!==this.dataSource.items$.value.indexOf(t)&&this.router.navigate(["/commanding/send",t.command?.qualifiedName],{queryParams:{c:this.yamcs.context}})}}ngOnDestroy(){this.queryParamMapSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(Q.Dx),e.Y36(r.C8),e.Y36(T.gz),e.Y36(T.F0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(i,a){if(1&i&&(e.Gf(qo,7),e.Gf(M.NW,5),e.Gf(r.b8,5)),2&i){let c;e.iGM(c=e.CRH())&&(a.top=c.first),e.iGM(c=e.CRH())&&(a.paginator=c.first),e.iGM(c=e.CRH())&&(a.columnChooser=c.first)}},decls:10,vars:3,consts:[["top",""],["step","1"],["class","panel-content",4,"ngIf"],["dash",""],[1,"panel-content"],[4,"ngIf"],[1,"filter-bar"],["placeholder","Search by name","icon","search",3,"formControl","onArrowDown","onArrowUp","onEnter"],["preferenceKey","sendCommand",3,"columns"],["columnChooser",""],["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["headerTitle","Send a command",4,"ngIf"],["class","filter-bar",4,"ngIf"],["link","/commanding/send","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label",4,"ngFor","ngForOf"],[3,"link","queryParams","label"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","significance"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","","class","primary-td",4,"matCellDef"],["matColumnDef","shortDescription"],["mat-cell","","class","wrap200",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf","ngIfElse"],[3,"level"],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],[3,"routerLink","queryParams"],[3,"text","term",4,"ngIf"],[3,"text","term"],["mat-cell","",1,"wrap200"],[3,"matColumnDef"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""],["headerTitle","Send a command"]],template:function(i,a){1&i&&(e.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),e._uU(2," Send a command "),e.qZA(),e._UZ(3,"span",null,0)(5,"app-send-command-wizard-step",1),e.YNc(6,lc,12,15,"div",2),e.ALo(7,"async"),e.qZA(),e.YNc(8,mc,1,0,"ng-template",null,3,e.W1O)),2&i&&(e.xp6(6),e.Q6J("ngIf",e.lcZ(7,1,a.connectionInfo$)))},dependencies:[u.sg,u.O5,l.JJ,l.oH,T.rH,v.D5,v.fo,S.Hw,M.NW,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,r.LI,r.O_,r.b8,r.RR,r.oQ,r.cF,N.a,P.k,L.U,se,u.Ov,u.OU,r.p3,r.XB],styles:[".pullRight[_ngcontent-%COMP%]{float:right}.primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}"],changeDetection:0})}return n})();const uc=["intervalSelect"];function dc(n,o){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"ya-date-time-input",15)(2,"ya-date-time-input",16),e.TgZ(3,"button",17),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.applyCustomDates())}),e._uU(4,"Apply"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",t.filterForm.invalid)}}function pc(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",18),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.jumpToNow())}),e._uU(2," Jump to now "),e.qZA(),e.BQk()}}function _c(n,o){1&n&&(e.TgZ(0,"th",19),e._uU(1,"Time"),e.qZA())}function gc(n,o){if(1&n&&(e.TgZ(0,"td",20),e._uU(1),e.ALo(2,"datetime"),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t.time))}}function fc(n,o){1&n&&(e.TgZ(0,"th",19),e._uU(1,"User"),e.qZA())}function hc(n,o){if(1&n&&(e.TgZ(0,"td",20),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Oqu(t.user||"-")}}function xc(n,o){1&n&&(e.TgZ(0,"th",19),e._uU(1,"Action"),e.qZA())}function yc(n,o){if(1&n&&(e.TgZ(0,"td",20),e._UZ(1,"span",21),e.ALo(2,"actionLogFormat"),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,t.summary)||"-",e.oJD)}}function Tc(n,o){1&n&&e._UZ(0,"th",22)}function Cc(n,o){1&n&&e._UZ(0,"td",20)}function bc(n,o){1&n&&e._UZ(0,"tr",23)}function Zc(n,o){1&n&&e._UZ(0,"tr",24)}let qe=(()=>{class n{constructor(t,i,a,c){this.yamcs=t,this.messageService=i,this.router=a,this.route=c,this.filterForm=new l.nJ({filter:new l.p4,interval:new l.p4("NO_LIMIT"),customStart:new l.p4(null),customStop:new l.p4(null)}),this.displayedColumns=["time","user","summary","actions"],this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.dataSource=new p.by,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(s=>{if("CUSTOM"===s){const m=new Date,d=this.validStart||m,_=this.validStop||m;this.filterForm.get("customStart").setValue(r.P6.toISOString(d)),this.filterForm.get("customStop").setValue(r.P6.toISOString(_))}else"NO_LIMIT"===s?(this.validStart=null,this.validStop=null,this.appliedInterval=s,this.loadData()):(this.validStop=new Date,this.validStart=r.P6.subtractDuration(this.validStop,s),this.appliedInterval=s,this.loadData())})}initializeOptions(){const t=this.route.snapshot.queryParamMap;if(t.has("filter")&&(this.filter=t.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),t.has("interval"))if(this.appliedInterval=t.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const i=t.get("customStart");this.filterForm.get("customStart").setValue(i),this.validStart=r.P6.toDate(i);const a=t.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=r.P6.toDate(a)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=r.P6.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval="NO_LIMIT",this.validStop=null,this.validStart=null}jumpToNow(){this.filterForm.get("interval").setValue("NO_LIMIT")}applyCustomDates(){this.validStart=r.P6.toDate(this.filterForm.value.customStart),this.validStop=r.P6.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const t={service:"QueuesApi"};this.validStart&&(t.start=this.validStart.toISOString()),this.validStop&&(t.stop=this.validStop.toISOString()),this.filter&&(t.q=this.filter),this.yamcs.yamcsClient.getAuditRecords(this.yamcs.instance,t).then(i=>this.dataSource.data=i.records||[]).catch(i=>this.messageService.showError(i))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filter||null,interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.C8),e.Y36(r.ez),e.Y36(T.F0),e.Y36(T.gz))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(i,a){if(1&i&&e.Gf(uc,5),2&i){let c;e.iGM(c=e.CRH())&&(a.intervalSelect=c.first)}},decls:21,vars:7,consts:[[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],[4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","summary"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],["mat-header-cell",""],["mat-cell",""],[3,"innerHTML"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(i,a){1&i&&(e.TgZ(0,"form",0)(1,"div",1),e._UZ(2,"ya-select",2,3),e.YNc(4,dc,5,1,"ng-container",4),e.YNc(5,pc,3,0,"ng-container",4),e.qZA()(),e.TgZ(6,"table",5),e.ynx(7,6),e.YNc(8,_c,2,0,"th",7),e.YNc(9,gc,3,3,"td",8),e.BQk(),e.ynx(10,9),e.YNc(11,fc,2,0,"th",7),e.YNc(12,hc,2,1,"td",8),e.BQk(),e.ynx(13,10),e.YNc(14,xc,2,0,"th",7),e.YNc(15,yc,3,3,"td",8),e.BQk(),e.ynx(16,11),e.YNc(17,Tc,1,0,"th",12),e.YNc(18,Cc,1,0,"td",8),e.BQk(),e.YNc(19,bc,1,0,"tr",13),e.YNc(20,Zc,1,0,"tr",14),e.qZA()),2&i&&(e.Q6J("formGroup",a.filterForm),e.xp6(2),e.Q6J("options",a.intervalOptions),e.xp6(2),e.Q6J("ngIf","CUSTOM"===a.filterForm.value.interval),e.xp6(1),e.Q6J("ngIf","CUSTOM"!==a.filterForm.value.interval),e.xp6(1),e.Q6J("dataSource",a.dataSource),e.xp6(13),e.Q6J("matHeaderRowDef",a.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",a.displayedColumns))},dependencies:[u.O5,l._Y,l.JJ,l.JL,l.sg,l.u,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,r.t,r.Hr,r.NE,r.id],encapsulation:2,changeDetection:0})}return n})();function vc(n,o){1&n&&(e.TgZ(0,"th",18),e._uU(1,"Time"),e.qZA())}function Ac(n,o){if(1&n&&(e.TgZ(0,"td",19),e._uU(1),e.ALo(2,"datetime"),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.generationTime)," ")}}function kc(n,o){1&n&&(e.TgZ(0,"th",20)(1,"mat-icon",21),e._uU(2,"comment"),e.qZA()())}function wc(n,o){if(1&n&&(e.TgZ(0,"mat-icon",25),e._uU(1,"comment"),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("matTooltip",t.comment)}}function Sc(n,o){1&n&&(e.ynx(0),e._uU(1,"-"),e.BQk())}function Nc(n,o){if(1&n&&(e.TgZ(0,"td",22),e.YNc(1,wc,2,1,"mat-icon",23),e.YNc(2,Sc,2,0,"ng-container",24),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",t.comment),e.xp6(1),e.Q6J("ngIf",!t.comment)}}function Pc(n,o){1&n&&(e.TgZ(0,"th",18),e._uU(1,"Command"),e.qZA())}function Uc(n,o){if(1&n&&(e.TgZ(0,"td",19),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.commandName||"-"," ")}}function Qc(n,o){1&n&&(e.TgZ(0,"th",18),e._uU(1,"Queue"),e.qZA())}function qc(n,o){if(1&n&&(e.TgZ(0,"td",19),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.queueName||"-"," ")}}function Oc(n,o){1&n&&(e.TgZ(0,"th",18),e._uU(1,"Issuer"),e.qZA())}function Ic(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("@",t.origin,"")}}function Jc(n,o){if(1&n&&(e.TgZ(0,"td",19),e._uU(1),e.YNc(2,Ic,2,1,"span",24),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.username,""),e.xp6(1),e.Q6J("ngIf",t.origin)}}function Dc(n,o){1&n&&(e.TgZ(0,"th",18),e._uU(1,"Source"),e.qZA())}function Mc(n,o){if(1&n&&(e.TgZ(0,"td",19),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.origin||"-"," ")}}function Yc(n,o){1&n&&(e.TgZ(0,"th",26),e._uU(1,"Command"),e.qZA())}function Fc(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"tr")(2,"td",29),e._uU(3),e.qZA(),e.TgZ(4,"td",30),e._uU(5),e.ALo(6,"value"),e.qZA()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.name),e.xp6(2),e.Oqu(e.lcZ(6,2,t.value))}}function $c(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Fc,7,4,"ng-container",24),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",t.userInput)}}function Lc(n,o){if(1&n&&(e.TgZ(0,"td",19),e._uU(1),e.TgZ(2,"table",27),e.YNc(3,$c,2,1,"ng-container",28),e.qZA()()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.commandName," "),e.xp6(2),e.Q6J("ngForOf",t.assignments)}}function Ec(n,o){1&n&&(e.TgZ(0,"th",31),e._uU(1,"Actions"),e.qZA())}function Hc(n,o){1&n&&(e.TgZ(0,"span",33)(1,"mat-icon",34),e._uU(2,"cached"),e.qZA(),e._uU(3," Checking transmission constraints "),e.qZA())}function Bc(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"ya-text-action",35),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,c=e.oxw(2);return e.KtG(c.acceptEntry(a))}),e._uU(2,"ACCEPT"),e.qZA(),e.TgZ(3,"ya-text-action",36),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,c=e.oxw(2);return e.KtG(c.rejectEntry(a))}),e._uU(4,"REJECT"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("disabled",t.pendingTransmissionConstraints),e.xp6(2),e.Q6J("disabled",t.pendingTransmissionConstraints)}}function Rc(n,o){if(1&n&&(e.TgZ(0,"td",19),e.YNc(1,Hc,4,0,"span",32),e.YNc(2,Bc,5,2,"ng-container",24),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",t.pendingTransmissionConstraints),e.xp6(1),e.Q6J("ngIf",!t.pendingTransmissionConstraints)}}function Vc(n,o){1&n&&e._UZ(0,"tr",37)}function jc(n,o){1&n&&e._UZ(0,"tr",38)}function Gc(n,o){if(1&n&&(e.TgZ(0,"table",1),e.ynx(1,2),e.YNc(2,vc,2,0,"th",3),e.YNc(3,Ac,3,3,"td",4),e.BQk(),e.ynx(4,5),e.YNc(5,kc,3,0,"th",6),e.YNc(6,Nc,3,2,"td",7),e.BQk(),e.ynx(7,8),e.YNc(8,Pc,2,0,"th",3),e.YNc(9,Uc,2,1,"td",4),e.BQk(),e.ynx(10,9),e.YNc(11,Qc,2,0,"th",3),e.YNc(12,qc,2,1,"td",4),e.BQk(),e.ynx(13,10),e.YNc(14,Oc,2,0,"th",3),e.YNc(15,Jc,3,2,"td",4),e.BQk(),e.ynx(16,11),e.YNc(17,Dc,2,0,"th",3),e.YNc(18,Mc,2,1,"td",4),e.BQk(),e.ynx(19,12),e.YNc(20,Yc,2,0,"th",13),e.YNc(21,Lc,4,2,"td",4),e.BQk(),e.ynx(22,14),e.YNc(23,Ec,2,0,"th",15),e.YNc(24,Rc,3,2,"td",4),e.BQk(),e.YNc(25,Vc,1,0,"tr",16),e.YNc(26,jc,1,0,"tr",17),e.qZA()),2&n){const t=e.oxw();e.Q6J("dataSource",t.dataSource),e.xp6(25),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}let Wc=(()=>{class n{constructor(t){this.yamcs=t,this.dataSource=new p.by,this.displayedColumns=["generationTime","comment","source","queueName","issuer","actions"]}ngAfterViewInit(){this.dataSource.sort=this.sort,this.cqueues$.subscribe(t=>{const i=[];for(const a of t)a.entries&&i.push(...a.entries);this.dataSource.data=i})}acceptEntry(t){confirm(`Are you sure you want to accept this command?\n\n ${t.commandName}`)&&this.yamcs.yamcsClient.acceptCommand(t.instance,t.processorName,t.queueName,t.id)}rejectEntry(t){confirm(`Are you sure you want to reject this command?\n\n ${t.commandName}`)&&this.yamcs.yamcsClient.rejectCommand(t.instance,t.processorName,t.queueName,t.id)}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.C8))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-queued-commands-table"]],viewQuery:function(i,a){if(1&i&&e.Gf($.YE,5),2&i){let c;e.iGM(c=e.CRH())&&(a.sort=c.first)}},inputs:{cqueues$:"cqueues$"},decls:1,vars:1,consts:[["mat-table","","class","ya-data-table expand","matSort","","matSortActive","generationTime","matSortDirection","asc","matSortDisableClear","",3,"dataSource",4,"ngIf"],["mat-table","","matSort","","matSortActive","generationTime","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","generationTime"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","comment"],["mat-header-cell","","style","text-align: center",4,"matHeaderCellDef"],["mat-cell","","style","text-align: center",4,"matCellDef"],["matColumnDef","commandName"],["matColumnDef","queueName"],["matColumnDef","issuer"],["matColumnDef","origin"],["matColumnDef","source"],["mat-header-cell","","mat-sort-header","","style","width: 350px",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","",2,"text-align","center"],["matTooltip","Comment"],["mat-cell","",2,"text-align","center"],[3,"matTooltip",4,"ngIf"],[4,"ngIf"],[3,"matTooltip"],["mat-header-cell","","mat-sort-header","",2,"width","350px"],[1,"args"],[4,"ngFor","ngForOf"],["width","1",1,"key"],[1,"value"],["mat-header-cell","",1,"expand"],["style","color: #999",4,"ngIf"],[2,"color","#999"],[1,"icon16","spin",2,"vertical-align","middle"],["icon","check",3,"disabled","click"],["icon","close",3,"disabled","click"],["mat-header-row",""],["mat-row",""]],template:function(i,a){1&i&&e.YNc(0,Gc,27,3,"table",0),2&i&&e.Q6J("ngIf",a.dataSource)},dependencies:[u.sg,u.O5,S.Hw,$.YE,$.nU,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,U.gM,r.ll,r.id,r.VC],styles:[".args[_ngcontent-%COMP%]{margin:0 0 0 10px}.args[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{min-width:120px;white-space:nowrap}.args[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:gray;padding-left:10px}.args[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .args[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:none;font-size:10px;line-height:12px;font-family:Roboto Mono,monospace}"],changeDetection:0})}return n})();function Xc(n,o){if(1&n&&e._UZ(0,"app-queued-commands-table",2),2&n){const t=e.oxw();e.Q6J("cqueues$",t.cqueues$)}}function zc(n,o){1&n&&e._uU(0," All queues are empty.\n")}let Oe=(()=>{class n{constructor(t){this.cqueues$=new C.X([]),this.hasEntries$=new C.X(!1),this.cqueueByName={},t.yamcsClient.getCommandQueues(t.instance,t.processor).then(i=>{for(const a of i)this.cqueueByName[a.name]=a;this.emitChange()}),this.queueEventSubscription=t.yamcsClient.createQueueEventsSubscription({instance:t.instance,processor:t.processor},i=>{const a=this.cqueueByName[i.data.queueName];if(a){if("COMMAND_ADDED"===i.type)a.entries=a.entries||[],a.entries.push(i.data);else if("COMMAND_UPDATED"===i.type){const c=(a.entries||[]).findIndex(s=>s.id===i.data.id);-1!==c&&(a.entries[c]=i.data)}else if("COMMAND_REJECTED"===i.type)a.entries=a.entries||[],a.entries=a.entries.filter(c=>c.id!==i.data.id);else{if("COMMAND_SENT"!==i.type)throw new Error(`Unexpected queue event ${i.type}`);a.entries=a.entries||[],a.entries=a.entries.filter(c=>c.id!==i.data.id)}this.emitChange()}else console.warn("Received an event for an unknown queue",i)})}emitChange(){this.cqueues$.next(Object.values(this.cqueueByName));let t=!1;for(const i of this.cqueues$.getValue())if(i.entries&&i.entries.length){t=!0;break}this.hasEntries$.next(t)}ngOnDestroy(){this.queueEventSubscription&&this.queueEventSubscription.cancel()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.C8))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:4,vars:4,consts:[[3,"cqueues$",4,"ngIf","ngIfElse"],["empty",""],[3,"cqueues$"]],template:function(i,a){if(1&i&&(e.YNc(0,Xc,1,1,"app-queued-commands-table",0),e.ALo(1,"async"),e.YNc(2,zc,1,0,"ng-template",null,1,e.W1O)),2&i){const c=e.MAs(3);e.Q6J("ngIf",e.lcZ(1,2,a.hasEntries$))("ngIfElse",c)}},dependencies:[u.O5,Wc,u.Ov],encapsulation:2,changeDetection:0})}return n})();var Kc=g(2645);function es(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"th",35)(1,"input",36),e.NdJ("change",function(a){e.CHM(t);const c=e.oxw(3);return e.KtG(a?c.masterToggle():null)}),e.qZA()()}if(2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("checked",t.selection.hasValue()&&t.isAllSelected())}}function ts(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",37)(1,"input",38),e.NdJ("click",function(a){return a.stopPropagation()})("change",function(a){const s=e.CHM(t).$implicit,m=e.oxw(3);return e.KtG(a?m.selection.toggle(s):null)}),e.qZA()()}if(2&n){const t=o.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("checked",i.selection.isSelected(t))}}function ns(n,o){1&n&&(e.TgZ(0,"th",39),e._uU(1,"#"),e.qZA())}function is(n,o){if(1&n&&(e.TgZ(0,"td",40),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.order," ")}}function as(n,o){1&n&&(e.TgZ(0,"th",39),e._uU(1,"Queue"),e.qZA())}function os(n,o){if(1&n&&(e.TgZ(0,"td",40),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function cs(n,o){1&n&&(e.TgZ(0,"th",39),e._uU(1,"Issuer"),e.qZA())}function ss(n,o){if(1&n&&(e.TgZ(0,"ya-label",44),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}function rs(n,o){if(1&n&&(e.TgZ(0,"ya-label",45),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}function ls(n,o){1&n&&(e.ynx(0),e._uU(1,"any"),e.BQk())}function ms(n,o){if(1&n&&(e.TgZ(0,"td",40),e.YNc(1,ss,2,1,"ya-label",41),e.YNc(2,rs,2,1,"ya-label",42),e.YNc(3,ls,2,0,"ng-container",43),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngForOf",t.groups),e.xp6(1),e.Q6J("ngForOf",t.users),e.xp6(1),e.Q6J("ngIf",!t.groups&&!t.users)}}function us(n,o){1&n&&(e.TgZ(0,"th",39),e._uU(1,"Min.\xa0level"),e.qZA())}function ds(n,o){if(1&n&&(e.TgZ(0,"td",40),e._UZ(1,"app-significance-level",46),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("level",t.minLevel)("grayscale",!0)}}function ps(n,o){1&n&&(e.TgZ(0,"th",39),e._uU(1,"Name\xa0patterns"),e.qZA())}function _s(n,o){1&n&&(e.ynx(0),e._uU(1,"any"),e.BQk())}function gs(n,o){if(1&n&&(e.ynx(0),e._uU(1),e._UZ(2,"br"),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t,"")}}function fs(n,o){if(1&n&&(e.TgZ(0,"td",40),e.YNc(1,_s,2,0,"ng-container",43),e.YNc(2,gs,3,1,"ng-container",47),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",!t.tcPatterns),e.xp6(1),e.Q6J("ngForOf",t.tcPatterns)}}function hs(n,o){1&n&&(e.TgZ(0,"th",39),e._uU(1,"Action"),e.qZA())}function xs(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1," ACCEPT "),e.qZA())}function ys(n,o){if(1&n&&(e.TgZ(0,"span"),e.ALo(1,"async"),e._uU(2," HOLD "),e.qZA()),2&n){const t=e.oxw(4);e.Udp("visibility",e.lcZ(1,2,t.visibility$)?"visible":"hidden")}}function Ts(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1," REJECT "),e.qZA())}function Cs(n,o){if(1&n&&(e.TgZ(0,"td",40),e.YNc(1,xs,2,0,"span",43),e.YNc(2,ys,3,4,"span",48),e.YNc(3,Ts,2,0,"span",43),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf","ENABLED"===t.state),e.xp6(1),e.Q6J("ngIf","BLOCKED"===t.state),e.xp6(1),e.Q6J("ngIf","DISABLED"===t.state)}}function bs(n,o){1&n&&(e.TgZ(0,"th",39),e._uU(1,"Pending"),e.qZA())}function Zs(n,o){if(1&n&&(e.TgZ(0,"td",49),e._uU(1),e.ALo(2,"number"),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,(null==t.entries?null:t.entries.length)||0)," ")}}function vs(n,o){1&n&&e._UZ(0,"th",50)}const As=function(n,o){return{c:n,queue:o}};function ks(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",40)(1,"ya-more")(2,"button",5),e.NdJ("click",function(){const c=e.CHM(t).$implicit,s=e.oxw(3);return e.KtG(s.enableQueue(c))}),e.TgZ(3,"mat-icon"),e._uU(4,"check"),e.qZA(),e._uU(5," Accept mode "),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(){const c=e.CHM(t).$implicit,s=e.oxw(3);return e.KtG(s.blockQueue(c))}),e.TgZ(7,"mat-icon"),e._uU(8,"pause"),e.qZA(),e._uU(9," Hold mode "),e.qZA(),e.TgZ(10,"button",5),e.NdJ("click",function(){const c=e.CHM(t).$implicit,s=e.oxw(3);return e.KtG(s.disableQueue(c))}),e.TgZ(11,"mat-icon"),e._uU(12,"close"),e.qZA(),e._uU(13," Reject mode "),e.qZA(),e._UZ(14,"mat-divider"),e.TgZ(15,"a",51),e._uU(16," View command history "),e.qZA()()()}if(2&n){const t=o.$implicit,i=e.oxw(3);e.xp6(15),e.Q6J("queryParams",e.WLB(1,As,i.yamcs.context,t.name))}}function ws(n,o){1&n&&e._UZ(0,"tr",52)}function Ss(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr",53),e.NdJ("click",function(){const c=e.CHM(t).$implicit,s=e.oxw(3);return e.KtG(s.toggleOne(c))}),e.qZA()}if(2&n){const t=o.$implicit,i=e.oxw(3);e.ekj("selected",i.selection.isSelected(t))}}function Ns(n,o){if(1&n&&(e.TgZ(0,"table",17),e.ynx(1,18),e.YNc(2,es,2,1,"th",19),e.YNc(3,ts,2,1,"td",20),e.BQk(),e.ynx(4,21),e.YNc(5,ns,2,0,"th",22),e.YNc(6,is,2,1,"td",23),e.BQk(),e.ynx(7,24),e.YNc(8,as,2,0,"th",22),e.YNc(9,os,2,1,"td",23),e.BQk(),e.ynx(10,25),e.YNc(11,cs,2,0,"th",22),e.YNc(12,ms,4,3,"td",23),e.BQk(),e.ynx(13,26),e.YNc(14,us,2,0,"th",22),e.YNc(15,ds,2,2,"td",23),e.BQk(),e.ynx(16,27),e.YNc(17,ps,2,0,"th",22),e.YNc(18,fs,3,2,"td",23),e.BQk(),e.ynx(19,28),e.YNc(20,hs,2,0,"th",22),e.YNc(21,Cs,4,3,"td",23),e.BQk(),e.ynx(22,29),e.YNc(23,bs,2,0,"th",22),e.YNc(24,Zs,3,3,"td",30),e.BQk(),e.ynx(25,31),e.YNc(26,vs,1,0,"th",32),e.YNc(27,ks,17,4,"td",23),e.BQk(),e.YNc(28,ws,1,0,"tr",33),e.YNc(29,Ss,1,2,"tr",34),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("dataSource",t.dataSource)("trackBy",t.tableTrackerFn),e.xp6(28),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}const Ie=function(n){return{c:n}};function Ps(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Ns,30,4,"table",9),e.TgZ(2,"p"),e._uU(3,"\xa0"),e.qZA(),e.TgZ(4,"nav",10)(5,"a",11,12),e._uU(7," Pending "),e.qZA(),e.TgZ(8,"a",13,14),e._uU(10," Action log "),e.qZA()(),e.TgZ(11,"div",15)(12,"mat-tab-nav-panel",null,16),e._UZ(14,"router-outlet"),e.qZA()(),e.BQk()),2&n){const t=e.MAs(6),i=e.MAs(9),a=e.MAs(13),c=e.oxw();e.xp6(1),e.Q6J("ngIf",c.dataSource),e.xp6(3),e.Q6J("mat-stretch-tabs",!1)("tabPanel",a),e.xp6(1),e.Q6J("active",t.isActive)("queryParams",e.VKq(7,Ie,c.yamcs.context)),e.xp6(3),e.Q6J("active",i.isActive)("queryParams",e.VKq(9,Ie,c.yamcs.context))}}function Us(n,o){1&n&&(e.ynx(0),e._uU(1,"replay"),e.BQk())}function Qs(n,o){if(1&n&&(e.TgZ(0,"ya-empty-message",55)(1,"p"),e._uU(2," You are connected to the "),e.YNc(3,Us,2,0,"ng-container",43),e._uU(4," processor "),e.TgZ(5,"strong"),e._uU(6),e.qZA(),e._uU(7,". "),e.qZA(),e.TgZ(8,"p"),e._uU(9," This processor does not support commanding. "),e.qZA()()),2&n){const t=o.ngIf;e.xp6(3),e.Q6J("ngIf",null==t.processor?null:t.processor.replay),e.xp6(3),e.Oqu(null==t.processor?null:t.processor.name)}}function qs(n,o){if(1&n&&(e.YNc(0,Qs,10,2,"ya-empty-message",54),e.ALo(1,"async")),2&n){const t=e.oxw();e.Q6J("ngIf",e.lcZ(1,1,t.connectionInfo$))}}let Je=(()=>{class n{constructor(t,i,a,c,s){this.yamcs=t,this.changeDetection=c,this.cqueues$=new C.X([]),this.dataSource=new p.by,this.selection=new Kc.O((m,d)=>d.name,!0,[]),this.tableTrackerFn=(m,d)=>d.name,this.displayedColumns=["select","order","name","issuer","level","patterns","action","pending","actions"],this.visibility$=new C.X(!0),this.cqueueByName={},i.setTitle("Queues"),this.connectionInfo$=t.connectionInfo$,t.yamcsClient.getCommandQueues(t.instance,t.processor).then(m=>{for(const d of m)this.cqueueByName[d.name]=d;this.emitChange()}).catch(m=>a.showError(m)),this.syncSubscription=s.syncFast(()=>{this.visibility$.next(!this.visibility$.value)}),this.queueSubscription=t.yamcsClient.createQueueStatisticsSubscription({instance:t.instance,processor:t.processor},m=>{const d=this.cqueueByName[m.name];d&&(m.entries=d.entries,this.cqueueByName[m.name]=m,this.emitChange())}),this.queueEventSubscription=t.yamcsClient.createQueueEventsSubscription({instance:t.instance,processor:t.processor},m=>{const d=this.cqueueByName[m.data.queueName];if(d){if("COMMAND_ADDED"===m.type)d.entries=d.entries||[],d.entries.push(m.data);else if("COMMAND_UPDATED"===m.type){const _=(d.entries||[]).findIndex(y=>y.id===m.data.id);-1!==_&&(d.entries[_]=m.data)}else if("COMMAND_REJECTED"===m.type)d.entries=d.entries||[],d.entries=d.entries.filter(_=>_.id!==m.data.id);else{if("COMMAND_SENT"!==m.type)throw new Error(`Unexpected queue event ${m.type}`);d.entries=d.entries||[],d.entries=d.entries.filter(_=>_.id!==m.data.id)}this.emitChange()}else console.warn("Received an event for an unknown queue",m)})}ngAfterViewInit(){this.cqueues$.subscribe(t=>{this.dataSource.data=t,this.selection.matchNewValues(t),this.changeDetection.detectChanges()})}isAllSelected(){const i=this.dataSource.filteredData.length;return this.selection.selected.length===i&&i>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(t=>this.selection.select(t))}toggleOne(t){(!this.selection.isSelected(t)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(t)}enableSelectedQueues(){for(const t of this.selection.selected)this.enableQueue(t)}enableQueue(t){const i=t.entries?.length||0;let a=`Are you sure you want to change the '${t.name}' queue's action to ACCEPT?\n\n`;a+=1===i?`There is ${i} queued command that will be accepted immediately.`:`There are ${i} queued commands that will be accepted immediately.`,(!i||confirm(a))&&this.yamcs.yamcsClient.enableCommandQueue(t.instance,t.processorName,t.name)}disableSelectedQueues(){for(const t of this.selection.selected)this.disableQueue(t)}disableQueue(t){const i=t.entries?.length||0;let a=`Are you sure you want to change the '${t.name}' queue's action to REJECT?\n\n`;a+=1===i?`There is ${i} queued command that will be rejected immediately.`:`There are ${i} queued commands that will be rejected immediately.`,(!i||confirm(a))&&this.yamcs.yamcsClient.disableCommandQueue(t.instance,t.processorName,t.name)}blockSelectedQueues(){for(const t of this.selection.selected)this.blockQueue(t)}blockQueue(t){this.yamcs.yamcsClient.blockCommandQueue(t.instance,t.processorName,t.name)}emitChange(){this.cqueues$.next(Object.values(this.cqueueByName))}ngOnDestroy(){this.syncSubscription?.unsubscribe(),this.queueSubscription?.cancel(),this.queueEventSubscription?.cancel()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.C8),e.Y36(Q.Dx),e.Y36(r.ez),e.Y36(e.sBO),e.Y36(r.jF))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:48,vars:6,consts:[["yaSimpleTable","",2,"width","100%"],["width","1"],["mat-button","","color","primary",3,"matMenuTriggerFor","disabled"],[1,"ya-menu"],["actionMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"panel-content"],[4,"ngIf","ngIfElse"],["noCommanding",""],["mat-table","","class","ya-data-table expand",3,"dataSource","trackBy",4,"ngIf"],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","/commanding/queues/pending","routerLinkActive","",3,"active","queryParams"],["rla","routerLinkActive"],["mat-tab-link","","routerLink","/commanding/queues/log","routerLinkActive","",3,"active","queryParams"],["rlb","routerLinkActive"],[2,"margin-top","16px"],["tabPanel",""],["mat-table","",1,"ya-data-table","expand",3,"dataSource","trackBy"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["matColumnDef","order"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","issuer"],["matColumnDef","level"],["matColumnDef","patterns"],["matColumnDef","action"],["matColumnDef","pending"],["mat-cell","","style","text-align: center",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked","change"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"checked","click","change"],["mat-header-cell",""],["mat-cell",""],["icon","people",4,"ngFor","ngForOf"],["icon","person",4,"ngFor","ngForOf"],[4,"ngIf"],["icon","people"],["icon","person"],[3,"level","grayscale"],[4,"ngFor","ngForOf"],[3,"visibility",4,"ngIf"],["mat-cell","",2,"text-align","center"],["mat-header-cell","",1,"expand"],["mat-menu-item","","routerLink","/commanding/history",3,"queryParams"],["mat-header-row",""],["mat-row","",3,"click"],["headerTitle","Queues",4,"ngIf"],["headerTitle","Queues"]],template:function(i,a){if(1&i&&(e.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),e._uU(2," Queues "),e.TgZ(3,"ya-help")(4,"p"),e._uU(5," A queue is a temporary holding location for issued commands that are waiting to enter the next stage of processing. "),e.qZA(),e.TgZ(6,"p"),e._uU(7," Queues are an ordered list. Issued commands are offered to the first matching queue. "),e.qZA(),e.TgZ(8,"p"),e._uU(9," A queue can perform these actions: "),e.qZA(),e.TgZ(10,"table",0)(11,"tr")(12,"th",1),e._uU(13," ACCEPT "),e.qZA(),e.TgZ(14,"td"),e._uU(15,"The queue accepts and releases commands."),e.qZA()(),e.TgZ(16,"tr")(17,"th"),e._uU(18," HOLD "),e.qZA(),e.TgZ(19,"td"),e._uU(20,"The queue accepts commands but does not release them. These commands may be released manually, or automatically as soon as the queue action changes to ACCEPT."),e.qZA()(),e.TgZ(21,"tr")(22,"th"),e._uU(23," REJECT "),e.qZA(),e.TgZ(24,"td"),e._uU(25,"The queue does not accept commands. Matching commands will fail immediately."),e.qZA()()()(),e._uU(26," \xa0\xa0\xa0 "),e.TgZ(27,"button",2),e._uU(28," Change action \u25be "),e.qZA(),e.TgZ(29,"mat-menu",3,4)(31,"button",5),e.NdJ("click",function(){return a.enableSelectedQueues()}),e.TgZ(32,"mat-icon"),e._uU(33,"check"),e.qZA(),e._uU(34," ACCEPT "),e.qZA(),e.TgZ(35,"button",5),e.NdJ("click",function(){return a.blockSelectedQueues()}),e.TgZ(36,"mat-icon"),e._uU(37,"pause"),e.qZA(),e._uU(38," HOLD "),e.qZA(),e.TgZ(39,"button",5),e.NdJ("click",function(){return a.disableSelectedQueues()}),e.TgZ(40,"mat-icon"),e._uU(41,"close"),e.qZA(),e._uU(42," REJECT "),e.qZA()()(),e.TgZ(43,"div",6),e.YNc(44,Ps,15,11,"ng-container",7),e.ALo(45,"async"),e.YNc(46,qs,2,3,"ng-template",null,8,e.W1O),e.qZA()()),2&i){const c=e.MAs(30),s=e.MAs(47);let m;e.xp6(27),e.Q6J("matMenuTriggerFor",c)("disabled",a.selection.isEmpty()),e.xp6(17),e.Q6J("ngIf",null==(m=e.lcZ(45,4,a.connectionInfo$))||null==m.processor?null:m.processor.hasCommanding)("ngIfElse",s)}},dependencies:[u.sg,u.O5,T.lC,T.rH,T.Od,r.Vy,v.O_,v.D5,v.fo,O.lW,S.Hw,D.d,w.VK,w.OP,w.p6,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,F.BU,F.sW,F.Nj,r.RR,r.IR,r._n,r.cQ,N.a,P.k,L.U,u.Ov,u.JJ],encapsulation:2,changeDetection:0})}return n})();var j=g(4423),Os=g(7398),Is=g(6907);function Js(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"th"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.description||"-")}}function Ds(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"p"),e._uU(2,"\xa0"),e.qZA(),e.TgZ(3,"p"),e._uU(4," Verifiers: "),e.qZA(),e.TgZ(5,"table",1),e.YNc(6,Js,5,2,"tr",4),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(6),e.Q6J("ngForOf",t.verifiers)}}function Ms(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"th"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.name.replace("Acknowledge_","")),e.xp6(2),e.Oqu(t.description||"-")}}function Ys(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"p"),e._uU(2,"\xa0"),e.qZA(),e.TgZ(3,"p"),e._uU(4," Extra acknowledgments: "),e.qZA(),e.TgZ(5,"table",1),e.YNc(6,Ms,5,2,"tr",4),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(6),e.Q6J("ngForOf",t.extra)}}let De=(()=>{class n{constructor(){this.verifiers=[],this.extra=[]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-advance-ack-help"]],inputs:{verifiers:"verifiers",extra:"extra"},decls:29,vars:2,consts:[["dialogTitle","Await acknowledgement success","dialogWidth","800px"],["yaSimpleTable","",2,"width","100%"],["width","1"],[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(i,a){1&i&&(e.TgZ(0,"ya-help",0)(1,"p"),e._uU(2," Configure the acknowledgment which is required to be successful before advancing to the next command in the stack. "),e.qZA(),e.TgZ(3,"table",1)(4,"tr")(5,"th",2),e._uU(6,"Queued"),e.qZA(),e.TgZ(7,"td"),e._uU(8,"The command was accepted into a Yamcs queue."),e.qZA()(),e.TgZ(9,"tr")(10,"th"),e._uU(11,"Released"),e.qZA(),e.TgZ(12,"td"),e._uU(13,"The command was released from its assigned Yamcs queue."),e.qZA()(),e.TgZ(14,"tr")(15,"th"),e._uU(16,"Sent"),e.qZA(),e.TgZ(17,"td"),e._uU(18,"The command was processed by a Yamcs link."),e.qZA()(),e.TgZ(19,"tr")(20,"th"),e._uU(21,"Completed"),e.qZA(),e.TgZ(22,"td")(23,"p"),e._uU(24," The command completed successfully. "),e.qZA(),e.TgZ(25,"p"),e._uU(26," This requires the configuration of a success verifier in the Mission Database specification. "),e.qZA()()()(),e.YNc(27,Ds,7,1,"ng-container",3),e.YNc(28,Ys,7,1,"ng-container",3),e.qZA()),2&i&&(e.xp6(27),e.Q6J("ngIf",a.verifiers.length),e.xp6(1),e.Q6J("ngIf",a.extra.length))},dependencies:[u.sg,u.O5,r.Vy,r.IR],encapsulation:2,changeDetection:0})}return n})();const Fs=["commandSelector"],$s=["commandForm"];function Ls(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",1)(2,"form",2)(3,"h2"),e._uU(4,"Select command"),e.qZA(),e.TgZ(5,"div",3),e._UZ(6,"app-command-selector",4,5),e.qZA()()(),e.TgZ(8,"div",6)(9,"mat-toolbar")(10,"mat-toolbar-row")(11,"button",7),e._uU(12,"CANCEL"),e.qZA()()()(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.selectCommandForm)}}function Es(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"ya-text-action",14),e.NdJ("click",function(){const c=e.CHM(t).ngIf,s=e.oxw(2);return e.KtG(s.returnToList(c))}),e._uU(2),e.qZA(),e.BQk()}if(2&n){const t=o.ngIf;e.xp6(1),e.Q6J("padding",!1),e.xp6(1),e.hij(" ",t," ")}}function Hs(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e._UZ(2,"br"),e.TgZ(3,"h2"),e._uU(4),e.qZA()()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.namespace,""),e.xp6(3),e.Oqu(t.name)}}function Bs(n,o){1&n&&e._UZ(0,"input",24)}function Rs(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"form",15)(2,"p"),e._uU(3,"\xa0"),e.qZA(),e.TgZ(4,"h3"),e._uU(5,"Stack advancement"),e.qZA(),e.TgZ(6,"div",16),e._uU(7," Advance when "),e._UZ(8,"app-advance-ack-help",17)(9,"br"),e.TgZ(10,"div",18),e._UZ(11,"ya-select",19,20),e.YNc(13,Bs,1,0,"input",21),e.qZA()(),e._UZ(14,"br"),e.TgZ(15,"div",16),e._uU(16," Wait (ms) "),e.TgZ(17,"ya-help",22)(18,"p"),e._uU(19," Wait time before advancing to the next command in the stack. "),e.qZA(),e.TgZ(20,"p"),e._uU(21," This triggers after successful acknowledgment. "),e.qZA()(),e._UZ(22,"br")(23,"input",23),e.qZA()(),e.BQk()),2&n){const t=e.oxw(2);let i;e.xp6(1),e.Q6J("formGroup",t.stackOptionsForm)("ngClass",t.stackOptionsForm.disabled&&"disabled"),e.xp6(7),e.Q6J("verifiers",t.verifierAcknowledgments)("extra",t.extraAcknowledgments),e.xp6(3),e.Q6J("options",t.ackOptions),e.xp6(2),e.Q6J("ngIf","custom"===(null==(i=t.stackOptionsForm.get("advancementAckDropDown"))?null:i.value))}}const Vs=function(){return[]};function js(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",1)(2,"div",8)(3,"div",9)(4,"div"),e.YNc(5,Es,3,2,"ng-container",0),e.ALo(6,"spaceSystemName"),e.TgZ(7,"h2"),e._uU(8),e.qZA()(),e.YNc(9,Hs,5,2,"div",10),e.qZA(),e.TgZ(10,"p"),e._uU(11,"\xa0"),e.qZA(),e._UZ(12,"app-command-form",11,12),e.YNc(14,Rs,24,6,"ng-container",0),e.qZA()(),e.TgZ(15,"div",6)(16,"mat-toolbar")(17,"mat-toolbar-row")(18,"button",7),e._uU(19,"CANCEL"),e.qZA(),e._uU(20,"\xa0\xa0 "),e.TgZ(21,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleOK())}),e._uU(22),e.qZA()()()(),e.BQk()}if(2&n){const t=o.ngIf,i=e.MAs(13),a=e.oxw();e.xp6(5),e.Q6J("ngIf",e.lcZ(6,8,t.qualifiedName)),e.xp6(3),e.Oqu(t.name),e.xp6(1),e.Q6J("ngForOf",t.alias||e.DdM(10,Vs)),e.xp6(3),e.Q6J("command",t)("templateProvider",a.templateProvider),e.xp6(2),e.Q6J("ngIf","ycs"===a.format),e.xp6(7),e.Q6J("disabled",!i.form.valid),e.xp6(1),e.hij(" ",a.okLabel,"")}}class Gs{constructor(o){this.entry=o}getAssignment(o){for(const t in this.entry.args)if(t===o)return r.P6.toValue(this.entry.args[t])}getOption(o,t){for(const i in this.entry.extra||{})if(i===o){const a=this.entry.extra[i];switch(t){case"BOOLEAN":return this.getBooleanOption(a);case"NUMBER":return this.getNumberOption(a);case"STRING":return this.getStringOption(a)}}}getBooleanOption(o){if("BOOLEAN"===o.type)return o}getNumberOption(o){switch(o.type){case"SINT32":case"UINT32":case"SINT64":case"UINT64":return o}}getStringOption(o){if("STRING"===o.type)return o}getComment(){return this.entry.comment}}let Me=(()=>{class n{constructor(t,i,a,c,s){let m,d,_;if(this.dialogRef=t,this.yamcs=i,this.changeDetection=c,this.data=s,this.okLabel="OK",this.verifierAcknowledgments=[],this.extraAcknowledgments=[],this.ackOptions=[{id:"",label:"Inherit"},{id:"Acknowledge_Queued",label:"Queued",group:!0},{id:"Acknowledge_Released",label:"Released"},{id:"Acknowledge_Sent",label:"Sent"},{id:"CommandComplete",label:"Completed"}],this.commandFormValid$=new C.X(!1),this.selectedCommand$=new C.X(null),s?.entry){const y=s.entry;if(this.templateProvider=new Gs(y),this.selectedCommand$.next(y.command??null),this.verifierAcknowledgments=[],y.command){const h=[];let b=y.command;for(;b;)h.unshift(b),b=b.baseCommand;for(const A of h)for(const k of A.verifier??[])this.verifierAcknowledgments.push({name:`Verifier_${k.stage}`});let Z=!0;for(const A of this.verifierAcknowledgments)this.ackOptions.push({id:A.name,label:A.name,group:Z}),Z=!1}this.extraAcknowledgments=i.getProcessor()?.acknowledgments??[];let f=!0;for(const h of this.extraAcknowledgments)this.ackOptions.push({id:h.name,label:h.name.replace("Acknowledge_",""),group:f}),f=!1;if(this.ackOptions.push({id:"custom",label:"Custom",group:!0}),y.advancement?.acknowledgment){const h=this.ackOptions.find(b=>b.id===y.advancement.acknowledgment);m=h?h.id:"custom"}d="custom"===m?y.advancement?.acknowledgment:"",_=y.advancement?.wait}s?.okLabel&&(this.okLabel=s?.okLabel),s?.format&&(this.format=s.format),this.stackOptionsForm=a.group({advancementAckDropDown:[m||"",[]],advancementAckCustom:[d,[]],advancementWait:[_,[]]}),"ycs"!==this.format&&this.stackOptionsForm.disable(),this.selectCommandForm=a.group({command:["",l.kI.required]}),this.selectCommandForm.valueChanges.subscribe(()=>{this.selectedCommand$.next(this.selectCommandForm.value.command||null)}),this.stackOptionsForm.valueChanges.subscribe(y=>{"custom"!==y.advancementAckDropDown&&this.stackOptionsForm.patchValue({advancementAckCustom:void 0},{emitEvent:!1})})}handleOK(){const t={},i=this.stackOptionsForm.get("advancementAckDropDown")?.value,a=this.stackOptionsForm.get("advancementAckCustom")?.value?.trim(),c=this.stackOptionsForm.get("advancementWait")?.value;(i&&"custom"!==i||"custom"===i&&a||null!=c)&&(t.advancement={...i&&"custom"!==i&&{acknowledgment:i},..."custom"===i&&a&&{acknowledgment:a},...null!=c&&{wait:c}});const s={command:this.selectedCommand$.value,args:this.commandForm.getAssignments(),comment:this.commandForm.getComment(),extra:this.commandForm.getExtraOptions(),stackOptions:t};this.dialogRef.close(s)}returnToList(t){this.templateProvider=null,this.selectedCommand$.next(null),this.changeDetection.detectChanges(),this.selectCommandForm.reset(),this.stackOptionsForm.reset(),this.commandSelector.changeSystem("/"===t?"":t)}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x.so),e.Y36(r.C8),e.Y36(l.QS),e.Y36(e.sBO),e.Y36(x.WI))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(i,a){if(1&i&&(e.Gf(Fs,5),e.Gf($s,5)),2&i){let c;e.iGM(c=e.CRH())&&(a.commandSelector=c.first),e.iGM(c=e.CRH())&&(a.commandForm=c.first)}},decls:4,vars:6,consts:[[4,"ngIf"],[1,"wrapper","mat-typography"],[1,"ya-form",3,"formGroup"],[1,"command-table-wrapper"],["formControlName","command"],["commandSelector",""],[1,"footer","mat-typography"],["mat-dialog-close","",1,"ya-button"],[1,"command-detail"],[1,"names"],[4,"ngFor","ngForOf"],[3,"command","templateProvider"],["commandForm",""],[1,"ya-button","primary",3,"disabled","click"],[3,"padding","click"],[1,"ya-form",3,"formGroup","ngClass"],[1,"label"],[3,"verifiers","extra"],[2,"display","flex","align-items","flex-start"],["formControlName","advancementAckDropDown","emptyOption","Inherit",3,"options"],["ackSelect",""],["type","text","formControlName","advancementAckCustom","style","width: 200px; margin-left: -1px",4,"ngIf"],["dialogTitle","Wait time"],["type","number","formControlName","advancementWait","placeholder","Inherit","step","1000","min","0"],["type","text","formControlName","advancementAckCustom",2,"width","200px","margin-left","-1px"]],template:function(i,a){1&i&&(e.YNc(0,Ls,13,1,"ng-container",0),e.ALo(1,"async"),e.YNc(2,js,23,11,"ng-container",0),e.ALo(3,"async")),2&i&&(e.Q6J("ngIf",!e.lcZ(1,2,a.selectedCommand$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,4,a.selectedCommand$)))},dependencies:[u.mk,u.sg,u.O5,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.qQ,l.sg,l.u,x.ZT,I.Ye,I.rD,r.IR,r.Hr,r.ll,Is.C,De,oe,u.Ov,r.BC],styles:[".mat-mdc-dialog-container{border-radius:0;position:relative}.wrapper[_ngcontent-%COMP%]{position:relative;height:calc(100% - 48px);overflow:auto}.command-table-wrapper[_ngcontent-%COMP%]{position:absolute;overflow:auto;inset:56px 0 1em}.command-detail[_ngcontent-%COMP%]{max-width:600px}.footer[_ngcontent-%COMP%]{position:absolute;bottom:0;height:64px;left:0;right:0;border-top:1px solid #d3d3d3}.disabled[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{opacity:.6}div.names[_ngcontent-%COMP%]{display:flex}div.names[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-right:25px}div.names[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child){padding-left:25px;border-left:1px solid rgba(0,0,0,.1)}div.names[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}div.names[_ngcontent-%COMP%]     .text-action{line-height:0}"]})}return n})();function Ws(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",2),e._uU(2),e.qZA(),e.TgZ(3,"div",1),e._uU(4),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.namespace),e.xp6(2),e.hij(" ",t.name," ")}}function Xs(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"app-markdown",8),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("text",null==t.entry.command?null:t.entry.command.longDescription)}}function zs(n,o){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",(null==t.entry.command?null:t.entry.command.shortDescription)||"-"," ")}}function Ks(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"app-significance-level",9),e._uU(2),e.BQk()),2&n){const t=o.ngIf;e.xp6(1),e.Q6J("level",t.consequenceLevel),e.xp6(1),e.hij(" ",t.reasonForWarning," ")}}function er(n,o){1&n&&(e.TgZ(0,"span",15),e._uU(1," satisfied "),e.qZA())}function tr(n,o){1&n&&(e.TgZ(0,"span",16),e._uU(1," not satisfied "),e.qZA())}function nr(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e.YNc(6,er,2,0,"span",11),e.ALo(7,"async"),e.YNc(8,tr,2,0,"span",12),e.ALo(9,"async"),e._UZ(10,"app-live-expression",13,14),e.qZA()()),2&n){const t=o.$implicit,i=e.MAs(11);e.xp6(2),e.Oqu(t.expression),e.xp6(2),e.Oqu(t.timeout||"-"),e.xp6(2),e.Q6J("ngIf",!0===e.lcZ(7,7,i.result$)),e.xp6(2),e.Q6J("ngIf",!1===e.lcZ(9,9,i.result$)),e.xp6(2),e.Udp("display","none"),e.Q6J("expression",t.expression)}}function ir(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"table",10)(2,"tr")(3,"th"),e._uU(4,"Constraint"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Timeout"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Live Evaluation"),e.qZA()(),e.YNc(9,nr,12,11,"tr",3),e.qZA(),e.BQk()),2&n){const t=o.ngIf;e.xp6(9),e.Q6J("ngForOf",t)}}function ar(n,o){1&n&&(e.ynx(0),e._uU(1,"-"),e.BQk())}function or(n,o){1&n&&e._uU(0," -\n")}let cr=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-stacked-command-detail"]],inputs:{entry:"entry"},decls:29,vars:13,consts:[[1,"block-title",2,"padding-top","0"],[1,"block"],[1,"block-title"],[4,"ngFor","ngForOf"],[4,"ngIf"],[2,"margin-top","1em","margin-bottom","1em"],[4,"ngIf","ngIfElse"],["dash",""],[3,"text"],[3,"level"],["yaDataTable",""],["class","evaluation valid",4,"ngIf"],["class","evaluation invalid",4,"ngIf"],[3,"expression"],["expr",""],[1,"evaluation","valid"],[1,"evaluation","invalid"]],template:function(i,a){if(1&i&&(e.TgZ(0,"div",0),e._uU(1,"Command"),e.qZA(),e.TgZ(2,"div",1),e._uU(3),e.ALo(4,"shortName"),e.qZA(),e.TgZ(5,"div",2),e._uU(6,"Space system"),e.qZA(),e.TgZ(7,"div",1),e._uU(8),e.ALo(9,"spaceSystemName"),e.qZA(),e.YNc(10,Ws,5,2,"ng-container",3),e.TgZ(11,"div",2),e._uU(12,"Description"),e.qZA(),e.TgZ(13,"div",1),e.YNc(14,Xs,2,1,"ng-container",4),e.YNc(15,zs,2,1,"ng-container",4),e.qZA(),e._UZ(16,"mat-divider",5),e.TgZ(17,"div",2),e._uU(18,"Significance"),e.qZA(),e.TgZ(19,"div",1),e.YNc(20,Ks,3,2,"ng-container",6),e.qZA(),e._UZ(21,"mat-divider",5),e.TgZ(22,"div",0),e._uU(23,"Constraints"),e.qZA(),e.TgZ(24,"div",1),e.YNc(25,ir,10,1,"ng-container",4),e.YNc(26,ar,2,0,"ng-container",4),e.qZA(),e.YNc(27,or,1,0,"ng-template",null,7,e.W1O)),2&i){const c=e.MAs(28);e.xp6(3),e.hij(" ",e.lcZ(4,9,null==a.entry.command?null:a.entry.command.qualifiedName)||"-","\n"),e.xp6(5),e.hij(" ",e.lcZ(9,11,null==a.entry.command?null:a.entry.command.qualifiedName)||"-","\n"),e.xp6(2),e.Q6J("ngForOf",null==a.entry.command?null:a.entry.command.alias),e.xp6(4),e.Q6J("ngIf",null==a.entry.command?null:a.entry.command.longDescription),e.xp6(1),e.Q6J("ngIf",!(null!=a.entry.command&&a.entry.command.longDescription)),e.xp6(5),e.Q6J("ngIf",null==a.entry.command?null:a.entry.command.effectiveSignificance)("ngIfElse",c),e.xp6(5),e.Q6J("ngIf",null==a.entry.command?null:a.entry.command.constraint),e.xp6(1),e.Q6J("ngIf",!(null!=a.entry.command&&a.entry.command.constraint))}},dependencies:[u.sg,u.O5,r.Gj,D.d,Se.Q,Ne.U,L.U,u.Ov,r.yk,r.BC],styles:[".evaluation[_ngcontent-%COMP%]{font-family:Roboto Mono,monospace;background-color:#dc143c;color:#fff;padding-left:2px;padding-right:2px}.evaluation.valid[_ngcontent-%COMP%]{background-color:#adff2f;color:#000}"],changeDetection:0})}return n})(),Ye=(()=>{class n{transform(t){return t?"CommandComplete"===t?"Completed":t.replace("Acknowledge_",""):null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275pipe=e.Yjl({name:"acknowledgmentName",type:n,pure:!0})}return n})();const sr=["entryParent"];function rr(n,o){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"mat-divider",2),e.TgZ(2,"button",27),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.convertToJSON())}),e.TgZ(3,"mat-icon"),e._uU(4,"auto_awesome"),e.qZA(),e._uU(5," Convert to *.ycs file "),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("disabled",!t.format||t.converting)}}function lr(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"ya-detail-toolbar"),e._uU(2," Command Info "),e.qZA(),e.TgZ(3,"div",28),e._UZ(4,"app-stacked-command-detail",29),e.TgZ(5,"p"),e._uU(6,"\xa0"),e.qZA()(),e.BQk()),2&n){const t=o.ngIf;e.xp6(4),e.Q6J("entry",t)}}function mr(n,o){1&n&&(e.TgZ(0,"ya-detail-toolbar"),e._uU(1," Select an entry "),e.qZA())}function ur(n,o){1&n&&e._UZ(0,"input",41)}function dr(n,o){1&n&&e._UZ(0,"ya-dots")}function pr(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"form",30)(2,"div",31),e._uU(3," Advance when "),e._UZ(4,"app-advance-ack-help",32)(5,"br"),e.TgZ(6,"div",33),e._UZ(7,"ya-select",34,35),e.YNc(9,ur,1,0,"input",36),e.qZA()(),e.TgZ(10,"div",31),e._uU(11," Wait (ms) "),e.TgZ(12,"ya-help",37)(13,"p"),e._uU(14," Wait time before advancing to the next command in the stack. "),e.qZA(),e.TgZ(15,"p"),e._uU(16," This triggers after successful acknowledgment. "),e.qZA()(),e._UZ(17,"br")(18,"input",38),e.qZA(),e._UZ(19,"div",39),e.YNc(20,dr,1,0,"ya-dots",13),e.ALo(21,"async"),e.qZA(),e._UZ(22,"mat-divider",40),e.BQk()),2&n){const t=e.oxw();let i;e.xp6(1),e.Q6J("formGroup",t.stackOptionsForm)("ngClass",t.stackOptionsForm.disabled&&"disabled"),e.xp6(3),e.Q6J("extra",t.extraAcknowledgments),e.xp6(3),e.Q6J("options",t.ackOptions),e.xp6(2),e.Q6J("ngIf","custom"===(null==(i=t.stackOptionsForm.get("advancementAckDropDown"))?null:i.value)),e.xp6(11),e.Q6J("ngIf",e.lcZ(21,6,t.running$))}}function _r(n,o){1&n&&(e.TgZ(0,"ya-empty-message")(1,"mat-icon",42),e._uU(2,"link_off"),e.qZA(),e._uU(3," Unsupported command stack format "),e.qZA())}function gr(n,o){1&n&&(e.TgZ(0,"ya-empty-message"),e._uU(1," Empty command stack"),e._UZ(2,"br"),e._uU(3," Click "),e.TgZ(4,"mat-icon",43),e._uU(5,"add_circle_outline"),e.qZA(),e._uU(6," to start adding commands "),e.qZA())}function fr(n,o){1&n&&(e.ynx(0),e._uU(1," [*]: "),e.BQk())}function hr(n,o){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" [",t.executionNumber,"]: ")}}function xr(n,o){1&n&&(e.ynx(0),e._uU(1," [ ]: "),e.BQk())}function yr(n,o){if(1&n&&(e.TgZ(0,"mat-icon",53),e._uU(1," comment "),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("matTooltip",t.comment)}}function Tr(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"value"),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE(" [",t.key,": ",e.lcZ(2,2,t.value),"] ")}}function Cr(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",54),e._uU(2),e.qZA(),e.TgZ(3,"td",55),e._UZ(4,"ya-value",56),e.ALo(5,"tovalue"),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t.key," "),e.xp6(2),e.Q6J("value",e.lcZ(5,2,t.value))}}function br(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"acknowledgmentName"),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE(" Advance when ",e.lcZ(2,2,t.advancement.acknowledgment)," ",null!=t.advancement.wait?"+ "+t.advancement.wait+" ms":null," ")}}function Zr(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" Advance after ",t.advancement.wait," ms ")}}function vr(n,o){if(1&n&&(e.TgZ(0,"div",57)(1,"mat-icon"),e._uU(2,"reply"),e.qZA(),e.YNc(3,br,3,4,"span",13),e.YNc(4,Zr,2,1,"span",13),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",t.advancement.acknowledgment),e.xp6(1),e.Q6J("ngIf",!t.advancement.acknowledgment&&null!=t.advancement.wait)}}function Ar(n,o){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.err," ")}}function kr(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",61),e._UZ(2,"app-extra-acknowledgments-table",60),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(2),e.Q6J("command",t.record)("inline",!0)}}function wr(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"app-yamcs-acknowledgments-table",60),e.YNc(2,kr,3,2,"ng-container",13),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("command",t.record)("inline",!0),e.xp6(1),e.Q6J("ngIf",null==t.record?null:t.record.extra.length)}}function Sr(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",58)(1,"div",59),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,c=e.oxw();return e.KtG(c.selectEntry(a))}),e.qZA(),e.TgZ(2,"div",47),e.YNc(3,Ar,2,1,"ng-container",13),e.YNc(4,wr,3,3,"ng-container",13),e.qZA()()}if(2&n){const t=e.oxw().$implicit;e.xp6(2),e.ekj("err",t.err),e.xp6(1),e.Q6J("ngIf",t.err),e.xp6(1),e.Q6J("ngIf",!t.err)}}function Nr(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",44),e.NdJ("click",function(){const c=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.selectEntry(c))})("dblclick",function(){const c=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.editCommand(c))}),e.ALo(1,"async"),e.TgZ(2,"div",45)(3,"div",46),e.YNc(4,fr,2,0,"ng-container",13),e.YNc(5,hr,2,1,"ng-container",13),e.YNc(6,xr,2,0,"ng-container",13),e.qZA(),e.TgZ(7,"div",47),e._uU(8),e.YNc(9,yr,2,1,"mat-icon",48),e.YNc(10,Tr,3,4,"span",49),e.ALo(11,"keyvalue"),e.TgZ(12,"table",50),e.YNc(13,Cr,6,4,"tr",49),e.ALo(14,"keyvalue"),e.qZA(),e.YNc(15,vr,5,2,"div",51),e.qZA()(),e.YNc(16,Sr,5,4,"div",52),e.qZA()}if(2&n){const t=o.$implicit,i=e.oxw();e.ekj("selected",t===e.lcZ(1,11,i.selectedEntry$)),e.xp6(4),e.Q6J("ngIf",t.executing),e.xp6(1),e.Q6J("ngIf",!t.executing&&(0===t.executionNumber||t.executionNumber)),e.xp6(1),e.Q6J("ngIf",!t.executing&&0!==t.executionNumber&&!t.executionNumber),e.xp6(2),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",t.comment),e.xp6(1),e.Q6J("ngForOf",e.lcZ(11,13,t.extra)),e.xp6(3),e.Q6J("ngForOf",e.xi3(14,15,t.args,i.insertionOrder)),e.xp6(2),e.Q6J("ngIf",t.advancement),e.xp6(1),e.Q6J("ngIf",0===t.executionNumber||t.executionNumber)}}const Pr=function(n){return{c:n}};let G=(()=>{class n{constructor(t,i,a,c,s,m,d,_,y,f,h,b){this.dialog=t,this.yamcs=i,this.route=a,this.router=c,this.title=s,this.configService=m,this.messageService=d,this.sanitizer=_,this.basenamePipe=y,this.filenamePipe=f,this.extensionPipe=h,this.formBuilder=b,this.dirty$=new C.X(!1),this.entries$=new C.X([]),this.hasOutputs$=this.entries$.pipe((0,Os.U)(k=>{for(const B of k)if(B.record||B.err)return!0;return!1})),this.running$=new C.X(!1),this.runningStack=!1,this.selectedEntry$=new C.X(null),this.clipboardEntry$=new C.X(null),this.commandHistoryRecords=new Map,this.executionCounter=0,this.loaded=!1,this.converting=!1,this.advancement={acknowledgment:"Acknowledge_Queued",wait:0},this.acceptingAckValues=["OK","DISABLED"],this.stoppingAckValues=["NOK","CANCELLED"],this.nextCommandScheduled=!1,this.ackOptions=[{id:"Acknowledge_Queued",label:"Queued"},{id:"Acknowledge_Released",label:"Released"},{id:"Acknowledge_Sent",label:"Sent"},{id:"CommandComplete",label:"Completed"}],this.insertionOrder=(k,B)=>0,this.stackOptionsFormCallback=k=>{this.loaded&&(this.advancement={acknowledgment:"custom"!==k.advancementAckDropDown?k.advancementAckDropDown:k.advancementAckCustom,wait:k.advancementWait??0},"custom"!==k.advancementAckDropDown&&this.stackOptionsForm.patchValue({advancementAckCustom:void 0},{emitEvent:!1}),this.dirty$.next(!0))};const Z=m.getConfig();this.bucket=m.getStackBucket(),this.folderPerInstance=Z.displayFolderPerInstance,this.storageClient=i.createStorageClient(),this.extraAcknowledgments=i.getProcessor()?.acknowledgments??[];let A=!0;for(const k of this.extraAcknowledgments)this.ackOptions.push({id:k.name,label:k.name.replace("Acknowledge_",""),group:A}),A=!1;this.ackOptions.push({id:"custom",label:"Custom",group:!0}),this.stackOptionsForm=b.group({advancementAckDropDown:["",[]],advancementAckCustom:["",[]],advancementWait:["",[]]}),this.initStackFile()}initStackFile(){const t=this.getObjectNameFromUrl();this.loadFile(t),"ycs"!==this.format?this.stackOptionsForm.disable():(this.stackOptionsForm.enable(),this.stackOptionsForm.valueChanges.subscribe(this.stackOptionsFormCallback)),this.commandSubscription=this.yamcs.yamcsClient.createCommandSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,ignorePastCommands:!0},i=>{const a=i.id;let c=this.commandHistoryRecords.get(a);c=c?c.mergeEntry(i):new r.mq(i),this.commandHistoryRecords.set(a,c);for(const s of this.entries$.value)if(s.id===a){s.record=c;break}this.checkAckContinueRunning(c)})}handleDrop(t){t.previousIndex!==t.currentIndex&&((0,j.bA)(this.entries$.value,t.previousIndex,t.currentIndex),this.entries$.next([...this.entries$.value]),this.dirty$.next(!0))}getObjectNameFromUrl(){const t=this.route.snapshot.url;let i="";this.folderPerInstance&&(i+=this.yamcs.instance);for(const a of t)i&&(i+="/"),i+=a.path;return i}getNameWithoutInstance(t){return this.folderPerInstance?t.substring(this.yamcs.instance.length):t}loadFile(t){var i=this;return(0,q.Z)(function*(){i.objectName=t;const a=i.objectName.lastIndexOf("/");if(-1===a)i.folderLink="/commanding/stacks/browse/",i.filename=i.objectName;else{const m=i.getNameWithoutInstance(i.objectName.substring(0,a));i.folderLink="/commanding/stacks/browse/"+m,i.filename=i.objectName.substring(a+1)}i.title.setTitle(i.filename);const c=i.extensionPipe.transform(i.filenamePipe.transform(t))?.toLowerCase();if("ycs"!==c&&"xml"!==c)return void(i.loaded=!0);i.format=c;const s=yield i.storageClient.getObject(i.bucket,t).catch(m=>{404===m.statusCode&&"xml"===c?i.router.navigate([t.replace(/\.xml$/i,".ycs")],{queryParamsHandling:"preserve",relativeTo:i.route.parent}).then(()=>i.initStackFile()):i.messageService.showError("Failed to load stack file '"+t+"'")});if(s?.ok){const m=yield s.text();let d;switch(i.format){case"ycs":[d,i.advancement]=i.parseJSON(m);const f=i.ackOptions.find(A=>A.id===i.advancement.acknowledgment),h=f?f.id:"custom";i.stackOptionsForm.setValue({advancementAckDropDown:h,advancementAckCustom:"custom"===h?i.advancement.acknowledgment:"",advancementWait:i.advancement.wait});break;case"xml":const Z=(new DOMParser).parseFromString(m,"text/xml");d=n.parseXML(Z.documentElement,i.configService.getCommandOptions())}const _=[],y=i.yamcs.instance;for(const f of d)_.push(i.yamcs.yamcsClient.getCommandForNamespace(y,f.namespace??null,f.name).then(Z=>{f.command=Z}));for(const f of _)try{yield f}catch{}for(const f of d)if(f.command)for(const h in f.args){const b=i.getArgument(h,f.command);if("enumeration"===b?.type.engType){let Z=!1;for(const A of b.type.enumValue||[])if(A.label===f.args[h]){Z=!0;break}if(!Z)for(const A of b.type.enumValue||[])if(String(A.value)===String(f.args[h])){f.args[h]=A.label,Z=!0;break}}}if("xml"===i.format)for(const f of d)if(f.command)for(const h in f.args)i.isComplex(h,f.command)&&(f.args[h]=JSON.parse(f.args[h]));i.entries$.next(d),i.selectedEntry$.next(d.length?d[0]:null),i.loaded=!0}})()}isComplex(t,i){for(const a of i.argument||[])if(a.name===t)return"aggregate"===a.type.engType||a.type.engType.endsWith("[]");return!!i.baseCommand&&this.isComplex(t,i.baseCommand)}getArgument(t,i){for(const a of i.argument||[])if(a.name===t)return a;return i.baseCommand?this.getArgument(t,i.baseCommand):null}parseJSON(t){const i=[],a=JSON.parse(t);if(a.commands)for(let s of a.commands)i.push(this.parseJSONentry(s));return[i,{acknowledgment:a.advancement?.acknowledgment||"Acknowledge_Queued",wait:null!=a.advancement?.wait?a.advancement?.wait:0}]}parseJSONentry(t){return{name:t.name,namespace:t.namespace,...t.comment&&{comment:t.comment},...t.extraOptions&&{extra:this.parseJSONextraOptions(t.extraOptions)},...t.arguments&&{args:this.parseJSONcommandArguments(t.arguments)},...t.advancement&&{advancement:t.advancement}}}parseJSONextraOptions(t){const i={};for(let a of t){const c=n.convertOptionStringToValue(a.id,new String(a.value).toString(),this.configService.getCommandOptions());c&&(i[a.id]=c)}return i}parseJSONcommandArguments(t){const i={};for(let a of t)i[a.name]=a.value;return i}static parseXML(t,i){const a=[];for(let c=0;c<t.childNodes.length;c++){const s=t.childNodes[c];if(3!==s.nodeType&&"command"===s.nodeName){const m=this.parseXMLEntry(s,i);a.push(m)}}return a}static parseXMLEntry(t,i){const a={},c={};for(let m=0;m<t.childNodes.length;m++){const d=t.childNodes[m];if("commandArgument"===d.nodeName){const _=this.getStringAttribute(d,"argumentName");a[_]=this.getStringAttribute(d,"argumentValue"),"true"===a[_]?a[_]=!0:"false"===a[_]&&(a[_]=!1)}else if("extraOptions"===d.nodeName)for(let _=0;_<d.childNodes.length;_++){const y=d.childNodes[_];if("extraOption"===y.nodeName){const f=this.getStringAttribute(y,"id"),h=this.getStringAttribute(y,"value"),b=this.convertOptionStringToValue(f,h,i);b&&(c[f]=b)}}}const s={name:this.getStringAttribute(t,"qualifiedName"),args:a,extra:c,executing:!1};return t.hasAttribute("comment")&&(s.comment=this.getStringAttribute(t,"comment")),s}selectEntry(t){this.selectedEntry$.next(t)}deleteSelectedCommands(){const t=this.selectedEntry$.value;if(t){const i=this.entries$.value.indexOf(t);-1!==i&&(this.entries$.value.splice(i,1),this.entries$.next([...this.entries$.value]),this.selectedEntry$.next(null),this.dirty$.next(!0))}}clearSelectedOutputs(){const t=this.selectedEntry$.value;t&&(t.executionNumber=void 0,t.id=void 0,t.record=void 0,t.err=void 0)}clearOutputs(){for(const t of this.entries$.value)t.executionNumber=void 0,t.id=void 0,t.record=void 0,t.err=void 0;this.executionCounter=0,this.entries$.next([...this.entries$.value]),this.entries$.value.length&&this.selectEntry(this.entries$.value[0])}hasPendingChanges(){return this.dirty$.value}runSelection(){var t=this;return(0,q.Z)(function*(){const i=t.selectedEntry$.value;i&&(t.running$.next(!0),t.runEntry(i))})()}runEntry(t){var i=this;return(0,q.Z)(function*(){const a=++i.executionCounter,{instance:c,processor:s}=i.yamcs;return i.yamcs.yamcsClient.issueCommandForNamespace(c,s,t.namespace??null,t.name,{sequenceNumber:a,args:t.args,extra:t.extra}).then(d=>{t.executionNumber=a,t.executing=!0,t.id=d.id;const _=i.commandHistoryRecords.get(t.id);_&&(t.record=_,i.checkAckContinueRunning(_))}).catch(d=>{t.executionNumber=a,t.executing=!1,t.err=d.message||d,i.stopRun()}).finally(()=>{i.entries$.next([...i.entries$.value])})})()}runFromSelection(){let t=this.selectedEntry$.value;t?(this.running$.next(!0),this.runningStack=!0,this.nextCommandScheduled=!1,this.runEntry(t)):this.stopRun()}checkAckContinueRunning(t){if(!this.running$.value||this.nextCommandScheduled)return;let i=this.selectedEntry$.value,a=i?.advancement?.acknowledgment||this.advancement.acknowledgment,c=i?.advancement?.wait??this.advancement.wait;if(i?.id===t.id){let s=t.acksByName[a];s&&s.status&&(this.acceptingAckValues.includes(s.status)?(this.nextCommandScheduled=this.runningStack,this.nextCommandDelayTimeout=window.setTimeout(()=>{i.executing=!1,this.running$.value&&i&&(this.advanceSelection(i),this.runningStack?this.runFromSelection():this.stopRun())},Math.max(c,0))):this.stoppingAckValues.includes(s.status)&&(i.executing=!1,this.stopRun()))}}stopRun(){this.running$.next(!1),this.runningStack=!1;for(const t of this.entries$.value)t.executing=!1;window.clearTimeout(this.nextCommandDelayTimeout),this.nextCommandScheduled=!1}advanceSelection(t){const i=this.entries$.value,a=i.indexOf(t);if(a<i.length-1){this.selectEntry(i[a+1]);const m=this.entryParent.nativeElement.getElementsByClassName("entry")[a+1];this.isVisible(m)||m.scrollIntoView()}else this.selectedEntry$.next(null)}isVisible(t){const i=t.getBoundingClientRect(),a=Math.max(document.documentElement.clientHeight,window.innerHeight);return!(i.bottom<0||i.top-a>=0)}static convertOptionStringToValue(t,i,a){for(const c of a)if(c.id===t)switch(c.type){case"BOOLEAN":return{type:"BOOLEAN",booleanValue:"true"===i};case"NUMBER":return{type:"SINT32",sint32Value:Number(i)};default:return{type:"STRING",stringValue:i}}return null}addCommand(){this.dialog.open(Me,{width:"70%",height:"100%",autoFocus:!1,position:{right:"0"},panelClass:"dialog-full-size",data:{okLabel:"ADD TO STACK",format:this.format}}).afterClosed().subscribe(i=>{if(i){const a={name:i.command.qualifiedName,args:i.args,comment:i.comment,extra:i.extra,command:i.command,...i.stackOptions.advancement&&{advancement:i.stackOptions.advancement}},c=this.configService.getConfig();if(c.preferredNamespace)for(const m of i.command.alias||[])if(m.namespace===c.preferredNamespace){a.name=m.name,a.namespace=m.namespace;break}const s=this.selectedEntry$.value;if(s){const m=this.entries$.value,d=m.indexOf(s);m.splice(d+1,0,a),this.entries$.next([...this.entries$.value])}else this.entries$.next([...this.entries$.value,a]);this.selectEntry(a),this.dirty$.next(!0)}})}editSelectedCommand(){this.editCommand(this.selectedEntry$.value)}editCommand(t){return this.selectEntry(t),this.dialog.open(Me,{width:"70%",height:"100%",autoFocus:!1,position:{right:"0"},panelClass:"dialog-full-size",data:{okLabel:"UPDATE",entry:t,format:this.format}}).afterClosed().subscribe(a=>{if(a){const c={name:a.command.qualifiedName,args:a.args,comment:a.comment,extra:a.extra,command:a.command,...a.stackOptions.advancement&&{advancement:a.stackOptions.advancement}},s=this.configService.getConfig();if(s.preferredNamespace)for(const _ of a.command.alias||[])if(_.namespace===s.preferredNamespace){c.name=_.name,c.namespace=_.namespace;break}const m=this.entries$.value,d=m.indexOf(t);m.splice(d,1,c),this.entries$.next([...this.entries$.value]),this.selectEntry(c),this.dirty$.next(!0)}}),!1}cutSelectedCommand(){const t=this.selectedEntry$.value;this.advanceSelection(t),this.clipboardEntry$.next(t);const i=this.entries$.value,a=i.indexOf(t);i.splice(a,1),this.entries$.next([...this.entries$.value]),this.dirty$.next(!0)}copySelectedCommand(){this.clipboardEntry$.next(this.selectedEntry$.value)}pasteCommand(){const t=this.clipboardEntry$.value;if(t){const i={name:t.name,namespace:t.namespace,args:{...t.args},comment:t.comment,command:t.command,executing:!1};t.extra&&(i.extra={...t.extra}),t.advancement&&(i.advancement={...t.advancement});const a=this.selectedEntry$.value;if(a){const c=this.entries$.value,s=c.indexOf(a);c.splice(s+1,0,i),this.entries$.next([...this.entries$.value])}else this.entries$.next([...this.entries$.value,i]);this.selectEntry(i),this.dirty$.next(!0)}}saveStack(){let t;switch(this.format){case"ycs":t=new r.S7(this.entries$.value,{advancement:this.advancement}).toJSON();break;case"xml":t=new r.S7(this.entries$.value,{advancement:this.advancement}).toXML()}const a=new Blob([t],{type:"xml"===this.format?"application/xml":"application/json"});return this.storageClient.uploadObject(this.bucket,this.objectName,a).then(()=>{this.dirty$.next(!1)})}setExportURLs(){const t=new r.S7(this.entries$.value,{advancement:this.advancement}),i=new Blob([t.toJSON()],{type:"application/json"});this.JSONblobURL=this.sanitizer.bypassSecurityTrustResourceUrl(URL.createObjectURL(i));const a=new Blob([t.toXML()],{type:"application/xml"});this.XMLblobURL=this.sanitizer.bypassSecurityTrustResourceUrl(URL.createObjectURL(a))}static getStringAttribute(t,i){const a=t.attributes.getNamedItem(i);if(null===a)throw new Error(`No attribute named ${i}`);return a.textContent||""}convertToJSON(){var t=this;return(0,q.Z)(function*(){t.converting||confirm(`Are you sure you want to convert '${t.objectName}' to the new format?\nThis will delete the original XML file.`)&&(t.converting=!0,t.dirty$.value&&(yield t.saveStack()),n.convertToJSON(t.messageService,t.basenamePipe,t.storageClient,t.bucket,t.objectName,t.entries$.value,{advancement:t.advancement}).then(i=>{t.router.navigate([i+".ycs"],{queryParamsHandling:"preserve",relativeTo:t.route.parent}).then(()=>t.initStackFile())}).finally(()=>t.converting=!1))})()}static convertToJSON(t,i,a,c,s,m,d){return(0,q.Z)(function*(){const _=new r.S7(m,d),y=new Blob([_.toJSON()],{type:"application/json"}),f=i.transform(s);return f?(yield a.uploadObject(c,f+".ycs",y),yield a.deleteObject(c,s),f):(t.showError("Failed to convert command stack"),void console.error("Failed to convert command stack due to objectName"))})()}ngOnDestroy(){this.commandSubscription?.cancel(),this.stackOptionsForm.reset()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x.uw),e.Y36(r.C8),e.Y36(T.gz),e.Y36(T.F0),e.Y36(Q.Dx),e.Y36(r.E4),e.Y36(r.ez),e.Y36(Q.H7),e.Y36(r.uu),e.Y36(r.XB),e.Y36(r.FG),e.Y36(l.qu))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(i,a){if(1&i&&e.Gf(sr,5),2&i){let c;e.iGM(c=e.CRH())&&(a.entryParent=c.first)}},decls:92,vars:72,consts:[["mat-icon-button","","color","primary",3,"routerLink","queryParams"],["mat-button","","color","primary","matTooltip","Save stack",3,"disabled","click"],["vertical","",2,"height","100%"],["mat-icon-button","","color","primary","matTooltip","Add a command below",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Edit the selected command",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Cut the selected command",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Copy the selected command",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Paste command from the clipboard",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Run the selected command",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Stop current execution",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Clear all outputs",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Run all from selected command",3,"disabled","click"],["mat-button","","color","primary","matTooltip","Export command stack",3,"matMenuTriggerFor","disabled","click"],[4,"ngIf"],[1,"ya-menu"],["exportMenu","matMenu"],["mat-menu-item","",3,"href","download"],["mat-menu-item","","title","Certain features are not implemented for XML, the format will be phased out gradually",3,"href","download"],[2,"vertical-align","middle"],[2,"color","#CC0000"],[4,"ngIf","ngIfElse"],["noSelection",""],[1,"panel-wrapper"],["cdkDropList","",1,"panel-content",3,"cdkDropListDropped"],["entryParent",""],["id","drag-boundary"],["cdkDrag","","cdkDragBoundary","#drag-boundary","class","entry",3,"selected","click","dblclick",4,"ngFor","ngForOf"],["mat-button","","color","warn","matTooltip","Convert to the newer format",3,"disabled","click"],[2,"padding","0 16px"],[3,"entry"],[1,"ya-form","panel-content","stack-options",3,"formGroup","ngClass"],[1,"label"],[3,"extra"],[2,"display","flex","align-items","flex-start"],["icon","check_circle_outline","formControlName","advancementAckDropDown",3,"options"],["ackSelect",""],["type","text","formControlName","advancementAckCustom","style","width: 200px; margin-left: -1px",4,"ngIf"],["dialogTitle","Wait time"],["type","number","formControlName","advancementWait","placeholder","0","step","1000","min","0",2,"width","120px"],[2,"flex","1 1 auto"],["horizontal",""],["type","text","formControlName","advancementAckCustom",2,"width","200px","margin-left","-1px"],[2,"vertical-align","bottom","margin-right","10px"],["inline","",2,"vertical-align","bottom"],["cdkDrag","","cdkDragBoundary","#drag-boundary",1,"entry",3,"click","dblclick"],[1,"in"],["cdkDragHandle","",1,"seq"],[1,"body"],["class","icon14","style","vertical-align: middle;",3,"matTooltip",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"args"],["class","advance-on",4,"ngIf"],["class","out",4,"ngIf"],[1,"icon14",2,"vertical-align","middle",3,"matTooltip"],["width","1",1,"key"],[1,"value"],[3,"value"],[1,"advance-on"],[1,"out"],[1,"seq",3,"click"],[3,"command","inline"],[1,"block"]],template:function(i,a){if(1&i&&(e.TgZ(0,"app-instance-page")(1,"app-instance-toolbar")(2,"a",0)(3,"mat-icon"),e._uU(4,"arrow_back"),e.qZA()(),e._uU(5),e.ALo(6,"basename"),e.TgZ(7,"button",1),e.NdJ("click",function(){return a.saveStack()}),e.ALo(8,"async"),e.TgZ(9,"mat-icon"),e._uU(10,"save"),e.qZA(),e._uU(11," Save "),e.qZA(),e._UZ(12,"mat-divider",2),e.TgZ(13,"button",3),e.NdJ("click",function(){return a.addCommand()}),e.ALo(14,"async"),e.TgZ(15,"mat-icon"),e._uU(16,"add_circle_outline"),e.qZA()(),e.TgZ(17,"button",4),e.NdJ("click",function(){return a.editSelectedCommand()}),e.ALo(18,"async"),e.ALo(19,"async"),e.TgZ(20,"mat-icon"),e._uU(21,"edit"),e.qZA()(),e.TgZ(22,"button",5),e.NdJ("click",function(){return a.cutSelectedCommand()}),e.ALo(23,"async"),e.ALo(24,"async"),e.TgZ(25,"mat-icon"),e._uU(26,"content_cut"),e.qZA()(),e.TgZ(27,"button",6),e.NdJ("click",function(){return a.copySelectedCommand()}),e.ALo(28,"async"),e.ALo(29,"async"),e.TgZ(30,"mat-icon"),e._uU(31,"content_copy"),e.qZA()(),e.TgZ(32,"button",7),e.NdJ("click",function(){return a.pasteCommand()}),e.ALo(33,"async"),e.ALo(34,"async"),e.TgZ(35,"mat-icon"),e._uU(36,"content_paste"),e.qZA()(),e._UZ(37,"mat-divider",2),e.TgZ(38,"button",8),e.NdJ("click",function(){return a.runSelection()}),e.ALo(39,"async"),e.ALo(40,"async"),e.TgZ(41,"mat-icon"),e._uU(42,"play_arrow"),e.qZA()(),e.TgZ(43,"button",9),e.NdJ("click",function(){return a.stopRun()}),e.ALo(44,"async"),e.TgZ(45,"mat-icon"),e._uU(46,"stop"),e.qZA()(),e.TgZ(47,"button",10),e.NdJ("click",function(){return a.clearOutputs()}),e.ALo(48,"async"),e.ALo(49,"async"),e.TgZ(50,"mat-icon"),e._uU(51,"refresh"),e.qZA()(),e.TgZ(52,"button",11),e.NdJ("click",function(){return a.runFromSelection()}),e.ALo(53,"async"),e.ALo(54,"async"),e.TgZ(55,"mat-icon"),e._uU(56,"playlist_play"),e.qZA()(),e._UZ(57,"mat-divider",2),e.TgZ(58,"button",12),e.NdJ("click",function(){return a.setExportURLs()}),e.TgZ(59,"mat-icon"),e._uU(60,"open_in_new"),e.qZA(),e._uU(61," Export "),e.qZA(),e.YNc(62,rr,6,1,"ng-container",13),e.TgZ(63,"mat-menu",14,15)(65,"a",16),e.ALo(66,"basename"),e.TgZ(67,"mat-icon"),e._uU(68,"data_object"),e.qZA(),e._uU(69," YCS FILE "),e.qZA(),e.TgZ(70,"a",17),e.ALo(71,"basename"),e.TgZ(72,"mat-icon"),e._uU(73,"code"),e.qZA(),e.TgZ(74,"span",18),e._uU(75," XML FILE "),e.TgZ(76,"span",19),e._uU(77,"(legacy)"),e.qZA()()()()(),e.TgZ(78,"ya-detail-pane"),e.YNc(79,lr,7,1,"ng-container",20),e.ALo(80,"async"),e.YNc(81,mr,2,0,"ng-template",null,21,e.W1O),e.qZA(),e.TgZ(83,"div",22),e.YNc(84,pr,23,8,"ng-container",13),e.YNc(85,_r,4,0,"ya-empty-message",13),e.YNc(86,gr,7,0,"ya-empty-message",13),e.TgZ(87,"div",23,24),e.NdJ("cdkDropListDropped",function(s){return a.handleDrop(s)}),e.TgZ(89,"div",25),e.YNc(90,Nr,17,18,"div",26),e.ALo(91,"async"),e.qZA()()()()),2&i){const c=e.MAs(64),s=e.MAs(82);e.xp6(2),e.Q6J("routerLink",a.folderLink)("queryParams",e.VKq(70,Pr,a.yamcs.context)),e.xp6(3),e.hij(" ",e.lcZ(6,26,a.filename)," \xa0\xa0\xa0 "),e.xp6(2),e.Q6J("disabled",!a.format||!e.lcZ(8,28,a.dirty$)),e.xp6(6),e.Q6J("disabled",!a.format||e.lcZ(14,30,a.running$)),e.xp6(4),e.Q6J("disabled",!a.format||e.lcZ(18,32,a.running$)||!e.lcZ(19,34,a.selectedEntry$)),e.xp6(5),e.Q6J("disabled",!a.format||e.lcZ(23,36,a.running$)||!e.lcZ(24,38,a.selectedEntry$)),e.xp6(5),e.Q6J("disabled",!a.format||e.lcZ(28,40,a.running$)||!e.lcZ(29,42,a.selectedEntry$)),e.xp6(5),e.Q6J("disabled",!a.format||e.lcZ(33,44,a.running$)||!e.lcZ(34,46,a.clipboardEntry$)),e.xp6(6),e.Q6J("disabled",!a.format||e.lcZ(39,48,a.running$)||!e.lcZ(40,50,a.selectedEntry$)),e.xp6(5),e.Q6J("disabled",!a.format||!e.lcZ(44,52,a.running$)),e.xp6(4),e.Q6J("disabled",!a.format||e.lcZ(48,54,a.running$)||!e.lcZ(49,56,a.hasOutputs$)),e.xp6(5),e.Q6J("disabled",!a.format||e.lcZ(53,58,a.running$)||!e.lcZ(54,60,a.selectedEntry$)),e.xp6(6),e.Q6J("matMenuTriggerFor",c)("disabled",!a.format),e.xp6(4),e.Q6J("ngIf","xml"===a.format),e.xp6(3),e.Q6J("href",a.JSONblobURL,e.LSH)("download",e.lcZ(66,62,a.filename)+".ycs"),e.xp6(5),e.Q6J("href",a.XMLblobURL,e.LSH)("download",e.lcZ(71,64,a.filename)+".xml"),e.xp6(9),e.Q6J("ngIf",e.lcZ(80,66,a.selectedEntry$))("ngIfElse",s),e.xp6(5),e.Q6J("ngIf","ycs"===a.format),e.xp6(1),e.Q6J("ngIf",a.loaded&&!a.format),e.xp6(1),e.Q6J("ngIf",a.loaded&&a.format&&!a.entries$.value.length),e.xp6(4),e.Q6J("ngForOf",e.lcZ(91,68,a.entries$))}},dependencies:[u.mk,u.sg,u.O5,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.qQ,l.sg,l.u,T.rH,j.Wj,j.Zt,j.Bh,O.lW,O.o6,O.RK,S.Hw,D.d,w.VK,w.OP,w.p6,U.gM,r.J8,r.MD,r.Zy,r.RR,r.IR,r.Hr,r.u$,N.a,P.k,De,ye,cr,Ce,u.Ov,u.Nd,r.uu,r.GI,r.VC,Ye],styles:[".panel-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.ya-data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:top}table.args[_ngcontent-%COMP%]{margin:0 0 0 10px;font-size:10px}table.args[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:0;border:0}table.args[_ngcontent-%COMP%]   td.key[_ngcontent-%COMP%]{min-width:120px;white-space:nowrap}table.args[_ngcontent-%COMP%]   td.value[_ngcontent-%COMP%]{color:gray;padding-left:10px}div.entry[_ngcontent-%COMP%]{font-size:13px;line-height:17px}div.entry[_ngcontent-%COMP%]   div.in[_ngcontent-%COMP%], div.entry[_ngcontent-%COMP%]   div.out[_ngcontent-%COMP%]{display:flex;border-left:8px solid transparent;margin-bottom:10px}div.entry.selected[_ngcontent-%COMP%]   div.in[_ngcontent-%COMP%], div.entry.selected[_ngcontent-%COMP%]   div.out[_ngcontent-%COMP%]{border-color:#009e87}div.entry[_ngcontent-%COMP%]   .seq[_ngcontent-%COMP%]{width:64px;text-align:right;padding-top:5px;padding-right:10px;user-select:none;-webkit-user-select:none;-moz-user-select:none;-khtml-user-select:none;font-family:Roboto Mono,monospace;color:#bdbdbd}div.entry[_ngcontent-%COMP%]   div.in[_ngcontent-%COMP%]   .seq[_ngcontent-%COMP%]{cursor:move}div.entry.selected[_ngcontent-%COMP%]   .seq[_ngcontent-%COMP%]{color:#009e87}div.entry[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1;padding:5px}div.entry[_ngcontent-%COMP%]   div.in[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{background-color:#fafafa;border:1px solid rgb(224,224,224);font-family:Roboto Mono,monospace}div.entry[_ngcontent-%COMP%]   div.out[_ngcontent-%COMP%]   .body.err[_ngcontent-%COMP%]{background-color:#fcc;color:#dc143c}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.6}.advance-on[_ngcontent-%COMP%]{color:gray;font-size:12px}.advance-on[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{vertical-align:middle}.advance-on[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{transform:rotate(180deg);font-size:12px;height:12px;width:12px}form.stack-options[_ngcontent-%COMP%]{line-height:0;display:flex;align-items:flex-start}.stack-options[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:inline-block;width:unset;margin-right:1em;margin-top:0}.disabled[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{opacity:.6}"],changeDetection:0})}return n})();var Fe=g(5592),Ur=g(2096);let Qr=(()=>{class n{constructor(t){this.dialogRef=t}confirmDiscard(){this.dialogRef.close(!0)}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x.so))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-stack-file-page-dirty-dialog"]],decls:10,vars:0,consts:[[1,"mat-typography"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click"]],template:function(i,a){1&i&&(e.TgZ(0,"mat-dialog-content",0)(1,"h3"),e._uU(2,"Close without saving?"),e.qZA(),e.TgZ(3,"p"),e._uU(4,"You have unsaved changes, close without saving?"),e.qZA()(),e.TgZ(5,"mat-dialog-actions",1)(6,"button",2),e._uU(7,"CANCEL"),e.qZA(),e.TgZ(8,"button",3),e.NdJ("click",function(){return a.confirmDiscard()}),e._uU(9," OK "),e.qZA()())},dependencies:[x.ZT,x.xY,x.H8],encapsulation:2})}return n})(),$e=(()=>{class n{constructor(t,i,a){this.dialog=t,this.authService=i,this.dialogOpen$=new C.X(!1),this.bucket=a.getStackBucket()}canDeactivate(t){return this.dialogOpen$.value?Fe.y.create(i=>{this.dialogRef.afterClosed().subscribe(a=>{i.next(!0===a),i.complete()},a=>{i.next(!1),i.complete()})}):t.hasPendingChanges()&&this.mayManageStacks()?Fe.y.create(i=>{this.dialogOpen$.next(!0),this.dialogRef=this.dialog.open(Qr,{width:"400px"}),this.dialogRef.afterClosed().subscribe(a=>{this.dialogOpen$.next(!1),i.next(!0===a),i.complete()},a=>{this.dialogOpen$.next(!1),i.next(!1),i.complete()})}):(0,Ur.of)(!0)}mayManageStacks(){const t=this.authService.getUser();return t.hasObjectPrivilege("ManageBucket",this.bucket)||t.hasSystemPrivilege("ManageAnyBucket")}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(x.uw),e.LFG(Y.e),e.LFG(r.E4))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac})}return n})();var Or=g(2181),Ir=g(1087);let Jr=(()=>{class n{constructor(t,i,a,c){this.dialogRef=t,this.data=c,this.storageClient=a.createStorageClient(),this.form=i.group({name:["",l.kI.required]})}save(){let{path:t,bucket:i}=this.data;t.startsWith("/")&&(t=t.substring(1));const a=this.form.value.name;this.storageClient.uploadObject(i,t?`${t}/${a}/`:`${a}/`,new Blob).then(()=>this.dialogRef.close(!0))}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x.so),e.Y36(l.QS),e.Y36(r.C8),e.Y36(x.WI))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:12,vars:2,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name","pattern","\\w[\\w\\s\\.\\-\\(\\)\\[\\]]*"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(i,a){1&i&&(e.TgZ(0,"h2",0),e._uU(1,"Create folder"),e.qZA(),e.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),e._uU(5," Folder name "),e._UZ(6,"input",3),e.qZA()()(),e.TgZ(7,"mat-dialog-actions",4)(8,"button",5),e._uU(9,"CANCEL"),e.qZA(),e.TgZ(10,"button",6),e.NdJ("click",function(){return a.save()}),e._uU(11,"CREATE"),e.qZA()()),2&i&&(e.xp6(3),e.Q6J("formGroup",a.form),e.xp6(7),e.Q6J("disabled",!a.form.valid))},dependencies:[l._Y,l.Fj,l.JJ,l.JL,l.c5,l.sg,l.u,x.ZT,x.uh,x.xY,x.H8],encapsulation:2,changeDetection:0})}return n})();const Dr=["filename"];let Mr=(()=>{class n{constructor(t,i,a,c,s){this.dialogRef=t,this.data=s,this.bucket=c.getStackBucket(),this.storageClient=a.createStorageClient(),this.filenameForm=i.group({name:["",[l.kI.required]],format:["ycs",[l.kI.required]]})}save(){const t=this.filenameForm.get("format").value,i=this.filenameForm.get("name").value.trim()+"."+t;let a=this.data.path;a.startsWith("/")&&(a=a.substring(1));const c=a?a+"/"+i:i,s=this.data.prefix+c,m="xml"===t?new r.S7([],{}).toXML():new r.S7([],{}).toJSON(),_=new Blob([m],{type:"xml"===t?"application/xml":"application/json"});this.storageClient.uploadObject(this.bucket,s,_).then(()=>{this.dialogRef.close(c)})}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x.so),e.Y36(l.QS),e.Y36(r.C8),e.Y36(r.E4),e.Y36(x.WI))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-create-stack-dialog"]],viewQuery:function(i,a){if(1&i&&e.Gf(Dr,5),2&i){let c;e.iGM(c=e.CRH())&&(a.filenameInput=c.first)}},decls:21,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name"],["filename",""],["formControlName","format"],["value","ycs"],["value","xml"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(i,a){if(1&i&&(e.TgZ(0,"h2",0),e._uU(1,"Create stack"),e.qZA(),e.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),e._uU(5," Name "),e._UZ(6,"input",3,4),e.qZA(),e._UZ(8,"br"),e.TgZ(9,"label"),e._uU(10," Format "),e.TgZ(11,"select",5)(12,"option",6),e._uU(13,"YCS"),e.qZA(),e.TgZ(14,"option",7),e._uU(15,"XML (deprecated)"),e.qZA()()()()(),e.TgZ(16,"mat-dialog-actions",8)(17,"button",9),e._uU(18,"CANCEL"),e.qZA(),e.TgZ(19,"button",10),e.NdJ("click",function(){return a.save()}),e._uU(20,"SAVE"),e.qZA()()),2&i){let c;e.xp6(3),e.Q6J("formGroup",a.filenameForm),e.xp6(1),e.ekj("invalid",null==(c=a.filenameForm.get("name"))?null:c.invalid),e.xp6(15),e.Q6J("disabled",!a.filenameForm.valid)}},dependencies:[l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,l.sg,l.u,x.ZT,x.uh,x.xY,x.H8],encapsulation:2})}return n})(),Yr=(()=>{class n{constructor(t,i,a,c,s,m,d,_){this.dialogRef=t,this.filenamePipe=s,this.extensionPipe=m,this.data=_,this.storageClient=a.createStorageClient(),this.bucket=d.getStackBucket();const y=c.transform(s.transform(this.data.name));this.filenameForm=i.group({name:[y,[l.kI.required]]})}rename(){var t=this;return(0,q.Z)(function*(){let i;const a=t.data.name.lastIndexOf("/");-1!==a&&(i=t.data.name.substring(0,a+1));const s=yield(yield t.storageClient.getObject(t.bucket,t.data.name)).blob(),m=t.extensionPipe.transform(t.filenamePipe.transform(t.data.name))?.toLowerCase(),d=(i||"")+t.filenameForm.get("name").value+(m?"."+m:"");d!==t.data.name&&(yield t.storageClient.uploadObject(t.bucket,d,s),yield t.storageClient.deleteObject(t.bucket,t.data.name)),t.dialogRef.close(d)})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x.so),e.Y36(l.QS),e.Y36(r.C8),e.Y36(r.uu),e.Y36(r.XB),e.Y36(r.FG),e.Y36(r.E4),e.Y36(x.WI))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-rename-stack-dialog"]],decls:13,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name"],["filename",""],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(i,a){if(1&i&&(e.TgZ(0,"h2",0),e._uU(1,"Rename stack"),e.qZA(),e.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),e._uU(5," Name "),e._UZ(6,"input",3,4),e.qZA()()(),e.TgZ(8,"mat-dialog-actions",5)(9,"button",6),e._uU(10,"CANCEL"),e.qZA(),e.TgZ(11,"button",7),e.NdJ("click",function(){return a.rename()}),e._uU(12,"RENAME"),e.qZA()()),2&i){let c;e.xp6(3),e.Q6J("formGroup",a.filenameForm),e.xp6(1),e.ekj("invalid",null==(c=a.filenameForm.get("name"))?null:c.invalid),e.xp6(7),e.Q6J("disabled",!a.filenameForm.valid)}},dependencies:[l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,x.ZT,x.uh,x.xY,x.H8],encapsulation:2})}return n})();const Fr=["droparea"],$r=["uploader"];function Lr(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.createStack())}),e.TgZ(1,"mat-icon"),e._uU(2,"add_circle_outline"),e.qZA(),e._uU(3," Create stack "),e.qZA()}}function Er(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.openUploadDialog())}),e.TgZ(1,"mat-icon"),e._uU(2,"file_upload"),e.qZA(),e._uU(3," Upload stack "),e.TgZ(4,"input",10,11),e.NdJ("change",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.importStack())}),e.qZA()()}}function Hr(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.createFolder())}),e.TgZ(1,"mat-icon"),e._uU(2,"create_new_folder"),e.qZA(),e._uU(3," Create folder "),e.qZA()}}function Br(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.deleteSelectedStacks())}),e.TgZ(1,"mat-icon"),e._uU(2,"delete"),e.qZA(),e._uU(3," Delete "),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",!t.selection.hasValue())}}const W=function(n){return{c:n}};function Rr(n,o){if(1&n&&e._UZ(0,"ya-breadcrumb",15),2&n){const t=o.$implicit,i=e.oxw(3);e.Q6J("link",t.route)("queryParams",e.VKq(3,W,i.yamcs.context))("label",t.name)}}function Vr(n,o){if(1&n&&(e.TgZ(0,"ya-breadcrumb-trail"),e._UZ(1,"ya-breadcrumb",13),e.YNc(2,Rr,1,5,"ya-breadcrumb",14),e.qZA()),2&n){const t=e.oxw().ngIf,i=e.oxw();e.xp6(1),e.Q6J("queryParams",e.VKq(2,W,i.yamcs.context)),e.xp6(1),e.Q6J("ngForOf",t)}}function jr(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Vr,3,4,"ya-breadcrumb-trail",6),e.BQk()),2&n){const t=o.ngIf;e.xp6(1),e.Q6J("ngIf",t.length)}}function Gr(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"input",34),e.NdJ("change",function(a){e.CHM(t);const c=e.oxw(3);return e.KtG(a?c.masterToggle():null)}),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("checked",t.selection.hasValue()&&t.isAllSelected())}}function Wr(n,o){if(1&n&&(e.TgZ(0,"th",32),e.YNc(1,Gr,1,1,"input",33),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.mayManageStacks())}}function Xr(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"input",37),e.NdJ("click",function(a){return a.stopPropagation()})("change",function(a){e.CHM(t);const c=e.oxw().$implicit,s=e.oxw(2);return e.KtG(a?s.selection.toggle(c):null)}),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("checked",i.selection.isSelected(t))}}function zr(n,o){if(1&n&&(e.TgZ(0,"td",35),e.YNc(1,Xr,1,1,"input",36),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.mayManageStacks())}}function Kr(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1,"Name"),e.qZA())}function el(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-icon",40),e._uU(2,"folder"),e.qZA(),e.TgZ(3,"a",41),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(4),e.ALo(5,"filename"),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("routerLink","/commanding/stacks/browse/"+t.nameWithoutInstance)("queryParams",e.VKq(5,W,i.yamcs.context)),e.xp6(1),e.hij("",e.lcZ(5,3,t.name)," ")}}function tl(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-icon",40),e._uU(2,"description"),e.qZA(),e.TgZ(3,"a",42),e.NdJ("click",function(i){return i.stopPropagation()}),e.ALo(4,"filename"),e._uU(5),e.ALo(6,"filename"),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("routerLink","/commanding/stacks/files/"+t.nameWithoutInstance)("queryParams",e.VKq(8,W,i.yamcs.context))("title",e.lcZ(4,4,t.name)),e.xp6(2),e.hij("",e.lcZ(6,6,t.name)," ")}}function nl(n,o){if(1&n&&(e.TgZ(0,"td",39),e.YNc(1,el,6,7,"ng-container",6),e.YNc(2,tl,7,10,"ng-container",6),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",t.folder),e.xp6(1),e.Q6J("ngIf",!t.folder)}}function il(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1,"Visibility"),e.qZA())}function al(n,o){1&n&&(e.TgZ(0,"td",39),e._uU(1," Private "),e.qZA())}function ol(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1,"Date modified"),e.qZA())}function cl(n,o){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.ALo(2,"datetime"),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.modified)||"-"," ")}}function sl(n,o){1&n&&e._UZ(0,"th",43)}function rl(n,o){1&n&&e._UZ(0,"mat-divider")}function ll(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(a){e.CHM(t);const c=e.oxw(2).$implicit,s=e.oxw(2);return e.KtG(s.convertToJSON(a,c.nameWithoutInstance))}),e._uU(1," Convert to new format "),e.qZA()}}function ml(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"ya-more")(1,"button",44),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,c=e.oxw(2);return e.KtG(c.renameFile(a))}),e._uU(2," Rename "),e.qZA(),e.TgZ(3,"a",45),e._uU(4," Download "),e.qZA(),e._UZ(5,"mat-divider"),e.TgZ(6,"button",44),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,c=e.oxw(2);return e.KtG(c.deleteFile(a))}),e._uU(7," Delete "),e.qZA(),e.YNc(8,rl,1,0,"mat-divider",6),e.ALo(9,"lowercase"),e.ALo(10,"extension"),e.ALo(11,"filename"),e.YNc(12,ll,2,0,"button",46),e.ALo(13,"lowercase"),e.ALo(14,"extension"),e.ALo(15,"filename"),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("href",t.objectUrl,e.LSH),e.xp6(5),e.Q6J("ngIf","xml"===e.lcZ(9,3,e.lcZ(10,5,e.lcZ(11,7,t.name)))),e.xp6(4),e.Q6J("ngIf","xml"===e.lcZ(13,9,e.lcZ(14,11,e.lcZ(15,13,t.name))))}}function ul(n,o){if(1&n&&(e.TgZ(0,"td",39),e.YNc(1,ml,16,15,"ya-more",6),e.qZA()),2&n){const t=o.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.folder&&i.mayManageStacks())}}function dl(n,o){1&n&&e._UZ(0,"th",38)}function pl(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"span",53),e._uU(1," Warning: XML-formatted command stacks are deprecated, "),e.TgZ(2,"a",54),e.NdJ("click",function(a){e.CHM(t);const c=e.oxw(2).$implicit,s=e.oxw(2);return e.KtG(s.convertToJSON(a,c.nameWithoutInstance))}),e._uU(3,"convert to the new format"),e.qZA()()}}function _l(n,o){1&n&&e._UZ(0,"span")}function gl(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"extension"),e.ALo(3,"filename"),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.hij("Unsupported format '",e.lcZ(2,1,e.lcZ(3,3,t.name)),"'")}}function fl(n,o){if(1&n&&(e.TgZ(0,"span",49),e.ALo(1,"lowercase"),e.ALo(2,"extension"),e.ALo(3,"filename"),e.YNc(4,pl,4,0,"span",50),e.YNc(5,_l,1,0,"span",51),e.YNc(6,gl,4,5,"span",52),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("ngSwitch",e.lcZ(1,3,e.lcZ(2,5,e.lcZ(3,7,t.name)))),e.xp6(4),e.Q6J("ngSwitchCase","xml"),e.xp6(1),e.Q6J("ngSwitchCase","ycs")}}function hl(n,o){if(1&n&&(e.TgZ(0,"td",47),e.YNc(1,fl,7,9,"span",48),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",!t.folder)}}function xl(n,o){1&n&&e._UZ(0,"tr",55)}function yl(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr",56),e.NdJ("click",function(){const c=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.toggleOne(c))}),e.qZA()}if(2&n){const t=o.$implicit,i=e.oxw(2);e.ekj("selected",i.selection.isSelected(t))}}function Tl(n,o){if(1&n&&(e.TgZ(0,"table",16),e.ynx(1,17),e.YNc(2,Wr,2,1,"th",18),e.YNc(3,zr,2,1,"td",19),e.BQk(),e.ynx(4,20),e.YNc(5,Kr,2,0,"th",21),e.YNc(6,nl,3,2,"td",22),e.BQk(),e.ynx(7,23),e.YNc(8,il,2,0,"th",21),e.YNc(9,al,2,0,"td",22),e.BQk(),e.ynx(10,24),e.YNc(11,ol,2,0,"th",21),e.YNc(12,cl,3,3,"td",22),e.BQk(),e.ynx(13,25),e.YNc(14,sl,1,0,"th",26),e.YNc(15,ul,2,1,"td",27),e.BQk(),e.ynx(16,28),e.YNc(17,dl,1,0,"th",21),e.YNc(18,hl,2,1,"td",29),e.BQk(),e.YNc(19,xl,1,0,"tr",30),e.YNc(20,yl,1,2,"tr",31),e.qZA()),2&n){const t=e.oxw();e.Q6J("dataSource",t.dataSource),e.xp6(19),e.Q6J("cdkHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("cdkRowDefColumns",t.displayedColumns)}}function Cl(n,o){1&n&&(e.TgZ(0,"ya-empty-message"),e._uU(1," Empty directory. "),e.qZA())}function bl(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p")(1,"button",59),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(4);return e.KtG(a.createStack())}),e._uU(2,"Create a stack"),e.qZA(),e._uU(3," or "),e.TgZ(4,"button",60),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(4);return e.KtG(a.openUploadDialog())}),e._uU(5,"Import a stack"),e.qZA()()}}function Zl(n,o){if(1&n&&(e.TgZ(0,"ya-empty-message",58)(1,"p"),e._uU(2," Command stacks are used to interactively execute a prepared set of commands. To start, either: "),e.qZA(),e.YNc(3,bl,6,0,"p",6),e.qZA()),2&n){const t=e.oxw(3);e.xp6(3),e.Q6J("ngIf",t.mayManageStacks())}}function vl(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Cl,2,0,"ya-empty-message",6),e.YNc(2,Zl,4,1,"ya-empty-message",57),e.BQk()),2&n){const t=o.ngIf,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",i.loaded&&t.length),e.xp6(1),e.Q6J("ngIf",i.loaded&&!t.length)}}function Al(n,o){if(1&n&&(e.YNc(0,vl,3,2,"ng-container",6),e.ALo(1,"async")),2&n){const t=e.oxw();e.Q6J("ngIf",e.lcZ(1,1,t.breadcrumb$))}}let Le=(()=>{class n{constructor(t,i,a,c,s,m,d,_,y){this.dialog=t,this.yamcs=i,this.router=c,this.route=s,this.authService=m,this.messageService=d,this.configService=_,this.basenamePipe=y,this.breadcrumb$=new C.X([]),this.dragActive$=new C.X(!1),this.displayedColumns=["select","name","modified","actions","formatWarning"],this.dataSource=new p.by([]),this.selection=new E.Ov(!0,[]),this.loaded=!1,this.converting=!1,a.setTitle("Stacks"),this.storageClient=i.createStorageClient();const f=_.getConfig();this.bucket=_.getStackBucket(),this.folderPerInstance=f.stackFolderPerInstance,this.loadCurrentFolder(),this.routerSubscription=c.events.pipe((0,Or.h)(h=>h instanceof T.m2)).subscribe(()=>{this.loadCurrentFolder()})}loadCurrentFolder(){const t={delimiter:"/"};let i="";this.folderPerInstance&&(i=this.yamcs.instance+"/");const a=this.route.snapshot.url;a.length?t.prefix=i+a.map(c=>c.path).join("/")+"/":i&&(t.prefix=i),this.storageClient.listObjects(this.bucket,t).then(c=>{this.updateBrowsePath(),this.changedir(c),this.loaded=!0})}getNameWithoutInstance(t){return this.folderPerInstance?t.substr(this.yamcs.instance.length):t}changedir(t){this.selection.clear();const i=[];for(const a of t.prefixes||[])i.push({folder:!0,name:a,nameWithoutInstance:this.getNameWithoutInstance(a)});for(const a of t.objects||[])a.name.endsWith("/")||i.push({folder:!1,name:a.name,nameWithoutInstance:this.getNameWithoutInstance(a.name),modified:a.created,objectUrl:this.storageClient.getObjectURL(this.bucket,a.name)});this.dataSource.data=i}isAllSelected(){const i=this.dataSource.filteredData.length;return this.selection.selected.length===i&&i>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(t=>this.selection.select(t))}toggleOne(t){(!this.selection.isSelected(t)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(t)}createStack(){this.dialog.open(Mr,{width:"400px",data:{path:this.getCurrentPath(),prefix:this.folderPerInstance?this.yamcs.instance+"/":""}}).afterClosed().subscribe(i=>{i&&this.router.navigateByUrl(`/commanding/stacks/files/${i}?c=${this.yamcs.context}`)})}createFolder(){this.dialog.open(Jr,{width:"400px",data:{bucket:this.bucket,path:this.getCurrentPath()}}).afterClosed().subscribe({next:()=>this.loadCurrentFolder()})}openUploadDialog(){this.uploaderEl.nativeElement.click()}importStack(){let t=this.getCurrentPath();t.startsWith("/")&&(t=t.substring(1));const i=this.uploaderEl.nativeElement.files,a=[];for(const c in i)if(!isNaN(parseInt(c,10))){const s=i[c],y=this.storageClient.uploadObject(this.bucket,(this.folderPerInstance?this.yamcs.instance+"/":"")+(t?t+"/"+s.name:s.name),s);a.push(y)}Promise.all(a).then(()=>this.loadCurrentFolder()).catch(c=>this.messageService.showError(c))}convertToJSON(t,i){var a=this;this.converting||!t.shiftKey&&!confirm(`Are you sure you want to convert '${i}' to the new format?\nThis wil delete the original XML file.\n(Press shift if you do not want to show this dialog)`)||(this.converting=!0,this.storageClient.getObject(this.bucket,i).then(function(){var s=(0,q.Z)(function*(m){if(m.ok){const _=(new DOMParser).parseFromString(yield m.text(),"text/xml"),y=G.parseXML(_.documentElement,a.configService.getCommandOptions());G.convertToJSON(a.messageService,a.basenamePipe,a.storageClient,a.bucket,i,y,{}).then(()=>{a.loadCurrentFolder()})}else a.messageService.showError("Failed to load '"+i+"' for conversion")});return function(m){return s.apply(this,arguments)}}()).finally(()=>{this.converting=!1}))}getCurrentPath(){let t="";for(const i of this.route.snapshot.url)t+="/"+i.path;return t||"/"}deleteSelectedStacks(){const t=[],i=[];for(const a of this.selection.selected)a.folder?i.push(this.storageClient.listObjects(this.bucket,{prefix:a.name}).then(c=>{t.push(...(c.objects||[]).map(m=>m.name))})):t.push(a.name);Promise.all(i).then(()=>{if(confirm(`You are about to delete ${t.length} files. Are you sure you want to continue?`)){const a=[];for(const c of t)a.push(this.storageClient.deleteObject(this.bucket,c));Promise.all(a).then(()=>{this.loadCurrentFolder()})}})}renameFile(t){this.dialog.open(Yr,{data:{name:t.name},width:"400px"}).afterClosed().subscribe(a=>{a&&this.loadCurrentFolder()})}deleteFile(t){confirm(`Are you sure you want to delete ${t.nameWithoutInstance}?`)&&this.storageClient.deleteObject(this.bucket,t.name).then(()=>{this.loadCurrentFolder()})}dragEnter(t){return this.dragActive$.next(!0),t.preventDefault(),t.stopPropagation(),!1}dragOver(t){return t.preventDefault(),t.stopPropagation(),!1}dragLeave(t){return this.dragActive$.next(!1),t.preventDefault(),t.stopPropagation(),!1}drop(t){const i=t.dataTransfer||{};if(i){let a=this.getCurrentPath().substring(1);""!==a&&(a+="/"),Ir.v(i).then(c=>{const s=[];for(const m of c){let d=a+m._fullPath;this.folderPerInstance&&(d=this.yamcs.instance+"/"+d);const _=this.storageClient.uploadObject(this.bucket,d,m);s.push(_)}Promise.all(s).finally(()=>{this.loadCurrentFolder()})})}return this.dragActive$.next(!1),t.preventDefault(),t.stopPropagation(),!1}mayManageStacks(){const t=this.authService.getUser();return t.hasObjectPrivilege("ManageBucket",this.bucket)||t.hasSystemPrivilege("ManageAnyBucket")}updateBrowsePath(){const t=[];let i="";for(const a of this.route.snapshot.url)i+="/"+a.path,t.push({name:a.path,route:"/commanding/stacks/browse"+i});return this.breadcrumb$.next(t),i||"/"}ngOnDestroy(){this.routerSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x.uw),e.Y36(r.C8),e.Y36(Q.Dx),e.Y36(T.F0),e.Y36(T.gz),e.Y36(Y.e),e.Y36(r.ez),e.Y36(r.E4),e.Y36(r.uu))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(i,a){if(1&i&&(e.Gf(Fr,7),e.Gf($r,5)),2&i){let c;e.iGM(c=e.CRH())&&(a.dropArea=c.first),e.iGM(c=e.CRH())&&(a.uploaderEl=c.first)}},decls:18,vars:17,consts:[["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],[1,"droparea",3,"dragenter"],["droparea",""],[1,"droparea-overlay",3,"dragover","dragleave","drop"],[1,"panel-content"],[4,"ngIf"],["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf","ngIfElse"],["empty",""],["mat-button","","color","primary",3,"click"],["type","file","hidden","","accept",".xml,.XML,.ycs,.YCS","multiple","",3,"change"],["uploader",""],["mat-button","","color","primary",3,"disabled","click"],["link","/commanding/stacks/browse","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label",4,"ngFor","ngForOf"],[3,"link","queryParams","label"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","visibility"],["cdkColumnDef","modified"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["cdkColumnDef","formatWarning"],["mat-cell","","style","text-align: right;",4,"cdkCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked","change",4,"ngIf"],["type","checkbox",3,"checked","change"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"checked","click","change",4,"ngIf"],["type","checkbox",3,"checked","click","change"],["mat-header-cell",""],["mat-cell",""],[1,"icon12",2,"vertical-align","middle","margin-right","7px"],[3,"routerLink","queryParams","click"],[3,"routerLink","queryParams","title","click"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-menu-item","","download","",3,"href"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-cell","",2,"text-align","right"],[3,"ngSwitch",4,"ngIf"],[3,"ngSwitch"],["style","color: #CC0000; cursor:help","title","Certain features are not implemented for XML, the format will be phased out gradually",4,"ngSwitchCase"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["title","Certain features are not implemented for XML, the format will be phased out gradually",2,"color","#CC0000","cursor","help"],["title","Convert to YCS",2,"color","inherit","cursor","pointer",3,"click"],["mat-header-row",""],["mat-row","",3,"click"],["headerTitle","Command Stacks",4,"ngIf"],["headerTitle","Command Stacks"],[1,"ya-button","primary",3,"click"],[1,"ya-button",3,"click"]],template:function(i,a){if(1&i&&(e.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),e._uU(2," Command Stacks \xa0\xa0\xa0 "),e.YNc(3,Lr,4,0,"button",0),e.YNc(4,Er,6,0,"button",0),e.YNc(5,Hr,4,0,"button",0),e.YNc(6,Br,4,1,"button",1),e.qZA(),e.TgZ(7,"div",2,3),e.NdJ("dragenter",function(s){return a.dragEnter(s)}),e.ALo(9,"async"),e.TgZ(10,"div",4),e.NdJ("dragover",function(s){return a.dragOver(s)})("dragleave",function(s){return a.dragLeave(s)})("drop",function(s){return a.drop(s)}),e.ALo(11,"async"),e.qZA(),e.TgZ(12,"div",5),e.YNc(13,jr,2,1,"ng-container",6),e.ALo(14,"async"),e.YNc(15,Tl,21,3,"table",7),e.YNc(16,Al,2,3,"ng-template",null,8,e.W1O),e.qZA()()()),2&i){const c=e.MAs(17);e.xp6(3),e.Q6J("ngIf",a.mayManageStacks()),e.xp6(1),e.Q6J("ngIf",a.mayManageStacks()),e.xp6(1),e.Q6J("ngIf",a.mayManageStacks()),e.xp6(1),e.Q6J("ngIf",a.mayManageStacks()),e.xp6(1),e.ekj("active",e.lcZ(9,11,a.dragActive$)),e.xp6(3),e.ekj("hide",!e.lcZ(11,13,a.dragActive$)),e.xp6(3),e.Q6J("ngIf",e.lcZ(14,15,a.breadcrumb$)),e.xp6(2),e.Q6J("ngIf",a.dataSource&&a.dataSource.data.length)("ngIfElse",c)}},dependencies:[u.sg,u.O5,u.RF,u.n9,u.ED,T.rH,v.Sq,v.O_,v.D5,v.fo,v.s$,O.lW,S.Hw,D.d,w.OP,p.BZ,p.fO,p.w1,p.Dz,p.ge,p.ev,p.XQ,p.Gk,r.LI,r.O_,r.RR,r.cQ,N.a,P.k,u.Ov,u.i8,r.id,r.FG,r.XB],styles:[".droparea[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:auto}.droparea-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;background:rgba(27,97,185,.1);border:1px solid rgba(27,97,185,1);z-index:10}table[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}"],changeDetection:0})}return n})(),Ee=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(i,a){1&i&&e._UZ(0,"router-outlet")},dependencies:[T.lC],encapsulation:2,changeDetection:0})}return n})();const kl=[{path:"",canActivate:[ue.r,xn._],canActivateChild:[ue.q],runGuardsAndResolvers:"always",component:Tn.K,children:[{path:"clearances",canActivate:[(n,o)=>(0,e.f3M)(fe).canActivate(n,o)],children:[{path:"",pathMatch:"full",component:he},{path:"log",component:ge}]},{path:"send",pathMatch:"full",component:Qe},{path:"send/:qualifiedName",component:Pe},{path:"report/:commandId",component:we},{path:"history",children:[{path:"",pathMatch:"full",component:Ae},{path:":commandId",component:ke}]},{path:"queues",component:Je,canActivate:[(n,o)=>(0,e.f3M)(de).canActivate(n,o)],children:[{path:"",pathMatch:"full",redirectTo:"pending"},{path:"pending",component:Oe},{path:"log",component:qe}]},{path:"stacks",pathMatch:"full",redirectTo:"stacks/browse"},{path:"stacks/browse",component:(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(i,a){1&i&&e._UZ(0,"router-outlet")},dependencies:[T.lC],encapsulation:2,changeDetection:0})}return n})(),children:[{path:"**",component:Le}]},{path:"stacks/files",component:Ee,children:[{path:"**",component:G,canDeactivate:[n=>(0,e.f3M)($e).canDeactivate(n)]}]}]}];let wl=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({providers:[$e],imports:[T.Bz.forChild(kl),T.Bz]})}return n})(),Sl=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[Be.m,wl]})}return n})();e.B6R(R,[u.sg,u.O5,u.RF,u.n9,l.JJ,l.JL,l.u,l.CE,r.uZ,r.IR,me,R,X,z,K,ee,te,ne,ie],[u.Ov]),e.B6R(oe,[u.sg,u.O5,u.RF,u.n9,u.ED,l._Y,l.Fj,l._,l.JJ,l.JL,l.sg,l.u,l.x0,r.IR,r.ll,nn],[u.Ov])}}]);