"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[356],{356:(La,D,m)=>{m.r(D),m.d(D,{AlarmsModule:()=>Ha});var M=m(7216),g=m(1896),$=m(3906),J=m(7914),B=m(4529),c=m(6223),_=m(9538),o=m(6516),t=m(5879),p=m(6814),y=m(3422),Z=m(858),b=m(4104);const F=function(){return{matrixParams:"exact",paths:"exact",queryParams:"ignored"}},w=function(a){return{c:a}};let S=(()=>{class a{constructor(e){this.yamcs=e}static#t=this.\u0275fac=function(l){return new(l||a)(t.Y36(o.C8))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-alarms-page-tabs"]],decls:13,vars:16,consts:[["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","/alarms","routerLinkActive","",3,"routerLinkActiveOptions","active","queryParams"],["rla","routerLinkActive"],["mat-tab-link","","routerLink","/alarms/history","routerLinkActive","",3,"active","queryParams"],["rlb","routerLinkActive"],["mat-tab-link","","routerLink","/alarms/log","routerLinkActive","",3,"active","queryParams"],["rlc","routerLinkActive"],["tabPanel",""]],template:function(l,i){if(1&l&&(t.TgZ(0,"nav",0)(1,"a",1,2),t._uU(3," Active "),t.qZA(),t.TgZ(4,"a",3,4),t._uU(6," History "),t.qZA(),t.TgZ(7,"a",5,6),t._uU(9," Action log "),t.qZA()(),t.TgZ(10,"mat-tab-nav-panel",null,7),t._UZ(12,"router-outlet"),t.qZA()),2&l){const r=t.MAs(2),s=t.MAs(5),u=t.MAs(8),h=t.MAs(11);t.Q6J("mat-stretch-tabs",!1)("tabPanel",h),t.xp6(1),t.Q6J("routerLinkActiveOptions",t.DdM(9,F))("active",r.isActive)("queryParams",t.VKq(10,w,i.yamcs.context)),t.xp6(3),t.Q6J("active",s.isActive)("queryParams",t.VKq(12,w,i.yamcs.context)),t.xp6(3),t.Q6J("active",u.isActive)("queryParams",t.VKq(14,w,i.yamcs.context))}},dependencies:[g.lC,g.rH,g.Od,b.BU,b.sW,b.Nj],styles:[".mat-mdc-tab-link[_ngcontent-%COMP%]{height:36px;min-width:0;font-size:13px}"],changeDetection:0})}return a})();const E=["intervalSelect"];function V(a,n){if(1&a){const e=t.EpF();t.ynx(0),t._UZ(1,"ya-date-time-input",16)(2,"ya-date-time-input",17),t.TgZ(3,"button",18),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.applyCustomDates())}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.filterForm.invalid)}}function G(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",19),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.jumpToNow())}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function j(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Time"),t.qZA())}function K(a,n){if(1&a&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.time))}}function R(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"User"),t.qZA())}function z(a,n){if(1&a&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(e.user||"-")}}function X(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Action"),t.qZA())}function W(a,n){if(1&a&&(t.TgZ(0,"td",21),t._UZ(1,"span",22),t.ALo(2,"actionLogFormat"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,e.summary)||"-",t.oJD)}}function tt(a,n){1&a&&t._UZ(0,"th",23)}function et(a,n){1&a&&t._UZ(0,"td",21)}function at(a,n){1&a&&t._UZ(0,"tr",24)}function nt(a,n){1&a&&t._UZ(0,"tr",25)}let Y=(()=>{class a{constructor(e,l,i,r){this.yamcs=e,this.messageService=l,this.router=i,this.route=r,this.filterForm=new c.nJ({filter:new c.p4,interval:new c.p4("NO_LIMIT"),customStart:new c.p4(null),customStop:new c.p4(null)}),this.displayedColumns=["time","user","summary","actions"],this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.dataSource=new _.by,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(s=>{if("CUSTOM"===s){const u=new Date,h=this.validStart||u,d=this.validStop||u;this.filterForm.get("customStart").setValue(o.P6.toISOString(h)),this.filterForm.get("customStop").setValue(o.P6.toISOString(d))}else"NO_LIMIT"===s?(this.validStart=null,this.validStop=null,this.appliedInterval=s,this.loadData()):(this.validStop=new Date,this.validStart=o.P6.subtractDuration(this.validStop,s),this.appliedInterval=s,this.loadData())})}initializeOptions(){const e=this.route.snapshot.queryParamMap;if(e.has("filter")&&(this.filter=e.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),e.has("interval"))if(this.appliedInterval=e.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const l=e.get("customStart");this.filterForm.get("customStart").setValue(l),this.validStart=o.P6.toDate(l);const i=e.get("customStop");this.filterForm.get("customStop").setValue(i),this.validStop=o.P6.toDate(i)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=o.P6.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval="NO_LIMIT",this.validStop=null,this.validStart=null}jumpToNow(){this.filterForm.get("interval").setValue("NO_LIMIT")}applyCustomDates(){this.validStart=o.P6.toDate(this.filterForm.value.customStart),this.validStop=o.P6.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const e={service:"AlarmsApi"};this.validStart&&(e.start=this.validStart.toISOString()),this.validStop&&(e.stop=this.validStop.toISOString()),this.filter&&(e.q=this.filter),this.yamcs.yamcsClient.getAuditRecords(this.yamcs.instance,e).then(l=>this.dataSource.data=l.records||[]).catch(l=>this.messageService.showError(l))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filter||null,interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}static#t=this.\u0275fac=function(l){return new(l||a)(t.Y36(o.C8),t.Y36(o.ez),t.Y36(g.F0),t.Y36(g.gz))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(l,i){if(1&l&&t.Gf(E,5),2&l){let r;t.iGM(r=t.CRH())&&(i.intervalSelect=r.first)}},decls:26,vars:7,consts:[[1,"panel-content"],[2,"margin-top","16px",3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],[4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","summary"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],["mat-header-cell",""],["mat-cell",""],[3,"innerHTML"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(l,i){1&l&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),t._uU(2," Alarms "),t.qZA(),t.TgZ(3,"div",0),t._UZ(4,"app-alarms-page-tabs"),t.TgZ(5,"form",1)(6,"div",2),t._UZ(7,"ya-select",3,4),t.YNc(9,V,5,1,"ng-container",5),t.YNc(10,G,3,0,"ng-container",5),t.qZA()(),t.TgZ(11,"table",6),t.ynx(12,7),t.YNc(13,j,2,0,"th",8),t.YNc(14,K,3,3,"td",9),t.BQk(),t.ynx(15,10),t.YNc(16,R,2,0,"th",8),t.YNc(17,z,2,1,"td",9),t.BQk(),t.ynx(18,11),t.YNc(19,X,2,0,"th",8),t.YNc(20,W,3,3,"td",9),t.BQk(),t.ynx(21,12),t.YNc(22,tt,1,0,"th",13),t.YNc(23,et,1,0,"td",9),t.BQk(),t.YNc(24,at,1,0,"tr",14),t.YNc(25,nt,1,0,"tr",15),t.qZA()()()),2&l&&(t.xp6(5),t.Q6J("formGroup",i.filterForm),t.xp6(2),t.Q6J("options",i.intervalOptions),t.xp6(2),t.Q6J("ngIf","CUSTOM"===i.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==i.filterForm.value.interval),t.xp6(1),t.Q6J("dataSource",i.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns))},dependencies:[p.O5,c._Y,c.JJ,c.JL,c.sg,c.u,_.BZ,_.fO,_.as,_.w1,_.Dz,_.nj,_.ge,_.ev,_.XQ,_.Gk,o.t,o.Hr,y.a,Z.k,S,o.NE,o.id],encapsulation:2,changeDetection:0})}return a})();var A=m(3304),v=m(617),it=m(1274),I=m(2596),U=m(2e3);const lt=["intervalSelect"];function rt(a,n){if(1&a){const e=t.EpF();t.ynx(0),t._UZ(1,"ya-date-time-input",11)(2,"ya-date-time-input",12),t.TgZ(3,"button",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.applyCustomDates())}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.filterForm.invalid)}}function ot(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",14),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.jumpToNow())}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function ct(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Severity"),t.qZA())}function st(a,n){if(1&a&&(t.TgZ(0,"td",34),t._UZ(1,"app-alarm-level",35),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("level",e.severity)("grayscale",!0)}}function mt(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Alarm type"),t.qZA())}function _t(a,n){1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",36),t._uU(2,"event_note"),t.qZA(),t.BQk())}function ut(a,n){1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",36),t._uU(2,"toll"),t.qZA(),t.BQk())}function pt(a,n){if(1&a&&(t.TgZ(0,"td",34),t.YNc(1,_t,3,0,"ng-container",6),t.YNc(2,ut,3,0,"ng-container",6),t._uU(3),t.ALo(4,"titlecase"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf","EVENT"===e.type),t.xp6(1),t.Q6J("ngIf","PARAMETER"===e.type),t.xp6(1),t.hij(" ",t.lcZ(4,3,e.type||"-")," ")}}function dt(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Start"),t.qZA())}function gt(a,n){if(1&a&&(t.TgZ(0,"td",34),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.triggerTime)||"-")}}function ft(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Stop"),t.qZA())}function ht(a,n){if(1&a&&(t.TgZ(0,"td",34),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.updateTime)||"-"," ")}}function At(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Trip value"),t.qZA())}function xt(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function Tt(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function vt(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"value"),t.YNc(3,xt,2,0,"span",6),t.YNc(4,Tt,2,0,"span",6),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,3,e.triggerValue.engValue)," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.triggerValue.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.triggerValue.rangeCondition)}}function yt(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",e.triggerEvent.message||"-"," ")}}function Zt(a,n){if(1&a&&(t.TgZ(0,"td",37),t.YNc(1,vt,5,5,"ng-container",6),t.YNc(2,yt,2,1,"ng-container",6),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",e.eventDetail)}}function bt(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Alarm name"),t.qZA())}const k=function(a){return["/telemetry/parameters",a]},N=function(a){return{c:a}};function wt(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",38),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2).$implicit,l=t.oxw(2);t.xp6(1),t.Q6J("routerLink",t.VKq(4,k,e.id.namespace+"/"+e.id.name))("queryParams",t.VKq(6,N,l.yamcs.context)),t.xp6(1),t.AsE(" ",e.id.namespace,"/",e.id.name," ")}}function St(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.AsE(" ",e.id.namespace,"/",e.id.name," ")}}function It(a,n){if(1&a&&(t.ynx(0),t.YNc(1,wt,3,8,"ng-container",6),t.YNc(2,St,2,2,"ng-container",6),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",!e.parameterDetail)}}function Ut(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",38),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2).$implicit,l=t.oxw(2);t.xp6(1),t.Q6J("routerLink",t.VKq(3,k,e.id.namespace))("queryParams",t.VKq(5,N,l.yamcs.context)),t.xp6(1),t.hij(" ",e.id.namespace," ")}}function kt(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.id.namespace," ")}}function Nt(a,n){if(1&a&&(t.ynx(0),t.YNc(1,Ut,3,7,"ng-container",6),t.YNc(2,kt,2,1,"ng-container",6),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",!e.parameterDetail)}}function Qt(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",38),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2).$implicit,l=t.oxw(2);t.xp6(1),t.Q6J("routerLink",t.VKq(3,k,e.id.name))("queryParams",t.VKq(5,N,l.yamcs.context)),t.xp6(1),t.hij(" ",e.id.name," ")}}function Ct(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.id.name," ")}}function qt(a,n){if(1&a&&(t.ynx(0),t.YNc(1,Qt,3,7,"ng-container",6),t.YNc(2,Ct,2,1,"ng-container",6),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",!e.parameterDetail)}}function Dt(a,n){if(1&a&&(t.TgZ(0,"td",34),t.YNc(1,It,3,2,"ng-container",6),t.YNc(2,Nt,3,2,"ng-container",6),t.YNc(3,qt,3,2,"ng-container",6),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.id.namespace&&e.id.name),t.xp6(1),t.Q6J("ngIf",e.id.namespace&&!e.id.name),t.xp6(1),t.Q6J("ngIf",!e.id.namespace&&e.id.name)}}function Jt(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Duration"),t.qZA())}function Yt(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"duration"),t.BQk()),2&a){const e=t.oxw().$implicit,l=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,l.durationFor(e))||"-"," ")}}function Pt(a,n){if(1&a&&(t.TgZ(0,"mat-icon",40),t._uU(1,"comment"),t.qZA()),2&a){const e=t.oxw(2).$implicit;t.Q6J("matTooltip",null==e.clearInfo?null:e.clearInfo.clearMessage)}}function Ht(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.YNc(2,Pt,2,1,"mat-icon",39),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" (cleared by ",null==e.clearInfo?null:e.clearInfo.clearedBy,") "),t.xp6(1),t.Q6J("ngIf",null==e.clearInfo?null:e.clearInfo.clearMessage)}}function Lt(a,n){if(1&a&&(t.TgZ(0,"td",34),t.YNc(1,Yt,3,3,"ng-container",6),t.YNc(2,Ht,3,2,"ng-container",6),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.updateTime),t.xp6(1),t.Q6J("ngIf",null==e.clearInfo?null:e.clearInfo.clearedBy)}}function Ot(a,n){1&a&&(t.TgZ(0,"th",41),t._uU(1,"Violations"),t.qZA())}function Mt(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"number"),t.ALo(3,"number"),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,e.violations)," (",t.xi3(3,4,e.violations/e.count*100,"1.2-2"),"%) ")}}function $t(a,n){if(1&a&&(t.TgZ(0,"td",42),t.YNc(1,Mt,4,7,"ng-container",43),t.qZA()),2&a){const e=n.$implicit;t.oxw(2);const l=t.MAs(19);t.xp6(1),t.Q6J("ngIf",e.violations)("ngIfElse",l)}}function Bt(a,n){1&a&&t._UZ(0,"th",44)}function Ft(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"ya-text-action",47),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.showChart(i))}),t._uU(1," SHOW CHART "),t.qZA()}}function Et(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"ya-text-action",48),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.showData(i))}),t._uU(1," SHOW DATA "),t.qZA()}}function Vt(a,n){if(1&a&&(t.TgZ(0,"td",34),t.YNc(1,Ft,2,0,"ya-text-action",45),t.YNc(2,Et,2,0,"ya-text-action",46),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",e.parameterDetail)}}function Gt(a,n){1&a&&t._UZ(0,"tr",49)}function jt(a,n){1&a&&t._UZ(0,"tr",50)}function Kt(a,n){if(1&a&&(t.TgZ(0,"table",15),t.ynx(1,16),t.YNc(2,ct,2,0,"th",17),t.YNc(3,st,2,2,"td",18),t.BQk(),t.ynx(4,19),t.YNc(5,mt,2,0,"th",17),t.YNc(6,pt,5,5,"td",18),t.BQk(),t.ynx(7,20),t.YNc(8,dt,2,0,"th",17),t.YNc(9,gt,3,3,"td",18),t.BQk(),t.ynx(10,21),t.YNc(11,ft,2,0,"th",17),t.YNc(12,ht,3,3,"td",18),t.BQk(),t.ynx(13,22),t.YNc(14,At,2,0,"th",17),t.YNc(15,Zt,3,2,"td",23),t.BQk(),t.ynx(16,24),t.YNc(17,bt,2,0,"th",17),t.YNc(18,Dt,4,3,"td",18),t.BQk(),t.ynx(19,25),t.YNc(20,Jt,2,0,"th",17),t.YNc(21,Lt,3,2,"td",18),t.BQk(),t.ynx(22,26),t.YNc(23,Ot,2,0,"th",27),t.YNc(24,$t,2,2,"td",28),t.BQk(),t.ynx(25,29),t.YNc(26,Bt,1,0,"th",30),t.YNc(27,Vt,3,2,"td",18),t.BQk(),t.YNc(28,Gt,1,0,"tr",31),t.YNc(29,jt,1,0,"tr",32),t.qZA()),2&a){const e=t.oxw();t.Q6J("dataSource",e.dataSource),t.xp6(28),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}function Rt(a,n){1&a&&t._uU(0,"-")}let P=(()=>{class a{constructor(e,l,i,r){this.yamcs=e,this.router=l,this.route=i,this.messageService=r,this.filterForm=new c.nJ({interval:new c.p4("NO_LIMIT"),customStart:new c.p4(null),customStop:new c.p4(null)}),this.displayedColumns=["severity","start","stop","duration","alarm","type","triggerValue","violations","actions"],this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.dataSource=new _.by,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(s=>{if("CUSTOM"===s){const u=new Date,h=this.validStart||u,d=this.validStop||u;this.filterForm.get("customStart").setValue(o.P6.toISOString(h)),this.filterForm.get("customStop").setValue(o.P6.toISOString(d))}else"NO_LIMIT"===s?(this.validStart=null,this.validStop=null,this.appliedInterval=s,this.loadData()):(this.validStop=new Date,this.validStart=o.P6.subtractDuration(this.validStop,s),this.appliedInterval=s,this.loadData())})}initializeOptions(){const e=this.route.snapshot.queryParamMap;if(e.has("interval"))if(this.appliedInterval=e.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const l=e.get("customStart");this.filterForm.get("customStart").setValue(l),this.validStart=o.P6.toDate(l);const i=e.get("customStop");this.filterForm.get("customStop").setValue(i),this.validStop=o.P6.toDate(i)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=o.P6.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval="NO_LIMIT",this.validStop=null,this.validStart=null}jumpToNow(){this.filterForm.get("interval").setValue("NO_LIMIT")}applyCustomDates(){this.validStart=o.P6.toDate(this.filterForm.value.customStart),this.validStop=o.P6.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(e){this.updateURL();const l={};this.validStart&&(l.start=this.validStart.toISOString()),this.validStop&&(l.stop=this.validStop.toISOString()),this.yamcs.yamcsClient.getAlarms(this.yamcs.instance,l).then(i=>this.dataSource.data=i).catch(i=>this.messageService.showError(i))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}durationFor(e){if(e.updateTime)return o.P6.toDate(e.updateTime).getTime()-o.P6.toDate(e.triggerTime).getTime()}showChart(e){const l=e.triggerTime,i=e.updateTime||e.clearInfo?.clearTime;let r,s;i?(r=A.utc(l),s=A.utc(i)):(r=A.utc(l),s=A.utc(i).add(1,"hour")),this.router.navigate(["/telemetry/parameters",e.parameterDetail?.triggerValue.id.name,"chart"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:r.toISOString(),customStop:s.toISOString()}})}showData(e){const l=e.triggerTime,i=e.updateTime||e.clearInfo?.clearTime;let r,s;i?(r=A.utc(l),s=A.utc(i)):(r=A.utc(l),s=A.utc(i).add(1,"hour")),this.router.navigate(["/telemetry/parameters",e.parameterDetail?.triggerValue.id.name,"data"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:r.toISOString(),customStop:s.toISOString()}})}static#t=this.\u0275fac=function(l){return new(l||a)(t.Y36(o.C8),t.Y36(g.F0),t.Y36(g.gz),t.Y36(o.ez))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(l,i){if(1&l&&t.Gf(lt,5),2&l){let r;t.iGM(r=t.CRH())&&(i.intervalSelect=r.first)}},decls:20,vars:6,consts:[[1,"table-wrapper"],[1,"panel-content"],[2,"margin-top","16px",3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],[4,"ngIf"],["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf"],[2,"flex","1 1 auto"],[1,"ya-button",3,"disabled"],["dash",""],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","start"],["matColumnDef","stop"],["matColumnDef","triggerValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","alarm"],["matColumnDef","duration"],["matColumnDef","violations"],["mat-header-cell","","style","text-align: right",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level","grayscale"],[2,"vertical-align","middle"],["mat-cell","",1,"wrap200"],[3,"routerLink","queryParams"],[3,"matTooltip",4,"ngIf"],[3,"matTooltip"],["mat-header-cell","",2,"text-align","right"],["mat-cell","",2,"text-align","right"],[4,"ngIf","ngIfElse"],["mat-header-cell","",1,"expand"],["icon","show_chart",3,"click",4,"ngIf"],["icon","view_headline",3,"click",4,"ngIf"],["icon","show_chart",3,"click"],["icon","view_headline",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(l,i){1&l&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),t._uU(2," Alarms "),t.qZA(),t.TgZ(3,"div",0)(4,"div",1),t._UZ(5,"app-alarms-page-tabs"),t.TgZ(6,"form",2)(7,"div",3),t._UZ(8,"ya-select",4,5),t.YNc(10,rt,5,1,"ng-container",6),t.YNc(11,ot,3,0,"ng-container",6),t.qZA()(),t.YNc(12,Kt,30,3,"table",7),t.TgZ(13,"mat-toolbar"),t._UZ(14,"span",8),t.TgZ(15,"button",9),t._uU(16,"Load More"),t.qZA(),t._UZ(17,"span",8),t.qZA()()()(),t.YNc(18,Rt,1,0,"ng-template",null,10,t.W1O)),2&l&&(t.xp6(6),t.Q6J("formGroup",i.filterForm),t.xp6(2),t.Q6J("options",i.intervalOptions),t.xp6(2),t.Q6J("ngIf","CUSTOM"===i.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==i.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf",i.dataSource),t.xp6(3),t.Q6J("disabled",!0))},dependencies:[p.O5,c._Y,c.JJ,c.JL,c.sg,c.u,g.rH,v.Hw,_.BZ,_.fO,_.as,_.w1,_.Dz,_.nj,_.ge,_.ev,_.XQ,_.Gk,it.Ye,I.gM,o.t,o.Hr,o.ll,U.i,y.a,Z.k,S,p.JJ,p.rS,o.id,o.uG,o.VC],encapsulation:2,changeDetection:0})}return a})();var T=m(5619),zt=m(3620),Xt=m(2645),H=m(5861),f=m(7700);function Wt(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.hij("/",e.data.alarms[0].id.name," ")}}function te(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.YNc(2,Wt,2,1,"ng-container",2),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.data.alarms[0].id.namespace,""),t.xp6(1),t.Q6J("ngIf",e.data.alarms[0].id.name)}}function ee(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.data.alarms.length," selected alarms. ")}}let ae=(()=>{class a{constructor(e,l,i,r){this.dialogRef=e,this.yamcs=i,this.data=r,this.formGroup=l.group({comment:void 0})}acknowledge(){var e=this;return(0,H.Z)(function*(){const l=e.data.alarms,i=e.formGroup.get("comment").value;for(const r of l){const s={};i&&(s.comment=i),e.yamcs.yamcsClient.acknowledgeAlarm(e.yamcs.instance,e.yamcs.processor,r.id.namespace+(r.id.name?"/"+r.id.name:""),r.seqNum,s)}e.dialogRef.close()})()}static#t=this.\u0275fac=function(l){return new(l||a)(t.Y36(f.so),t.Y36(c.QS),t.Y36(o.C8),t.Y36(f.WI))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-acknowledge-alarm-dialog"]],decls:15,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[4,"ngIf"],[1,"ya-form",3,"formGroup"],["formControlName","comment","rows","5",2,"resize","none"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(l,i){1&l&&(t.TgZ(0,"h2",0),t._uU(1,"Acknowledge"),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"p"),t.YNc(4,te,3,2,"ng-container",2),t.YNc(5,ee,2,1,"ng-container",2),t.qZA(),t.TgZ(6,"form",3)(7,"label"),t._uU(8," Comment "),t._UZ(9,"textarea",4),t.qZA()()(),t.TgZ(10,"mat-dialog-actions",5)(11,"button",6),t._uU(12,"CANCEL"),t.qZA(),t.TgZ(13,"button",7),t.NdJ("click",function(){return i.acknowledge()}),t._uU(14,"OK"),t.qZA()()),2&l&&(t.xp6(4),t.Q6J("ngIf",1===i.data.alarms.length),t.xp6(1),t.Q6J("ngIf",1!==i.data.alarms.length),t.xp6(1),t.Q6J("formGroup",i.formGroup),t.xp6(7),t.Q6J("disabled",!i.formGroup.valid))},dependencies:[p.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,f.ZT,f.uh,f.xY,f.H8],encapsulation:2,changeDetection:0})}return a})();var ne=m(8337),Q=m(7398);class ie extends ne.o2{constructor(n){super(),this.yamcs=n,this.alarms$=new T.X([]),this.filteredAlarms$=new T.X([]),this.loading$=new T.X(!1),this.alarmsByName={},this.filter=null,this.unacknowledgedAlarms$=this.alarms$.pipe((0,Q.U)(e=>e.filter(l=>!l.shelveInfo&&!l.acknowledged))),this.acknowledgedAlarms$=this.alarms$.pipe((0,Q.U)(e=>e.filter(l=>!l.shelveInfo&&l.acknowledged))),this.shelvedAlarms$=this.alarms$.pipe((0,Q.U)(e=>e.filter(l=>!!l.shelveInfo)))}connect(){return this.filteredAlarms$}setFilter(n){this.filter=n||null}loadAlarms(){this.loading$.next(!0),this.yamcs.yamcsClient.getActiveAlarms(this.yamcs.instance,this.yamcs.processor).then(n=>{this.loading$.next(!1);for(const e of n)this.processAlarm(e);this.updateSubject()}),this.alarmSubscription=this.yamcs.yamcsClient.createAlarmSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor},n=>{this.processAlarm(n),this.updateSubject()})}updateSubject(){const e=[...Object.values(this.alarmsByName).sort((l,i)=>{let r=l.acknowledged===i.acknowledged?0:l.acknowledged?1:-1;if(0===r){const s=this.getNumericSeverity(l.severity),u=this.getNumericSeverity(i.severity);r=s===u?0:s<u?1:-1}return 0===r&&(r=(l.id.namespace+"/"+l.id.name).localeCompare(i.id.namespace+"/"+i.id.name)),r})];if(this.alarms$.next(e),this.filter){const l=e.filter(i=>-1!==(i.id.namespace+"/"+i.id.name).toLowerCase().indexOf(this.filter));this.filteredAlarms$.next(l)}else this.filteredAlarms$.next(e)}getNumericSeverity(n){switch(n){case"WATCH":return 0;case"WARNING":return 1;case"DISTRESS":return 2;case"CRITICAL":return 3;case"SEVERE":return 4;default:return 5}}disconnect(){this.alarms$.complete(),this.filteredAlarms$.complete(),this.loading$.complete(),this.alarmSubscription&&this.alarmSubscription.cancel()}isEmpty(){return!this.filteredAlarms$.getValue().length}processAlarm(n){const e=n.id.namespace+"/"+n.id.name;n.processOK&&!n.triggered&&n.acknowledged?delete this.alarmsByName[e]:this.alarmsByName[e]=n}}function le(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.hij("/",e.data.alarms[0].id.name," ")}}function re(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.YNc(2,le,2,1,"ng-container",2),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.data.alarms[0].id.namespace,""),t.xp6(1),t.Q6J("ngIf",e.data.alarms[0].id.name)}}function oe(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.data.alarms.length," selected alarms. ")}}let ce=(()=>{class a{constructor(e,l,i,r){this.dialogRef=e,this.yamcs=i,this.data=r,this.durationOptions=[{id:"PT15M",label:"15 minutes"},{id:"PT30M",label:"30 minutes"},{id:"PT1H",label:"1 hour"},{id:"PT2H",label:"2 hours"},{id:"P1D",label:"1 day"},{id:"UNLIMITED",label:"unlimited"}],this.formGroup=l.group({duration:"PT2H",comment:void 0})}shelve(){var e=this;return(0,H.Z)(function*(){const l=e.data.alarms,i=e.formGroup.get("comment").value;let r=null;if("UNLIMITED"!==e.formGroup.get("duration").value){const s=e.formGroup.get("duration").value;r=o.P6.convertDurationToMillis(s)}for(const s of l){const u={};i&&(u.comment=i),r&&(u.shelveDuration=r),e.yamcs.yamcsClient.shelveAlarm(e.yamcs.instance,e.yamcs.processor,s.id.namespace+(s.id.name?"/"+s.id.name:""),s.seqNum,u)}e.dialogRef.close()})()}static#t=this.\u0275fac=function(l){return new(l||a)(t.Y36(f.so),t.Y36(c.QS),t.Y36(o.C8),t.Y36(f.WI))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-shelve-alarm-dialog"]],decls:20,vars:5,consts:[["mat-dialog-title",""],[1,"mat-typography"],[4,"ngIf"],[1,"ya-form",3,"formGroup"],["formControlName","duration",3,"options"],["formControlName","comment","rows","5",2,"resize","none"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(l,i){1&l&&(t.TgZ(0,"h2",0),t._uU(1,"Shelve"),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"p"),t.YNc(4,re,3,2,"ng-container",2),t.YNc(5,oe,2,1,"ng-container",2),t.qZA(),t.TgZ(6,"form",3)(7,"label"),t._uU(8," Duration"),t._UZ(9,"br")(10,"ya-select",4),t.qZA(),t._UZ(11,"br"),t.TgZ(12,"label"),t._uU(13," Comment "),t._UZ(14,"textarea",5),t.qZA()()(),t.TgZ(15,"mat-dialog-actions",6)(16,"button",7),t._uU(17,"CANCEL"),t.qZA(),t.TgZ(18,"button",8),t.NdJ("click",function(){return i.shelve()}),t._uU(19,"OK"),t.qZA()()),2&l&&(t.xp6(4),t.Q6J("ngIf",1===i.data.alarms.length),t.xp6(1),t.Q6J("ngIf",1!==i.data.alarms.length),t.xp6(1),t.Q6J("formGroup",i.formGroup),t.xp6(4),t.Q6J("options",i.durationOptions),t.xp6(8),t.Q6J("disabled",!i.formGroup.valid))},dependencies:[p.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,f.ZT,f.uh,f.xY,f.H8,o.Hr],encapsulation:2,changeDetection:0})}return a})();var se=m(6593),me=m(4518),_e=m(2296),ue=m(6385);const pe=function(a){return["/telemetry/parameters/",a]},de=function(a){return{c:a}};function ge(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"div",1),t._uU(2,"Parameter"),t.qZA(),t.TgZ(3,"div",2)(4,"a",5),t._uU(5),t.qZA()(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("routerLink",t.VKq(4,pe,e.alarm.id.namespace+"/"+e.alarm.id.name))("queryParams",t.VKq(6,de,e.yamcs.context)),t.xp6(1),t.AsE(" ",e.alarm.id.namespace,"/",e.alarm.id.name," ")}}function fe(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.AsE(" ",e.alarm.id.namespace,"/",e.alarm.id.name," ")}}function he(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.alarm.id.namespace," ")}}function Ae(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"div",1),t._uU(2,"Event"),t.qZA(),t.TgZ(3,"div",2),t.YNc(4,fe,2,2,"ng-container",0),t.YNc(5,he,2,1,"ng-container",0),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.alarm.id.name),t.xp6(1),t.Q6J("ngIf",!e.alarm.id.name)}}function xe(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function Te(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function ve(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function ye(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function Ze(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"br")(2,"mat-divider"),t.TgZ(3,"div",1),t._uU(4,"Trigger value"),t.qZA(),t.TgZ(5,"div",2),t._UZ(6,"app-alarm-level",6),t._uU(7),t.ALo(8,"value"),t.YNc(9,xe,2,0,"span",0),t.YNc(10,Te,2,0,"span",0),t.qZA(),t._UZ(11,"br")(12,"mat-divider"),t.TgZ(13,"div",1),t._uU(14,"Live value"),t.qZA(),t.TgZ(15,"div",2)(16,"ya-expirable",7),t._UZ(17,"app-alarm-level",6),t._uU(18),t.ALo(19,"value"),t.YNc(20,ve,2,0,"span",0),t.YNc(21,ye,2,0,"span",0),t.qZA()(),t.BQk()),2&a){const e=n.ngIf,l=t.oxw();t.xp6(6),t.Q6J("level",l.alarm.severity)("grayscale",!0),t.xp6(1),t.hij(" \xa0",t.lcZ(8,11,e.triggerValue.engValue)," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.triggerValue.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.triggerValue.rangeCondition),t.xp6(6),t.Q6J("pval",e.currentValue),t.xp6(1),t.Q6J("level",e.currentValue.monitoringResult)("grayscale",!0),t.xp6(1),t.hij(" \xa0",t.lcZ(19,13,e.currentValue.engValue)," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.currentValue.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.currentValue.rangeCondition)}}function be(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"br")(2,"mat-divider"),t.TgZ(3,"div",1),t._uU(4,"Trigger event"),t.qZA(),t.TgZ(5,"div",2),t._uU(6),t.qZA(),t.BQk()),2&a){const e=n.ngIf;t.xp6(6),t.hij(" ",e.triggerEvent.message," ")}}function we(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"blockquote",8),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.alarm.acknowledgeInfo.acknowledgeMessage," ")}}function Se(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"br")(2,"mat-divider"),t.TgZ(3,"div",1),t._uU(4),t.qZA(),t.TgZ(5,"div",2),t._uU(6),t.ALo(7,"datetime"),t.YNc(8,we,3,1,"ng-container",0),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.hij("Acknowledged by ",e.alarm.acknowledgeInfo.acknowledgedBy,""),t.xp6(2),t.hij(" On ",t.lcZ(7,3,e.alarm.acknowledgeInfo.acknowledgeTime)," "),t.xp6(2),t.Q6J("ngIf",e.alarm.acknowledgeInfo.acknowledgeMessage)}}function Ie(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"blockquote",8),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.alarm.shelveInfo.shelveMessage," ")}}function Ue(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"div",1),t._uU(2,"Shelve Expiration"),t.qZA(),t.TgZ(3,"div",2),t._uU(4),t.ALo(5,"datetime"),t.qZA(),t.BQk()),2&a){const e=t.oxw(2);t.xp6(4),t.hij(" ",t.lcZ(5,1,e.alarm.shelveInfo.shelveExpiration)," ")}}function ke(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"br")(2,"mat-divider"),t.TgZ(3,"div",1),t._uU(4),t.qZA(),t.TgZ(5,"div",2),t._uU(6),t.ALo(7,"datetime"),t.YNc(8,Ie,3,1,"ng-container",0),t.qZA(),t.YNc(9,Ue,6,3,"ng-container",0),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.hij("Shelved by ",e.alarm.shelveInfo.shelvedBy,""),t.xp6(2),t.hij(" On ",t.lcZ(7,4,e.alarm.shelveInfo.shelveTime)," "),t.xp6(2),t.Q6J("ngIf",e.alarm.shelveInfo.shelveMessage),t.xp6(1),t.Q6J("ngIf",e.alarm.shelveInfo.shelveExpiration)}}function Ne(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.acknowledgeAlarm.emit(i.alarm))}),t.TgZ(1,"mat-icon"),t._uU(2,"notifications_off"),t.qZA(),t._uU(3," ACKNOWLEDGE "),t.qZA()}}function Qe(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.shelveAlarm.emit(i.alarm))}),t.TgZ(1,"mat-icon"),t._uU(2,"timer"),t.qZA(),t._uU(3," SHELVE "),t.qZA()}}function Ce(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.unshelveAlarm.emit(i.alarm))}),t.TgZ(1,"mat-icon"),t._uU(2,"timer_off"),t.qZA(),t._uU(3," UNSHELVE "),t.qZA()}}function qe(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",9),t.YNc(1,Ne,4,0,"button",10),t.YNc(2,Qe,4,0,"button",10),t.YNc(3,Ce,4,0,"button",10),t.TgZ(4,"button",11),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.clearAlarm.emit(i.alarm))}),t.TgZ(5,"mat-icon"),t._uU(6,"clear_all"),t.qZA(),t._uU(7," CLEAR "),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.alarm.shelveInfo&&!e.alarm.acknowledged),t.xp6(1),t.Q6J("ngIf",!e.alarm.shelveInfo),t.xp6(1),t.Q6J("ngIf",e.alarm.shelveInfo)}}let De=(()=>{class a{constructor(e){this.yamcs=e,this.mayControl=!1,this.acknowledgeAlarm=new t.vpe,this.shelveAlarm=new t.vpe,this.unshelveAlarm=new t.vpe,this.clearAlarm=new t.vpe}static#t=this.\u0275fac=function(l){return new(l||a)(t.Y36(o.C8))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-alarm-detail"]],inputs:{alarm:"alarm",mayControl:"mayControl"},outputs:{acknowledgeAlarm:"acknowledgeAlarm",shelveAlarm:"shelveAlarm",unshelveAlarm:"unshelveAlarm",clearAlarm:"clearAlarm"},decls:17,vars:12,consts:[[4,"ngIf"],[1,"block-title"],[1,"block"],[3,"level"],["class","action-bar",4,"ngIf"],[1,"ya-link",3,"routerLink","queryParams"],[3,"level","grayscale"],[3,"pval"],[2,"border-left","4px solid #eee","padding-left","1em","font-style","italic"],[1,"action-bar"],["class","ya-button",3,"click",4,"ngIf"],[1,"ya-button",3,"click"]],template:function(l,i){1&l&&(t.YNc(0,ge,6,8,"ng-container",0),t.YNc(1,Ae,6,2,"ng-container",0),t.TgZ(2,"div",1),t._uU(3,"Severity"),t.qZA(),t.TgZ(4,"div",2),t._UZ(5,"app-alarm-level",3),t._uU(6),t.qZA(),t.TgZ(7,"div",1),t._uU(8,"Violations"),t.qZA(),t.TgZ(9,"div",2),t._uU(10),t.ALo(11,"number"),t.qZA(),t.YNc(12,Ze,22,15,"ng-container",0),t.YNc(13,be,7,1,"ng-container",0),t.YNc(14,Se,9,5,"ng-container",0),t.YNc(15,ke,10,6,"ng-container",0),t.YNc(16,qe,8,3,"div",4)),2&l&&(t.Q6J("ngIf","PARAMETER"===i.alarm.type),t.xp6(1),t.Q6J("ngIf","EVENT"===i.alarm.type),t.xp6(4),t.Q6J("level",i.alarm.severity),t.xp6(1),t.hij(" ",i.alarm.severity,"\n"),t.xp6(4),t.hij(" ",t.lcZ(11,10,i.alarm.violations),"\n"),t.xp6(2),t.Q6J("ngIf",i.alarm.parameterDetail),t.xp6(1),t.Q6J("ngIf",i.alarm.eventDetail),t.xp6(1),t.Q6J("ngIf",i.alarm.acknowledgeInfo),t.xp6(1),t.Q6J("ngIf",i.alarm.shelveInfo),t.xp6(1),t.Q6J("ngIf",i.mayControl))},dependencies:[p.O5,g.rH,v.Hw,ue.d,o.g4,U.i,p.JJ,o.id,o.VC],styles:[".mat-mdc-raised-button[_ngcontent-%COMP%]{margin-right:10px}"],changeDetection:0})}return a})();var Je=m(7988),Ye=m(2268);function Pe(a,n){1&a&&(t.TgZ(0,"mat-icon",5),t._uU(1,"timer"),t.qZA())}function He(a,n){1&a&&(t.TgZ(0,"mat-icon",6),t._uU(1,"check_circle"),t.qZA())}function Le(a,n){if(1&a&&(t.TgZ(0,"mat-icon",7),t.ALo(1,"async"),t._uU(2,"notifications"),t.qZA()),2&a){const e=t.oxw();t.Udp("visibility",t.lcZ(1,2,e.visibility$)?"visible":"hidden")}}function Oe(a,n){1&a&&(t.TgZ(0,"mat-icon",8),t._uU(1,"check_circle_outline"),t.qZA())}function Me(a,n){if(1&a&&(t.TgZ(0,"mat-icon",9),t.ALo(1,"async"),t._uU(2,"notifications_none"),t.qZA()),2&a){const e=t.oxw();t.Udp("visibility",t.lcZ(1,2,e.visibility$)?"visible":"hidden")}}let $e=(()=>{class a{constructor(e){this.visibility$=new T.X(!0),this.syncSubscription=e.syncFast(()=>{this.visibility$.next(!this.visibility$.value)})}ngOnDestroy(){this.syncSubscription&&this.syncSubscription.unsubscribe()}static#t=this.\u0275fac=function(l){return new(l||a)(t.Y36(o.jF))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-alarm-state-icon"]],inputs:{alarm:"alarm"},decls:5,vars:5,consts:[["matTooltip","Shelved",4,"ngIf"],["matTooltip","Active, acknowledged",4,"ngIf"],["matTooltip","Active, unacknowledged",3,"visibility",4,"ngIf"],["matTooltip","RTN, acknowledged",4,"ngIf"],["matTooltip","RTN, unacknowledged",3,"visibility",4,"ngIf"],["matTooltip","Shelved"],["matTooltip","Active, acknowledged"],["matTooltip","Active, unacknowledged"],["matTooltip","RTN, acknowledged"],["matTooltip","RTN, unacknowledged"]],template:function(l,i){1&l&&(t.YNc(0,Pe,2,0,"mat-icon",0),t.YNc(1,He,2,0,"mat-icon",1),t.YNc(2,Le,3,4,"mat-icon",2),t.YNc(3,Oe,2,0,"mat-icon",3),t.YNc(4,Me,3,4,"mat-icon",4)),2&l&&(t.Q6J("ngIf",i.alarm.shelveInfo),t.xp6(1),t.Q6J("ngIf",!i.alarm.shelveInfo&&!i.alarm.processOK&&i.alarm.acknowledged),t.xp6(1),t.Q6J("ngIf",!i.alarm.shelveInfo&&!i.alarm.processOK&&!i.alarm.acknowledged),t.xp6(1),t.Q6J("ngIf",!i.alarm.shelveInfo&&i.alarm.processOK&&i.alarm.acknowledged),t.xp6(1),t.Q6J("ngIf",!i.alarm.shelveInfo&&i.alarm.processOK&&!i.alarm.acknowledged))},dependencies:[p.O5,v.Hw,I.gM,p.Ov],encapsulation:2})}return a})();function Be(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Alarm type"),t.qZA())}function Fe(a,n){1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",23),t._uU(2,"event_note"),t.qZA(),t.BQk())}function Ee(a,n){1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",23),t._uU(2,"toll"),t.qZA(),t.BQk())}function Ve(a,n){if(1&a&&(t.TgZ(0,"td",21),t.YNc(1,Fe,3,0,"ng-container",22),t.YNc(2,Ee,3,0,"ng-container",22),t._uU(3),t.ALo(4,"titlecase"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf","EVENT"===e.type),t.xp6(1),t.Q6J("ngIf","PARAMETER"===e.type),t.xp6(1),t.hij(" ",t.lcZ(4,3,e.type||"-")," ")}}function Ge(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Alarm name"),t.qZA())}const C=function(a){return["/telemetry/parameters",a]},q=function(a){return{c:a}};function je(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",24),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2).$implicit,l=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(4,C,e.id.namespace+"/"+e.id.name))("queryParams",t.VKq(6,q,l.yamcs.context)),t.xp6(1),t.AsE(" ",e.id.namespace,"/",e.id.name," ")}}function Ke(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.AsE(" ",e.id.namespace,"/",e.id.name," ")}}function Re(a,n){if(1&a&&(t.ynx(0),t.YNc(1,je,3,8,"ng-container",22),t.YNc(2,Ke,2,2,"ng-container",22),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",!e.parameterDetail)}}function ze(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",24),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2).$implicit,l=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(3,C,e.id.namespace))("queryParams",t.VKq(5,q,l.yamcs.context)),t.xp6(1),t.hij(" ",e.id.namespace," ")}}function Xe(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.id.namespace," ")}}function We(a,n){if(1&a&&(t.ynx(0),t.YNc(1,ze,3,7,"ng-container",22),t.YNc(2,Xe,2,1,"ng-container",22),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",!e.parameterDetail)}}function ta(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",24),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2).$implicit,l=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(3,C,e.id.name))("queryParams",t.VKq(5,q,l.yamcs.context)),t.xp6(1),t.hij(" ",e.id.name," ")}}function ea(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.id.name," ")}}function aa(a,n){if(1&a&&(t.ynx(0),t.YNc(1,ta,3,7,"ng-container",22),t.YNc(2,ea,2,1,"ng-container",22),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",!e.parameterDetail)}}function na(a,n){if(1&a&&(t.TgZ(0,"td",21),t.YNc(1,Re,3,2,"ng-container",22),t.YNc(2,We,3,2,"ng-container",22),t.YNc(3,aa,3,2,"ng-container",22),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.id.namespace&&e.id.name),t.xp6(1),t.Q6J("ngIf",e.id.namespace&&!e.id.name),t.xp6(1),t.Q6J("ngIf",!e.id.namespace&&e.id.name)}}function ia(a,n){1&a&&(t.TgZ(0,"th",25),t._uU(1,"State"),t.qZA())}function la(a,n){if(1&a&&(t.TgZ(0,"td",26),t._UZ(1,"app-alarm-state-icon",27),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("alarm",e)}}function ra(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Alarm time"),t.qZA())}function oa(a,n){if(1&a&&(t.TgZ(0,"td",21)(1,"span",28),t.ALo(2,"datetime"),t._UZ(3,"app-ago",29),t.qZA()()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("matTooltip",t.lcZ(2,2,e.triggerTime)),t.xp6(2),t.Q6J("time",e.triggerTime)}}function ca(a,n){1&a&&(t.TgZ(0,"th",25),t._uU(1,"Severity"),t.qZA())}function sa(a,n){if(1&a&&(t.TgZ(0,"td",26),t._UZ(1,"app-alarm-level",30),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("level",e.severity)}}function ma(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Trip value"),t.qZA())}function _a(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function ua(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function pa(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"value"),t.YNc(3,_a,2,0,"span",22),t.YNc(4,ua,2,0,"span",22),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,3,e.triggerValue.engValue)," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.triggerValue.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.triggerValue.rangeCondition)}}function da(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",e.triggerEvent.message||"-"," ")}}function ga(a,n){if(1&a&&(t.TgZ(0,"td",31),t.YNc(1,pa,5,5,"ng-container",22),t.YNc(2,da,2,1,"ng-container",22),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",e.eventDetail)}}function fa(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Live value"),t.qZA())}function ha(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function Aa(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function xa(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"value"),t.YNc(3,ha,2,0,"span",22),t.YNc(4,Aa,2,0,"span",22),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,3,e.currentValue.engValue)," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.currentValue.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.currentValue.rangeCondition)}}function Ta(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",e.triggerEvent.message||"-"," ")}}function va(a,n){if(1&a&&(t.TgZ(0,"td",31),t.YNc(1,xa,5,5,"ng-container",22),t.YNc(2,Ta,2,1,"ng-container",22),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",e.eventDetail)}}function ya(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Violations"),t.qZA())}function Za(a,n){if(1&a&&(t.TgZ(0,"td",32),t._uU(1),t.ALo(2,"number"),t.ALo(3,"number"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,e.violations)," (",t.xi3(3,4,e.violations/e.count*100,"1.2-2"),"%) ")}}function ba(a,n){1&a&&t._UZ(0,"th",33)}function wa(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"ya-more")(1,"button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,r=t.oxw();return t.KtG(r.acknowledgeAlarm.emit(i))}),t._uU(2," Acknowledge... "),t.qZA(),t.TgZ(3,"button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,r=t.oxw();return t.KtG(r.shelveAlarm.emit(i))}),t._uU(4," Shelve... "),t.qZA(),t.TgZ(5,"button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,r=t.oxw();return t.KtG(r.unshelveAlarm.emit(i))}),t._uU(6," Unshelve "),t.qZA()()}if(2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("disabled",e.shelveInfo||e.acknowledged),t.xp6(2),t.Q6J("disabled",e.shelveInfo),t.xp6(2),t.Q6J("disabled",!e.shelveInfo)}}function Sa(a,n){if(1&a&&(t.TgZ(0,"td",21),t.YNc(1,wa,7,3,"ya-more",22),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.mayControl)}}function Ia(a,n){1&a&&t._UZ(0,"tr",35)}function Ua(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"tr",36),t.NdJ("click",function(){const r=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.toggleOne(r))}),t.qZA()}if(2&a){const e=n.$implicit,l=t.oxw();t.ekj("selected",l.selection.isSelected(e))("hide",l.hideAlarm(e))}}function ka(a,n){1&a&&t._uU(0,"-")}let Na=(()=>{class a{constructor(e){this.yamcs=e,this.displayedColumns=["state","severity","time","alarm","type","trip_value","live_value","actions"],this.view="standard",this.mayControl=!1,this.acknowledgeAlarm=new t.vpe,this.shelveAlarm=new t.vpe,this.unshelveAlarm=new t.vpe,this.tableTrackerFn=(l,i)=>`${i.triggerTime}__${i.id.namespace}__${i.id.name}__${i.seqNum}`}toggleOne(e){(!this.selection.isSelected(e)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(e)}hideAlarm(e){return"standard"===this.view?!!e.shelveInfo:"all"!==this.view&&("unacknowledged"===this.view?!!e.shelveInfo||e.acknowledged:"acknowledged"===this.view?!!e.shelveInfo||!e.acknowledged:"shelved"===this.view?!e.shelveInfo:void 0)}static#t=this.\u0275fac=function(l){return new(l||a)(t.Y36(o.C8))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-alarms-table"]],inputs:{dataSource:"dataSource",selection:"selection",view:"view",mayControl:"mayControl"},outputs:{acknowledgeAlarm:"acknowledgeAlarm",shelveAlarm:"shelveAlarm",unshelveAlarm:"unshelveAlarm"},decls:32,vars:6,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource","trackBy"],["matColumnDef","type"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","alarm"],["matColumnDef","state"],["mat-header-cell","","class","status",4,"matHeaderCellDef"],["mat-cell","","class","status",4,"matCellDef"],["matColumnDef","time"],["matColumnDef","severity"],["matColumnDef","trip_value"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","live_value"],["matColumnDef","violations"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","style","width: 100%",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","hide","click",4,"matRowDef","matRowDefColumns"],["dash",""],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],[2,"vertical-align","middle"],[3,"routerLink","queryParams"],["mat-header-cell","",1,"status"],["mat-cell","",1,"status"],[3,"alarm"],[3,"matTooltip"],[3,"time"],[3,"level"],["mat-cell","",1,"wrap200"],["mat-cell","",2,"text-align","right"],["mat-header-cell","",2,"width","100%"],["mat-menu-item","",3,"disabled","click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(l,i){1&l&&(t.TgZ(0,"table",0),t.ynx(1,1),t.YNc(2,Be,2,0,"th",2),t.YNc(3,Ve,5,5,"td",3),t.BQk(),t.ynx(4,4),t.YNc(5,Ge,2,0,"th",2),t.YNc(6,na,4,3,"td",3),t.BQk(),t.ynx(7,5),t.YNc(8,ia,2,0,"th",6),t.YNc(9,la,2,1,"td",7),t.BQk(),t.ynx(10,8),t.YNc(11,ra,2,0,"th",2),t.YNc(12,oa,4,4,"td",3),t.BQk(),t.ynx(13,9),t.YNc(14,ca,2,0,"th",6),t.YNc(15,sa,2,1,"td",7),t.BQk(),t.ynx(16,10),t.YNc(17,ma,2,0,"th",2),t.YNc(18,ga,3,2,"td",11),t.BQk(),t.ynx(19,12),t.YNc(20,fa,2,0,"th",2),t.YNc(21,va,3,2,"td",11),t.BQk(),t.ynx(22,13),t.YNc(23,ya,2,0,"th",2),t.YNc(24,Za,4,7,"td",14),t.BQk(),t.ynx(25,15),t.YNc(26,ba,1,0,"th",16),t.YNc(27,Sa,2,1,"td",3),t.BQk(),t.YNc(28,Ia,1,0,"tr",17),t.YNc(29,Ua,1,4,"tr",18),t.qZA(),t.YNc(30,ka,1,0,"ng-template",null,19,t.W1O)),2&l&&(t.ekj("hide",i.dataSource.isEmpty()),t.Q6J("dataSource",i.dataSource)("trackBy",i.tableTrackerFn),t.xp6(28),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns))},dependencies:[p.O5,g.rH,v.Hw,Je.OP,_.BZ,_.fO,_.as,_.w1,_.Dz,_.nj,_.ge,_.ev,_.XQ,_.Gk,I.gM,o.cQ,Ye.E,U.i,$e,p.JJ,p.rS,o.id,o.VC],styles:[".hide[_ngcontent-%COMP%]{display:none}"]})}return a})();function Qa(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.acknowledgeAlarms(i.selection.selected))}),t.TgZ(1,"mat-icon"),t._uU(2,"notifications_off"),t.qZA(),t._uU(3," Acknowledge "),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("disabled",!e.selection.hasValue())}}function Ca(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.shelveAlarms(i.selection.selected))}),t.TgZ(1,"mat-icon"),t._uU(2,"timer"),t.qZA(),t._uU(3," Shelve "),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("disabled",!e.selection.hasValue())}}function qa(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"ya-detail-toolbar"),t._uU(2," Alarm Detail "),t.qZA(),t.TgZ(3,"div",9)(4,"app-alarm-detail",10),t.NdJ("acknowledgeAlarm",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.acknowledgeAlarms([i]))})("shelveAlarm",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.shelveAlarms([i]))})("unshelveAlarm",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.unshelveAlarms([i]))})("clearAlarm",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.clearAlarms([i]))}),t.qZA()(),t.BQk()}if(2&a){const e=n.ngIf,l=t.oxw();t.xp6(4),t.Q6J("alarm",e)("mayControl",l.mayControlAlarms())}}function Da(a,n){1&a&&(t.TgZ(0,"ya-detail-toolbar"),t._uU(1," Select an alarm "),t.qZA())}function Ja(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",11),t._UZ(1,"app-alarms-page-tabs"),t.TgZ(2,"dl",12)(3,"dt"),t._uU(4,"Unacknowledged alarms:"),t.qZA(),t.TgZ(5,"dd")(6,"strong"),t._uU(7),t.ALo(8,"async"),t.qZA()(),t.TgZ(9,"dt"),t._uU(10,"Acknowledged alarms:"),t.qZA(),t.TgZ(11,"dd")(12,"strong"),t._uU(13),t.ALo(14,"async"),t.qZA()(),t.TgZ(15,"dt"),t._uU(16,"Shelved alarms:"),t.qZA(),t.TgZ(17,"dd")(18,"strong"),t._uU(19),t.ALo(20,"async"),t.qZA()()(),t.TgZ(21,"form",13)(22,"div",14),t._UZ(23,"ya-search-filter",15)(24,"ya-select",16),t.qZA()(),t.TgZ(25,"app-alarms-table",17),t.NdJ("acknowledgeAlarm",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.acknowledgeAlarms([i]))})("shelveAlarm",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.shelveAlarms([i]))})("unshelveAlarm",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.unshelveAlarms([i]))}),t.ALo(26,"async"),t.qZA()()}if(2&a){const e=t.oxw();let l,i,r;t.xp6(7),t.Oqu(null==(l=t.lcZ(8,9,e.dataSource.unacknowledgedAlarms$))?null:l.length),t.xp6(6),t.Oqu(null==(i=t.lcZ(14,11,e.dataSource.acknowledgedAlarms$))?null:i.length),t.xp6(6),t.Oqu(null==(r=t.lcZ(20,13,e.dataSource.shelvedAlarms$))?null:r.length),t.xp6(2),t.Q6J("formGroup",e.filterForm),t.xp6(3),t.Q6J("options",e.viewOptions),t.xp6(1),t.Q6J("dataSource",e.dataSource)("selection",e.selection)("view",t.lcZ(26,15,e.view$))("mayControl",e.mayControlAlarms())}}const Ya=[{path:"",canActivate:[J.r,$._],canActivateChild:[J.q],runGuardsAndResolvers:"always",component:B.K,children:[{path:"",pathMatch:"full",component:(()=>{class a{constructor(e,l,i,r,s,u,h){this.yamcs=e,this.route=l,this.router=i,this.dialog=s,this.authService=u,this.messageService=h,this.filterForm=new c.nJ({filter:new c.p4,view:new c.p4("standard")}),this.detailAlarm$=new T.X(null),this.selection=new Xt.O((d,x)=>`${x.triggerTime}__${x.id.namespace}__${x.id.name}__${x.seqNum}`,!1,[]),this.viewOptions=[{id:"standard",label:"Standard view (ack & unack)"},{id:"unacknowledged",label:"Unacknowledged alarms"},{id:"acknowledged",label:"Acknowledged alarms"},{id:"shelved",label:"Shelved alarms"},{id:"all",label:"All alarms"}],this.view$=new T.X("standard"),r.setTitle("Alarms"),this.selectionSubscription=this.selection.changed.subscribe(()=>{const d=this.selection.selected;this.detailAlarm$.next(1===d.length?d[0]:null)}),this.dataSource=new ie(this.yamcs),this.dataSource.loadAlarms(),this.alarmsSubscription=this.dataSource.alarms$.subscribe(d=>{this.selection.matchNewValues(d);const x=this.detailAlarm$.value;if(x)for(const O of d)if(this.isSameAlarm(O,x)){this.detailAlarm$.next(O);break}}),this.initializeOptions(),this.filterForm.get("filter").valueChanges.pipe((0,zt.b)(400)).forEach(d=>{this.filter=d,this.updateURL(),this.dataSource.setFilter(d)}),this.filterForm.get("view").valueChanges.forEach(d=>{this.view$.next(d),this.updateURL(),this.selection.clear()})}initializeOptions(){const e=this.route.snapshot.queryParamMap;if(e.has("filter")&&(this.filter=e.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),e.has("view")){const l=e.get("view");this.view$.next(l),this.filterForm.get("view").setValue(l)}}isSameAlarm(e,l){return e.seqNum===l.seqNum&&e.id.namespace===l.id.namespace&&e.id.name===l.id.name&&e.triggerTime===l.triggerTime}acknowledgeAlarms(e){this.dialog.open(ae,{width:"400px",data:{alarms:e}}).afterClosed().subscribe(()=>this.selection.clear())}shelveAlarms(e){this.dialog.open(ce,{width:"400px",data:{alarms:e}}).afterClosed().subscribe(()=>this.selection.clear())}unshelveAlarms(e){for(const l of e)this.yamcs.yamcsClient.unshelveAlarm(this.yamcs.instance,this.yamcs.processor,l.id.namespace+(l.id.name?"/"+l.id.name:""),l.seqNum).then(()=>this.selection.clear()).catch(r=>this.messageService.showError(r))}clearAlarms(e){for(const l of e)this.yamcs.yamcsClient.clearAlarm(this.yamcs.instance,this.yamcs.processor,l.id.namespace+(l.id.name?"/"+l.id.name:""),l.seqNum,{})}mayControlAlarms(){return this.authService.getUser().hasSystemPrivilege("ControlAlarms")}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filter||null,view:this.view$.value||null},queryParamsHandling:"merge"})}ngOnDestroy(){this.selectionSubscription&&this.selectionSubscription.unsubscribe(),this.alarmsSubscription&&this.alarmsSubscription.unsubscribe()}static#t=this.\u0275fac=function(l){return new(l||a)(t.Y36(o.C8),t.Y36(g.gz),t.Y36(g.F0),t.Y36(se.Dx),t.Y36(f.uw),t.Y36(me.e),t.Y36(o.ez))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:46,vars:7,consts:[[1,"ya-data-table"],["width","1"],[1,"icon16",2,"vertical-align","middle"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],[4,"ngIf","ngIfElse"],["noDetail",""],[1,"table-wrapper"],["class","panel-content",4,"ngIf"],["mat-button","","color","primary",3,"disabled","click"],[2,"padding","0 16px"],[3,"alarm","mayControl","acknowledgeAlarm","shelveAlarm","unshelveAlarm","clearAlarm"],[1,"panel-content"],[1,"dl-horizontal"],[3,"formGroup"],[1,"filter-bar"],["formControlName","filter","placeholder","Filter by text search"],["formControlName","view",3,"options"],[3,"dataSource","selection","view","mayControl","acknowledgeAlarm","shelveAlarm","unshelveAlarm"]],template:function(l,i){if(1&l&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),t._uU(2," Alarms "),t.TgZ(3,"ya-help"),t._uU(4," An alarm can be in these states: "),t.TgZ(5,"table",0)(6,"tr")(7,"td",1)(8,"mat-icon",2),t._uU(9,"notifications"),t.qZA()(),t.TgZ(10,"td"),t._uU(11," The alarm is unacknowledged and the cause of the alarm still exists. "),t.qZA()(),t.TgZ(12,"tr")(13,"td")(14,"mat-icon",2),t._uU(15,"notifications_none"),t.qZA()(),t.TgZ(16,"td"),t._uU(17," The alarm is unacknowledged and the cause that generated the alarm no longer exists. "),t.qZA()(),t.TgZ(18,"tr")(19,"td")(20,"mat-icon",2),t._uU(21,"check_circle"),t.qZA()(),t.TgZ(22,"td"),t._uU(23," The alarm is acknowledged and the cause of the alarm still exists. "),t.qZA()(),t.TgZ(24,"tr")(25,"td")(26,"mat-icon",2),t._uU(27,"check_circle_outline"),t.qZA()(),t.TgZ(28,"td"),t._uU(29," The alarm is acknowledged and the cause that generated the alarm no longer exists. "),t.qZA()(),t.TgZ(30,"tr")(31,"td")(32,"mat-icon",2),t._uU(33,"timer"),t.qZA()(),t.TgZ(34,"td"),t._uU(35," The alarm was shelved. "),t.qZA()()()(),t._uU(36," \xa0\xa0\xa0 "),t.YNc(37,Qa,4,1,"button",3),t.YNc(38,Ca,4,1,"button",3),t.qZA(),t.TgZ(39,"ya-detail-pane"),t.YNc(40,qa,5,2,"ng-container",4),t.ALo(41,"async"),t.YNc(42,Da,2,0,"ng-template",null,5,t.W1O),t.qZA(),t.TgZ(44,"div",6),t.YNc(45,Ja,27,17,"div",7),t.qZA()()),2&l){const r=t.MAs(43);t.xp6(37),t.Q6J("ngIf",i.mayControlAlarms()),t.xp6(1),t.Q6J("ngIf",i.mayControlAlarms()),t.xp6(2),t.Q6J("ngIf",t.lcZ(41,5,i.detailAlarm$))("ngIfElse",r),t.xp6(5),t.Q6J("ngIf",i.dataSource)}},dependencies:[p.O5,c._Y,c.JJ,c.JL,c.sg,c.u,_e.lW,v.Hw,o.J8,o.MD,o.IR,o.cF,o.Hr,y.a,Z.k,De,S,Na,p.Ov],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}mat-row[_ngcontent-%COMP%]{cursor:pointer}mat-row[_ngcontent-%COMP%]:hover{background:#fafafa}"],changeDetection:0})}return a})()},{path:"history",component:P},{path:"log",component:Y}]}];let Pa=(()=>{class a{static#t=this.\u0275fac=function(l){return new(l||a)};static#e=this.\u0275mod=t.oAB({type:a});static#a=this.\u0275inj=t.cJS({imports:[g.Bz.forChild(Ya),g.Bz]})}return a})(),Ha=(()=>{class a{static#t=this.\u0275fac=function(l){return new(l||a)};static#e=this.\u0275mod=t.oAB({type:a});static#a=this.\u0275inj=t.cJS({imports:[M.m,Pa]})}return a})()}}]);