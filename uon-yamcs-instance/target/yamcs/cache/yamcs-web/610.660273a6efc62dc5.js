"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[610],{7610:(at,u,n)=>{n.r(u),n.d(u,{InstanceHomeModule:()=>V});var _=n(7216),r=n(1896),x=n(3906),h=n(7914),b=n(4529),f=n(5619),t=n(5879),l=n(6516),g=n(4518),y=n(6593),d=n(6814),S=n(3422),Z=n(858),p=n(3566),i=n(9538);function N(a,c){1&a&&(t.TgZ(0,"th",18),t._uU(1,"Packet"),t.qZA())}const D=function(a,c){return{c:a,name:c}};function v(a,c){if(1&a&&(t.TgZ(0,"a",22),t._uU(1),t.qZA()),2&a){const e=t.oxw().$implicit,s=t.oxw(2);t.Q6J("queryParams",t.WLB(2,D,s.yamcs.context,e.packetName)),t.xp6(1),t.hij(" ",e.packetName," ")}}function A(a,c){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.packetName)}}function R(a,c){if(1&a&&(t.TgZ(0,"td",19),t.YNc(1,v,2,5,"a",20),t.YNc(2,A,2,1,"ng-container",21),t.qZA()),2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.config.tmArchive),t.xp6(1),t.Q6J("ngIf",!e.config.tmArchive)}}function C(a,c){1&a&&t._UZ(0,"td",23)}function k(a,c){1&a&&(t.TgZ(0,"th",24),t._uU(1,"Received"),t.qZA())}function Y(a,c){if(1&a&&(t.TgZ(0,"td",25),t._uU(1),t.ALo(2,"deltaWith"),t.qZA()),2&a){const e=c.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.lastReceived,e.lastPacketTime)||"-"," ")}}function U(a,c){1&a&&t._UZ(0,"td",23)}function w(a,c){1&a&&(t.TgZ(0,"th",18),t._uU(1,"Packet time"),t.qZA())}function P(a,c){if(1&a&&(t.TgZ(0,"td",19),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=c.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.lastPacketTime)||"-"," ")}}function Q(a,c){1&a&&t._UZ(0,"td",23)}function $(a,c){1&a&&(t.TgZ(0,"th",18),t._uU(1,"Packet rate"),t.qZA())}function B(a,c){if(1&a&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&a){const e=c.$implicit;t.xp6(1),t.hij(" ",e.packetRate," p/s ")}}function I(a,c){if(1&a&&(t.TgZ(0,"td",26),t._uU(1),t.ALo(2,"async"),t.qZA()),2&a){const e=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,e.totalPacketRate$)," p/s ")}}function H(a,c){1&a&&(t.TgZ(0,"th",18),t._uU(1,"Data rate "),t.qZA())}function j(a,c){if(1&a&&(t.TgZ(0,"td",25),t._uU(1),t.ALo(2,"dataRate"),t.qZA()),2&a){const e=c.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.dataRate)," ")}}function J(a,c){if(1&a&&(t.TgZ(0,"td",26),t._uU(1),t.ALo(2,"dataRate"),t.ALo(3,"async"),t.qZA()),2&a){const e=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,t.lcZ(3,3,e.totalDataRate$))," ")}}function O(a,c){1&a&&t._UZ(0,"th",27)}function L(a,c){1&a&&t._UZ(0,"td",19)}function F(a,c){1&a&&t._UZ(0,"td",23)}function M(a,c){1&a&&t._UZ(0,"tr",28)}function X(a,c){1&a&&t._UZ(0,"tr",29)}function G(a,c){1&a&&t._UZ(0,"tr",30)}function q(a,c){if(1&a&&(t.TgZ(0,"table",1),t.ynx(1,2),t.YNc(2,N,2,0,"th",3),t.YNc(3,R,3,2,"td",4),t.YNc(4,C,1,0,"td",5),t.BQk(),t.ynx(5,6),t.YNc(6,k,2,0,"th",7),t.YNc(7,Y,3,4,"td",8),t.YNc(8,U,1,0,"td",5),t.BQk(),t.ynx(9,9),t.YNc(10,w,2,0,"th",3),t.YNc(11,P,3,3,"td",4),t.YNc(12,Q,1,0,"td",5),t.BQk(),t.ynx(13,10),t.YNc(14,$,2,0,"th",3),t.YNc(15,B,2,1,"td",8),t.YNc(16,I,3,3,"td",11),t.BQk(),t.ynx(17,12),t.YNc(18,H,2,0,"th",3),t.YNc(19,j,3,3,"td",8),t.YNc(20,J,4,5,"td",11),t.BQk(),t.ynx(21,13),t.YNc(22,O,1,0,"th",14),t.YNc(23,L,1,0,"td",4),t.YNc(24,F,1,0,"td",5),t.BQk(),t.YNc(25,M,1,0,"tr",15),t.YNc(26,X,1,0,"tr",16),t.YNc(27,G,1,0,"tr",17),t.qZA()),2&a){const e=t.oxw();t.Q6J("dataSource",e.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("matFooterRowDef",e.displayedColumns)}}let z=(()=>{class a{constructor(e,s){this.yamcs=e,this.statsByName={},this.dataSource=new i.by,this.totalPacketRate$=new f.X(0),this.totalDataRate$=new f.X(0),this.displayedColumns=["packetName","lastPacketTime","lastReceived","packetRate","dataRate","actions"],this.config=s.getConfig()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.tmstats$&&!this.tmstatsSubscription&&this.yamcs.yamcsClient.getPacketNames(this.yamcs.instance).then(e=>{for(const s of e.packets||[])this.statsByName[s]={packetName:s,packetRate:0,dataRate:0};this.updateData(),this.tmstatsSubscription=this.tmstats$.subscribe(s=>{for(const o of s||[])this.statsByName[o.packetName]=o;this.updateData()})})}updateData(){const e=Object.values(this.statsByName);let s=0,o=0;for(const m of e)s+=Number(m.packetRate),o+=Number(m.dataRate);this.totalPacketRate$.next(s),this.totalDataRate$.next(o),this.dataSource.data=e}ngOnDestroy(){this.tmstatsSubscription?.unsubscribe()}static#t=this.\u0275fac=function(s){return new(s||a)(t.Y36(l.C8),t.Y36(l.E4))};static#a=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-tmstats-table"]],viewQuery:function(s,o){if(1&s&&t.Gf(p.YE,5),2&s){let m;t.iGM(m=t.CRH())&&(o.sort=m.first)}},inputs:{tmstats$:"tmstats$"},decls:1,vars:1,consts:[["mat-table","","class","ya-data-table expand","matSort","","matSortActive","packetName","matSortDirection","asc","matSortDisableClear","",3,"dataSource",4,"ngIf"],["mat-table","","matSort","","matSortActive","packetName","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","packetName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","lastReceived"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","lastPacketTime"],["matColumnDef","packetRate"],["mat-footer-cell","","style","text-align: right",4,"matFooterCellDef"],["matColumnDef","dataRate"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["routerLink","/telemetry/packets",3,"queryParams",4,"ngIf"],[4,"ngIf"],["routerLink","/telemetry/packets",3,"queryParams"],["mat-footer-cell",""],["mat-header-cell",""],["mat-cell","",2,"text-align","right"],["mat-footer-cell","",2,"text-align","right"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""]],template:function(s,o){1&s&&t.YNc(0,q,28,4,"table",0),2&s&&t.Q6J("ngIf",o.dataSource)},dependencies:[d.O5,r.rH,p.YE,p.nU,i.BZ,i.fO,i.as,i.w1,i.Dz,i.nj,i.mD,i.Ke,i.ge,i.ev,i.yh,i.XQ,i.Gk,i.Q2,d.Ov,l.zs,l.id,l.mX],encapsulation:2,changeDetection:0})}return a})();function E(a,c){if(1&a&&(t.ynx(0),t._UZ(1,"app-tmstats-table",2),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("tmstats$",e.tmstats$)}}const K=[{path:"",canActivate:[h.r,x._],canActivateChild:[h.q],runGuardsAndResolvers:"always",component:b.K,children:[{path:"",pathMatch:"full",component:(()=>{class a{constructor(e,s,o,m){this.yamcs=e,this.authService=s,this.tmstats$=new f.X([]),this.config=m.getConfig(),this.user=s.getUser(),o.setTitle(this.yamcs.instance),this.yamcs.processor&&(this.tmstatsSubscription=e.yamcsClient.createTMStatisticsSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor},tt=>this.tmstats$.next(tt.tmstats||[])))}showPackets(){return this.user.hasAnyObjectPrivilegeOfType("ReadPacket")}ngOnDestroy(){this.tmstatsSubscription&&this.tmstatsSubscription.cancel()}static#t=this.\u0275fac=function(s){return new(s||a)(t.Y36(l.C8),t.Y36(g.e),t.Y36(y.Dx),t.Y36(l.E4))};static#a=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:5,vars:1,consts:[[1,"panel-content"],[4,"ngIf"],[3,"tmstats$"]],template:function(s,o){1&s&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),t._uU(2,"Home"),t.qZA(),t.TgZ(3,"div",0),t.YNc(4,E,2,1,"ng-container",1),t.qZA()()),2&s&&(t.xp6(4),t.Q6J("ngIf",o.showPackets()))},dependencies:[d.O5,S.a,Z.k,z],encapsulation:2,changeDetection:0})}return a})()}]}];let W=(()=>{class a{static#t=this.\u0275fac=function(s){return new(s||a)};static#a=this.\u0275mod=t.oAB({type:a});static#e=this.\u0275inj=t.cJS({imports:[r.Bz.forChild(K),r.Bz]})}return a})(),V=(()=>{class a{static#t=this.\u0275fac=function(s){return new(s||a)};static#a=this.\u0275mod=t.oAB({type:a});static#e=this.\u0275inj=t.cJS({imports:[_.m,W]})}return a})()}}]);